import{f as o,c as v,o as l,b as a,d,w as r,j as m,F as E,l as O,h as g,t as C,a as f,m as Se,r as D,e as W,n as Jt,y as kt,g as Y,s as Ce,k as Ie,v as j,u as Xt,V as Zt,i as ei}from"./runtime-dom.esm-bundler-BHUXuHBA.js";import{a as re,m as he,u as ut,I as Ct,c as ti,s as ii}from"./index-DZZQPfAP.js";import{g as ni}from"./_commonjsHelpers-BosuxZz1.js";import{c as si,a as ri}from"./vue-router-CIguTQez.js";import{m as T,a as B,e as St}from"./vuex.esm-bundler-Bsn5F6zX.js";import{h as ve,i as Te,j as q,u as J,P as Ye,a as ae,C as oi,T as ai,O as li,N as di,b as ui,I as ci,c as mi,H as pi,F as hi,B as It,k as vi,L as gi,d as fi,e as bi,f as yi,D as _i,A as wi,l as ki,m as Ci,E as He,n as Si,g as Ii}from"./index-CbtOB_UC.js";import{T as Ee}from"./index-DClZ6Hyn.js";import{T as De}from"./index-CjLJ_uYG.js";import{s as x,a as ie}from"./toasts-C5iQoe22.js";import{D as Tt}from"./date-picker-BxfTeMEt.js";import{I as K}from"./input-error-BwByXGF8.js";import{L as H}from"./loading-button-DJBuCTTn.js";import{O as le}from"./option-menu-item-DwUiLzrk.js";import{S as Z}from"./settings-container-Bqgjo56h.js";import{h as A}from"./moment-BXS2RDfP.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{M as Re,U as Ti}from"./shoutouts-plMbE4ld.js";import{E as P}from"./emitter-BHV1M1pA.js";import{I as U}from"./icon-D7mTTnfy.js";import{T as ge}from"./teleport-wrapper-CiAKHFjU.js";import{T as je}from"./tooltip-CYbVZnoq.js";import{D as fe}from"./dialog-modal-CjAG7OXS.js";import{T as Et}from"./template-button-B0J2ghVu.js";import{f as We}from"./focus-nsI9w0xo.js";import{C as Ke}from"./copy-button-fIzLPRHD.js";import{I as Dt}from"./input-error-B35Ivqtq.js";import{T as be}from"./text-input-PYngU_AX.js";import{T as F}from"./businessTracking-CvJP8MRj.js";import{I as Qe}from"./is-mobile-size-C7Jyqc5J.js";import{L as Me}from"./loading-area-D9fSJfWe.js";import{e as Je,j as Rt,N as Ei,Q as Di,W as Ri,X as Mi,R as Xe}from"./constants-CjkuP3cw.js";import{S as Ze}from"./selector-C8Haq2YS.js";import{T as $i}from"./toggle-button-DBD3Ms0s.js";import{c as Bi,d as oe,p as Ui}from"./helpers-CxK22q2g.js";import{R as ye}from"./routes-BMQVj9np.js";import{I as Ai}from"./icon-colored-DKqGPiFq.js";import{g as ct,G as xi}from"./group-recipient-Dfaar6ii.js";import{b as ne}from"./bugsnag-DuOBvGYo.js";import{m as pe}from"./index-Ck0Xdwzs.js";import{R as Ni}from"./board-share-modal-B4WGOTiV.js";import{C as de}from"./common-modal-triggers-ClR9K5XW.js";import{g as z}from"./getFormRequestError-ChFsVvLE.js";import"./axios-C6ch3y-F.js";import{C as Gi}from"./checkbox-input-BwaI_YTP.js";import{C as Mt}from"./copyable-slot-CTJmI8Bc.js";import{M as Oi}from"./upsell-modal-DhKmD6oX.js";import{i as xe}from"./isEmail-Cqu8kt0H.js";import{T as $e}from"./textarea-input-DwK6lgkc.js";import{a as X}from"./index-ccv-oyXV.js";import{T as Pi}from"./tagify-3Cnfspw0.js";import{S as Li}from"./styles-wrapper-CJypHK_7.js";import{a as Vi}from"./index-BEkIeH25.js";import{E as zi}from"./error-panel-oslvq-jN.js";import{F as Fi}from"./feature-lander-DgJyRlFk.js";import{R as et}from"./vue-recaptcha.es-0i_jY2js.js";import{M as qi,D as Yi}from"./menu-items-3EDrmtNf.js";import{M as Hi}from"./menu-button-CfjxwUS1.js";import{M as ji}from"./multiple-email-input-CVvDCFfb.js";import{E as Wi}from"./expanding-link-BgDeYrZQ.js";import{T as Ki,a as Qi}from"./timezone-select-BB36ps0R.js";import{R as $t}from"./radio-input-gMWzD4Zf.js";import{T as Ji}from"./template-editor-BFOYKxnq.js";import{R as N}from"./index-XqOH4a9F.js";import"./module-BGdtcXUr.js";import"./endpoints-CYlG--vO.js";import"./emoji-Bgyj0gbx.js";import"./video-restricted-modal-Bcdapacf.js";import"./index-simple-media-picker-B4se6A7e.js";import"./index-BdmlBtaB.js";import"./v-click-outside.umd-CELkDq_4.js";import"./image-editor-DLyFNrYo.js";import"./imagesloaded-CiBOXePe.js";import"./audio-player-DB3gnchP.js";import"./progress-bar-B9rhmJE5.js";import"./link-preview-DwBLj4bX.js";import"./tippy.esm-CNwAKjmm.js";import"./icon-tooltip-DTTAg3f3.js";import"./group-breakdown-Y0B0Fj6F.js";import"./file-drop-zone-k3mSA11T.js";import"./index-0KfMYapc.js";import"./index-Bg13tsda.js";import"./search-input-DVFOXWr1.js";import"./tabs-CEMTkU2L.js";import"./lazy-loading-container-CLEpcFXA.js";import"./lazyLoader-DDgORl6P.js";import"./kb-modal-Co_yRnCE.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./height-transition-Yxvq_2yb.js";import"./kb-emojione-wRy39u_c.js";import"./wrapper-alBC-qbb.js";import"./kudo-extra-items-Bh8eDPbb.js";import"./kudo-private-post-header-DGcAYO-d.js";import"./kb-emoji-picker-button-DdOxXFCR.js";import"./hashtags-DHVb0VSY.js";import"./hydrateAutomationVariables-cfgOmrRi.js";import"./toMentionList-ChEw0aGc.js";import"./kudo-image-CLg1zkO8.js";import"./moment-77skngPd.js";import"./loading-mask-Bta6Ex6U.js";import"./clipboard-BCrvPjZr.js";import"./icon-menu-button-ftrE2Rl_.js";import"./kudo-video-cP8SK4pp.js";import"./index-DlbyGdlB.js";import"./confirmation-button-inline-Cc-RRzwR.js";import"./recipient-thank-contributors-link-CDLbPIQY.js";import"./confirmation-modal-D9Gn2XEC.js";import"./js.cookie-DuAlAwQW.js";import"./experiments-CKD89MmP.js";import"./kudoboard-logo-JRaW8LiA.js";import"./dismiss-button-CmLYp9if.js";import"./hidden-posts-modal-21N6jOvg.js";import"./loading-button-HMnmYCkg.js";import"./share-CYQwZRIN.js";import"./loading-overlay-uVHC_bn2.js";import"./kb-emoji-picker-mixin-CA8FyG_S.js";import"./index-DQdVKf3e.js";import"./index-CnYJktDA.js";import"./input-dropdown-menu-zd31OiGX.js";import"./emojis-inCUWwM8.js";import"./link-tag-pdjP_02I.js";import"./preview-image-drop-BhqUracI.js";import"./image-drop-o5LvxNlZ.js";import"./index-D6fYY-3h.js";var ke={exports:{}},Xi=ke.exports,mt;function Zi(){return mt||(mt=1,function(e,t){(function(n,p){e.exports=p()})(Xi,function(){return function(n){var p={};function s(i){if(p[i])return p[i].exports;var c=p[i]={i,l:!1,exports:{}};return n[i].call(c.exports,c,c.exports,s),c.l=!0,c.exports}return s.m=n,s.c=p,s.d=function(i,c,u){s.o(i,c)||Object.defineProperty(i,c,{enumerable:!0,get:u})},s.r=function(i){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})},s.t=function(i,c){if(1&c&&(i=s(i)),8&c||4&c&&typeof i=="object"&&i&&i.__esModule)return i;var u=Object.create(null);if(s.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:i}),2&c&&typeof i!="string")for(var h in i)s.d(u,h,(function(b){return i[b]}).bind(null,h));return u},s.n=function(i){var c=i&&i.__esModule?function(){return i.default}:function(){return i};return s.d(c,"a",c),c},s.o=function(i,c){return Object.prototype.hasOwnProperty.call(i,c)},s.p="",s(s.s=0)}([function(n,p,s){function i(k,_,$){return _ in k?Object.defineProperty(k,_,{value:$,enumerable:!0,configurable:!0,writable:!0}):k[_]=$,k}function c(k){return(c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_){return typeof _}:function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _})(k)}var u;s.r(p);var h=function(k){return k<.5?4*k*k*k:(k-1)*(2*k-2)*(2*k-2)+1},b=function(){return{duration:500,offset:0,container:window,updateHistory:!0,easingFunction:null}},y=Symbol("smoothScrollCtx"),S=function(k){var _=k.scrollTo,$=k.offset,R=k.duration,L=k.container,M=k.updateHistory,V=k.hash,Q=k.easingFunction;u||(u=window.requestAnimationFrame||function(Be){return window.setTimeout(Be,16)}),M&&window.history.pushState&&location.hash!==V&&window.history.pushState("","",V);var ee,G,ue=typeof _=="number",ce=L.scrollTop||window.pageYOffset,me=(ue?_:(G=ce,(ee=_).nodeName==="HTML"?-G:ee.getBoundingClientRect().top+G))+$,_e=typeof Q=="function"?Q:h,Qt=Date.now();(function Be(){var at=Date.now()-Qt,lt=at<R,dt=lt?ce+(me-ce)*_e(at/R):me;lt?u(Be):M&&!ue&&location.replace("#"+_.id),L===window?L.scrollTo(0,dt):L.scrollTop=dt})()},I={install:function(k,_){var $,R=!k.version.startsWith("3"),L=function(){return _?Object.assign(b(),_):b()};k.directive("smooth-scroll",(i($={},R?"inserted":"mounted",function(V,Q,ee){if((typeof window>"u"?"undefined":c(window))==="object"&&window.pageYOffset!==void 0){var G=Object.assign(L(),Q.value);typeof G.container=="string"&&(G.container=document.querySelector(G.container));var ue=function(ce){ce.preventDefault();var me=R?ee.data.attrs.href:ee.props.href,_e=document.getElementById(me.substring(1));_e&&S(Object.assign(G,{scrollTo:_e,hash:me}))};V.addEventListener("click",ue),V[y]={clickHandler:ue}}}),i($,R?"unbind":"unmounted",function(V){V.removeEventListener("click",V[y].clickHandler),V[y]=null}),$));var M=function(V){var Q=Object.assign(L(),V);return S(Q)};(R?k.prototype:k.config.globalProperties).$smoothScroll=M,R||k.provide("smoothScroll",M)}};p.default=I}]).default})}(ke)),ke.exports}var en=Zi();const tn=ni(en),nn="weekly",sn="biweekly",rn="bifortnightly",pt="ongoing",Ue="ends_at",on="YYYY-MM-DD",ht="MMMM D, YYYY",an=7,ln={components:{DatePicker:Tt,DropdownSetting:Te,InputError:K,LoadingButton:H,OptionMenuItem:le,SettingsContainer:Z,ToggleButtonSetting:ve},props:{initialState:{type:Object,required:!0}},data(){return{isSaving:!1,reminderEmailCadenceError:"",reminderEmailTypeError:"",reminderEmailEndsAtError:"",startDate:A().add(an,"days").toDate()}},computed:{frequency(){return this.reminderEmailCadenceOptions.find(e=>e.name===this.boardReminderSettings.emailCadence).label},emailType(){return this.reminderEmailTypeOptions.find(e=>e.name===this.boardReminderSettings.emailType).label},...T(["boardReminderSettings","defaultTimezone"]),isSettingsDirty(){var e,t,n,p,s,i,c,u;return((e=this.initialState)==null?void 0:e.emailEnabled)!==((t=this.boardReminderSettings)==null?void 0:t.emailEnabled)||((n=this.initialState)==null?void 0:n.emailCadence)!==((p=this.boardReminderSettings)==null?void 0:p.emailCadence)||((s=this.initialState)==null?void 0:s.emailType)!==((i=this.boardReminderSettings)==null?void 0:i.emailType)||((c=this.initialState)==null?void 0:c.emailEndsAt)!==((u=this.boardReminderSettings)==null?void 0:u.emailEndsAt)},reminderEmailTypeOptions(){return[{name:pt,label:"Ongoing"},{name:Ue,label:"Select end date"}]},reminderEmailCadenceOptions(){return[{name:nn,label:"Every week"},{name:sn,label:"Every 2 weeks"},{name:rn,label:"Every 4 weeks"}]},reminderEmailTypeIsEndDate(e){return this.boardReminderSettings.emailType===Ue},datepickerPlaceholder(){return this.boardReminderSettings.emailEndsAt?A(this.boardReminderSettings.emailEndsAt,ht).format("L"):"MM/DD/YYYY"}},methods:{setHasReminderEmail(e){this.$store.commit("setReminderEmailEnabled",e),e===!1&&(this.$store.commit("setReminderEmailType",pt),this.$store.commit("setReminderEmailEndsAt",""))},setReminderEmailCadence(e){this.$refs.frequency.close(),this.$store.commit("setReminderEmailCadence",e)},setReminderEmailType(e){this.$refs.endDate.close(),this.$store.commit("setReminderEmailType",e),this.$store.commit("setReminderEmailEndsAt","")},setReminderEmailEndsAt(e){this.$store.commit("setReminderEmailType",Ue),this.$store.commit("setReminderEmailEndsAt",A(e,on).format(ht))},async handleSave(){var e,t,n,p,s,i,c,u,h,b;this.isSaving=!0;try{await this.$store.dispatch("updateBoardReminderSettings",{email_enabled:this.boardReminderSettings.emailEnabled,email_cadence:this.boardReminderSettings.emailCadence,email_type:this.boardReminderSettings.emailType,email_ends_at:this.boardReminderSettings.emailEndsAt}),x("Your changes were saved")}catch(y){((e=y==null?void 0:y.response)==null?void 0:e.status)!==422&&ie(y.response),(p=(n=(t=y==null?void 0:y.response)==null?void 0:t.data)==null?void 0:n.errors)!=null&&p.email_cadence&&(this.reminderEmailTypeError=y.response.data.errors.email_cadence.shift()),(c=(i=(s=y==null?void 0:y.response)==null?void 0:s.data)==null?void 0:i.errors)!=null&&c.email_type&&(this.reminderEmailTypeError=y.response.data.errors.email_type.shift()),(b=(h=(u=y==null?void 0:y.response)==null?void 0:u.data)==null?void 0:h.errors)!=null&&b.email_ends_at&&(this.reminderEmailEndsAtError=y.response.data.errors.email_ends_at.shift())}finally{this.isSaving=!1}}}},dn={class:"tw-mb-12"},un=["onClick"],cn=["onClick"],mn={key:0,class:"tw-w-full tw-flex tw-justify-end"},pn={class:"tw-mt-2 tw-w-[170px]"},hn={class:"drawer-container__footer"};function vn(e,t,n,p,s,i){const c=o("toggle-button-setting"),u=o("option-menu-item"),h=o("dropdown-setting"),b=o("date-picker"),y=o("settings-container"),S=o("loading-button");return l(),v("div",null,[a("div",dn,[t[4]||(t[4]=a("div",{class:"tw-text-lg tw-text-normal tw-text-gray-90 tw-mb-2"}," Enable board-wide email notifications to keep all invitees & participants engaged over time. ",-1)),d(y,null,{default:r(()=>[d(c,{"model-value":e.boardReminderSettings.emailEnabled,sync:!0,"sr-text":"Toggle inactivity reminder","tooltip-content":"Sends a reminder email to all invitees & participants who haven't posted lately.","onUpdate:modelValue":i.setHasReminderEmail},{default:r(()=>t[1]||(t[1]=[m(" Inactivity Reminder ")])),_:1},8,["model-value","onUpdate:modelValue"]),d(h,{ref:"frequency","tooltip-content":"Determines how often a reminder email is sent to users who haven't posted over the past interval."},{label:r(()=>t[2]||(t[2]=[m(" Frequency ")])),"button-text":r(()=>[m(C(i.frequency),1)]),default:r(()=>[(l(!0),v(E,null,O(i.reminderEmailCadenceOptions,I=>(l(),g(u,{key:I.name,value:I.name},{default:r(()=>[a("button",{onClick:k=>i.setReminderEmailCadence(I.name)},C(I.label),9,un)]),_:2},1032,["value"]))),128))]),_:1},512),d(h,{ref:"endDate","tooltip-content":"Automatically turn off reminder emails as of a certain date. Works well for time-limited boards (e.g. Quarterly Shout outs, etc)."},{label:r(()=>t[3]||(t[3]=[m(" End Date ")])),"button-text":r(()=>[m(C(i.emailType),1)]),extra:r(()=>[i.reminderEmailTypeIsEndDate?(l(),v("div",mn,[a("div",pn,[d(b,{"min-date":s.startDate,start:s.startDate,placeholder:i.datepickerPlaceholder,"onUpdate:modelValue":i.setReminderEmailEndsAt},null,8,["min-date","start","placeholder","onUpdate:modelValue"])])])):f("",!0)]),default:r(()=>[(l(!0),v(E,null,O(i.reminderEmailTypeOptions,I=>(l(),g(u,{key:I.name,value:I.name},{default:r(()=>[a("button",{onClick:k=>i.setReminderEmailType(I.name)},C(I.label),9,cn)]),_:2},1032,["value"]))),128))]),_:1},512)]),_:1})]),a("div",hn,[d(S,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isSettingsDirty,"is-loading":s.isSaving,onClick:i.handleSave},{default:r(()=>t[5]||(t[5]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[0]||(t[0]=I=>e.$router.replace({name:"settings"}))}," Cancel ")])])}const gn=w(ln,[["render",vn],["__scopeId","data-v-2a54bd05"]]),fn={components:{InputError:K,LoadingButton:H,MessagingAutocomplete:Re,SettingsContainer:Z,ToggleButtonSetting:ve},props:{initialState:{type:Object,required:!0}},data(){var e,t,n;return{isSaving:!1,reminderSlackChannelError:null,channel:{slack_channel_id:((e=this.initialState)==null?void 0:e.slackChannelId)??"",slack_channel_name:((t=this.initialState)==null?void 0:t.slackChannelName)??"",slack_channel_real_name:null},channelName:((n=this.initialState)==null?void 0:n.slackChannelName)??""}},computed:{...T(["boardReminderSettings","defaultTimezone"]),isSettingsDirty(){var e,t,n,p,s,i;return((e=this.initialState)==null?void 0:e.slackEnabled)!==((t=this.boardReminderSettings)==null?void 0:t.slackEnabled)||((n=this.initialState)==null?void 0:n.slackChannelId)!==((p=this.boardReminderSettings)==null?void 0:p.slackChannelId)||((s=this.initialState)==null?void 0:s.slackChannelName)!==((i=this.boardReminderSettings)==null?void 0:i.slackChannelName)}},watch:{boardReminderSettings:{deep:!0,handler(e){this.channelName=(e==null?void 0:e.slackChannelName)||""}},initialState:{deep:!0,handler(e){this.channelName=(e==null?void 0:e.slackChannelName)??"",this.channel.slack_channel_id=(e==null?void 0:e.slackChannelId)??"",this.channel.slack_channel_name=this.channelName,this.channel.slack_channel_real_name=null}}},methods:{setChannel(e,t,n){this.channelName=t??"",this.channel={slack_channel_id:e??"",slack_channel_name:this.channelName,slack_channel_real_name:n??null}},handleChannelAutoComplete(e){this.setChannel(e.id,e.name,e.real_name),this.setReminderSlackChannel(this.channel)},setReminderSlackEnabled(e){this.$store.commit("setReminderSlackEnabled",!!e),e===!1&&(this.$store.commit("setReminderSlackChannel",""),this.setChannel("","",null))},setReminderSlackChannel(e){this.$store.commit("setReminderSlackChannel",e)},async handleSave(){var e,t;this.isSaving=!0;try{await this.$store.dispatch("updateBoardReminderSettings",{slack_enabled:this.boardReminderSettings.slackEnabled,slack_channel_id:this.boardReminderSettings.slackChannelId,slack_channel_name:this.boardReminderSettings.slackChannelName}),this.isSaving=!1,x("Your changes were saved.")}catch(n){this.isSaving=!1,(e=n.response.data.errors)!=null&&e.slack_channel_id&&(this.reminderSlackChannelError=n.response.data.errors.slack_channel_id.shift()),(t=n.response.data.errors)!=null&&t.slack_channel_name&&(this.reminderSlackChannelError=n.response.data.errors.slack_channel_name.shift())}}}},bn={class:"tw-mb-7"},yn={class:"drawer-container__footer"};function _n(e,t,n,p,s,i){const c=o("messaging-autocomplete"),u=o("input-error"),h=o("toggle-button-setting"),b=o("settings-container"),y=o("loading-button");return l(),v("div",null,[t[4]||(t[4]=a("div",{class:"tw-text-lg tw-text-normal tw-text-gray-90 tw-mb-2"}," Enable Slack notifications to keep all invitees & participants engaged over time. ",-1)),a("div",bn,[d(b,null,{default:r(()=>[d(h,{"tooltip-content":"Sends updates to the Slack channel of your choice when new posts are added to the board.","model-value":e.boardReminderSettings.slackEnabled,"sr-text":"Toggle real-time activity Slack updates","onUpdate:modelValue":i.setReminderSlackEnabled},Se({default:r(()=>[t[2]||(t[2]=m(" Real-Time Activity "))]),_:2},[e.boardReminderSettings.slackEnabled?{name:"extra",fn:r(()=>[d(u,{error:s.reminderSlackChannelError,class:"tw-mt-2"},{default:r(()=>[d(c,{modelValue:s.channelName,"onUpdate:modelValue":t[0]||(t[0]=S=>s.channelName=S),url:"/api/messaging/autocomplete/search?type=channels&",placeholder:"Enter channel name",class:"tw-mb-5",onSelected:i.handleChannelAutoComplete},null,8,["modelValue","onSelected"])]),_:1},8,["error"])]),key:"0"}:void 0]),1032,["model-value","onUpdate:modelValue"])]),_:1})]),a("div",yn,[d(y,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isSettingsDirty,loading:s.isSaving,onClick:i.handleSave},{default:r(()=>t[3]||(t[3]=[m(" Save changes ")])),_:1},8,["disabled","loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[1]||(t[1]=S=>e.$router.replace({name:"settings"}))}," Cancel ")])])}const wn=w(fn,[["render",_n]]),kn={components:{InputError:K,LoadingButton:H,MessagingAutocomplete:Re,SettingsContainer:Z,ToggleButtonSetting:ve},props:{initialState:{type:Object,required:!0}},data(){var e,t,n;return{isSaving:!1,reminderTeamsChannelError:"",channel:{teams_channel_id:((e=this.initialState)==null?void 0:e.teamsChannelId)??"",teams_channel_name:((t=this.initialState)==null?void 0:t.teamsChannelName)??"",teams_channel_real_name:null},channelName:((n=this.initialState)==null?void 0:n.teamsChannelName)??""}},computed:{...T(["boardReminderSettings","defaultTimezone"]),isSettingsDirty(){var e,t,n,p,s,i;return((e=this.initialState)==null?void 0:e.teamsEnabled)!==((t=this.boardReminderSettings)==null?void 0:t.teamsEnabled)||((n=this.initialState)==null?void 0:n.teamsChannelId)!==((p=this.boardReminderSettings)==null?void 0:p.teamsChannelId)||((s=this.initialState)==null?void 0:s.teamsChannelName)!==((i=this.boardReminderSettings)==null?void 0:i.teamsChannelName)}},watch:{boardReminderSettings:{deep:!0,handler(e){this.channelName=(e==null?void 0:e.teamsChannelName)||""}}},methods:{async handleSave(){var e,t;this.isSaving=!0;try{await this.$store.dispatch("updateBoardReminderSettings",{teams_enabled:this.boardReminderSettings.teamsEnabled,teams_channel_id:this.boardReminderSettings.teamsChannelId,teams_channel_name:this.boardReminderSettings.teamsChannelName}),this.isSaving=!1,x("Your changes were saved.")}catch(n){this.isSaving=!1,(e=n.response.data.errors)!=null&&e.teams_channel_id&&(this.reminderTeamsChannelError=n.response.data.errors.teams_channel_id.shift()),(t=n.response.data.errors)!=null&&t.teams_channel_name&&(this.reminderTeamsChannelError=n.response.data.errors.teams_channel_name.shift())}},setChannel(e,t,n){this.channelName=t??"",this.channel={teams_channel_id:e??"",teams_channel_name:this.channelName,teams_channel_real_name:n??null}},handleChannelAutoComplete(e){this.setChannel(e.id,e.name,e.real_name),this.setReminderTeamsChannel(this.channel)},setReminderTeamsEnabled(e){this.$store.commit("setReminderTeamsEnabled",!!e),e===!1&&(this.$store.commit("setReminderTeamsChannel",""),this.setChannel("","",null))},setReminderTeamsChannel(e){this.$store.commit("setReminderTeamsChannel",e)}}},Cn={class:"tw-mb-7"},Sn={class:"drawer-container__footer"};function In(e,t,n,p,s,i){const c=o("messaging-autocomplete"),u=o("input-error"),h=o("toggle-button-setting"),b=o("settings-container"),y=o("loading-button");return l(),v("div",null,[t[4]||(t[4]=a("div",{class:"tw-text-lg tw-text-normal tw-text-gray-90 tw-mb-2"}," Enable MS Teams notifications to keep all invitees & participants engaged over time. ",-1)),a("div",Cn,[d(b,null,{default:r(()=>[d(h,{"tooltip-content":"Sends updates to the Teams channel of your choice when new posts are added to the board.","model-value":e.boardReminderSettings.teamsEnabled,"sr-text":"Toggle real-time activity Teams updates","onUpdate:modelValue":i.setReminderTeamsEnabled},Se({default:r(()=>[t[2]||(t[2]=m(" Real-Time Activity "))]),_:2},[e.boardReminderSettings.teamsEnabled?{name:"extra",fn:r(()=>[d(u,{error:s.reminderTeamsChannelError,class:"tw-mt-2"},{default:r(()=>[d(c,{modelValue:s.channelName,"onUpdate:modelValue":t[0]||(t[0]=S=>s.channelName=S),url:"/api/messaging/autocomplete/search?type=channels&",placeholder:"Enter channel name",class:"tw-mb-5",onSelected:i.handleChannelAutoComplete},null,8,["modelValue","onSelected"])]),_:1},8,["error"])]),key:"0"}:void 0]),1032,["model-value","onUpdate:modelValue"])]),_:1})]),a("div",Sn,[d(y,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isSettingsDirty,loading:s.isSaving,onClick:i.handleSave},{default:r(()=>t[3]||(t[3]=[m(" Save changes ")])),_:1},8,["disabled","loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[1]||(t[1]=S=>e.$router.replace({name:"settings"}))}," Cancel ")])])}const Tn=w(kn,[["render",In]]),En={components:{Container:q,ReminderScheduleEmail:gn,ReminderScheduleSlack:wn,ReminderScheduleTeams:Tn,Tab:Ee,Tabs:De},data(){return{defaultToEmail:!0,initialState:{}}},computed:{...T(["isEditMode","boardReminderSettings"]),...T(["isSlackConnected","isTeamsConnected"])},async beforeMount(){this.setDefaultTab(),this.initialState=JSON.parse(JSON.stringify(await this.$store.dispatch("fetchBoardReminderSettings")))},methods:{setDefaultTab(){const e=new URLSearchParams(window.location.search).get("tab");e&&(this.defaultToEmail=e==="email")},initialEmailState(){return{emailEnabled:this.initialState.emailEnabled,emailCadence:this.initialState.emailCadence,emailType:this.initialState.emailType,emailEndsAt:this.initialState.emailEndsAt}},initialSlackState(){return{slackEnabled:this.initialState.slackEnabled,slackChannelId:this.initialState.slackChannelId,slackChannelName:this.initialState.slackChannelName}},initialTeamsState(){return{teamsEnabled:this.initialState.teamsEnabled,teamsChannelId:this.initialState.teamsChannelId,teamsChannelName:this.initialState.teamsChannelName}}}};function Dn(e,t,n,p,s,i){const c=o("reminder-schedule-email"),u=o("tab"),h=o("reminder-schedule-slack"),b=o("reminder-schedule-teams"),y=o("tabs"),S=o("container");return l(),g(S,null,{header:r(()=>t[0]||(t[0]=[m(" Engagement Reminders ")])),default:r(()=>[d(y,null,{default:r(()=>[d(u,{id:"email",order:1,title:"Email",active:s.defaultToEmail},{default:r(()=>[d(c,{"initial-state":i.initialEmailState()},null,8,["initial-state"])]),_:1},8,["active"]),e.isSlackConnected?(l(),g(u,{key:0,id:"slack",order:2,title:"Slack"},{default:r(()=>[d(h,{"initial-state":i.initialSlackState()},null,8,["initial-state"])]),_:1})):f("",!0),e.isTeamsConnected?(l(),g(u,{key:1,id:"teams",order:3,title:"MS Teams"},{default:r(()=>[d(b,{"initial-state":i.initialTeamsState()},null,8,["initial-state"])]),_:1})):f("",!0)]),_:1})]),_:1})}const Rn=w(En,[["render",Dn],["__scopeId","data-v-b2751a86"]]),Mn={components:{Container:q},props:{backCallback:{type:Function,default:null}}},$n={key:0,class:"tw-text-xl tw-text-black tw-font-semibold tw-mb-4 tw-flex tw-items-center"},Bn={class:"tw-flex tw-flex-col tw-gap-y-1.5"},Un={key:1,class:"drawer-container__footer"};function An(e,t,n,p,s,i){const c=o("container");return l(),g(c,{"back-callback":n.backCallback},{header:r(()=>[D(e.$slots,"drawer-header")]),default:r(()=>[e.$slots.header?(l(),v("div",$n,[D(e.$slots,"header")])):f("",!0),a("div",Bn,[D(e.$slots,"default")]),e.$slots.footer?(l(),v("div",Un,[D(e.$slots,"footer")])):f("",!0)]),_:3},8,["back-callback"])}const tt=w(Mn,[["render",An]]),xn={},Nn={class:"tw-flex tw-flex-col tw-mb-4"},Gn={class:"tw-font-semibold tw-mb-2 tw-text-base"},On={class:"tw-flex tw-flex-col tw-gap-y-1.5"};function Pn(e,t){return l(),v("div",Nn,[a("div",Gn,[D(e.$slots,"header")]),a("div",On,[D(e.$slots,"default")])])}const it=w(xn,[["render",Pn]]),Ln={emits:["click"]},Vn={class:"tw-flex tw-items-center"};function zn(e,t,n,p,s,i){return l(),v("div",{class:"list-item",onClick:t[0]||(t[0]=c=>e.$emit("click"))},[a("span",Vn,[D(e.$slots,"default",{},void 0,!0)])])}const nt=w(Ln,[["render",zn],["__scopeId","data-v-f4c7024a"]]),Fn={components:{ListItem:nt,Icon:U,Tooltip:je},props:{member:{type:Object,required:!0},excluded:{type:Boolean,required:!0}}},qn={class:"tw-mr-1"},Yn={key:1};function Hn(e,t,n,p,s,i){const c=o("tooltip"),u=o("icon"),h=o("list-item");return l(),g(h,{class:W({excluded:n.excluded}),onClick:t[0]||(t[0]=b=>n.excluded?e.$emit("include"):e.$emit("exclude"))},{default:r(()=>[a("span",qn,[n.member.name?(l(),g(c,{key:0,content:n.member.email},{default:r(()=>[m(C(n.member.name),1)]),_:1},8,["content"])):f("",!0),n.member.name?f("",!0):(l(),v("span",Yn,C(n.member.email),1))]),n.excluded?(l(),g(u,{key:0,fill:"",type:"plus"})):(l(),g(u,{key:1,fill:"",type:"close"}))]),_:1},8,["class"])}const jn=w(Fn,[["render",Hn],["__scopeId","data-v-2ac2a4e9"]]),Wn={props:{excluded:{type:Boolean,default:!1}}},Kn={key:0,class:"status"};function Qn(e,t,n,p,s,i){return n.excluded?(l(),v("div",Kn,t[0]||(t[0]=[a("i",{class:"fa fa-circle excluded"},null,-1),m(" Excluded ")]))):f("",!0)}const Jn=w(Wn,[["render",Qn],["__scopeId","data-v-05ac136d"]]),Xn={components:{Modal:fe}};function Zn(e,t,n,p,s,i){const c=o("modal");return l(),g(c,{onClose:t[1]||(t[1]=u=>e.$emit("close"))},{header:r(()=>t[2]||(t[2]=[m(" It's not possible to remove all users from this group list ")])),footer:r(()=>[a("button",{class:"btn-p btn-p-primary",type:"button",onClick:t[0]||(t[0]=u=>e.$emit("close"))}," Okay ")]),default:r(()=>[t[3]||(t[3]=m(" You need to remove the group from the contributor invite field if you want to remove all group users. "))]),_:1})}const es=w(Xn,[["render",Zn]]),ts={components:{Modal:fe}};function is(e,t,n,p,s,i){const c=o("modal");return l(),g(c,{onClose:t[2]||(t[2]=u=>e.$emit("close"))},{header:r(()=>t[3]||(t[3]=[m(" You have unsaved changes ")])),footer:r(()=>[a("button",{class:"btn-p btn-p-primary",type:"button",onClick:t[0]||(t[0]=u=>e.$emit("close"))}," Stay here "),a("button",{class:"btn-p btn-p-secondary",type:"button",onClick:t[1]||(t[1]=u=>e.$emit("discard"))}," Discard changes ")]),default:r(()=>[t[4]||(t[4]=m(" You have unsaved changes. Are you sure you want to leave this page? Unsaved changes will be lost. "))]),_:1})}const ns=w(ts,[["render",is]]),ss={components:{TeleportWrapper:ge,Icon:U,GroupMember:jn,GroupMemberStatus:Jn,AllMembersRemovedModal:es,AbandonChangesWarningModal:ns,ListItems:it,UsersList:tt},data(){return{localGroups:[],localExcluded:{},isClosingSidebar:!1,isShowingAllMembersRemovedModal:!1,isShowingAbandonChangesWarningModal:!1}},computed:{targetGroup(){return this.isDeliveryRoute?this.recipientGroup:this.inviteeGroup},excluded(){return this.isDeliveryRoute?this.excludedRecipientGroupMembers:this.excludedInviteeGroupMembers},isDeliveryRoute(){return this.$route.name==="group-recipient"},isInviteRoute(){return this.$route.name==="group-invited"},routeData(){return this.isInviteRoute?{backButtonText:"Add contributors",backRoute:"invite-contributors",tab:"email"}:this.isDeliveryRoute?{backButtonText:"Add recipients",backRoute:"delivery",tab:null}:{backButtonText:"Back",backRoute:"/",tab:null}},header(){var e;return`${(e=this.targetGroup)==null?void 0:e.name} (${this.groupUsersCountAfterExclusions})`},members(){return this.targetGroup?this.targetGroup.users:[]},recipientUserIds(){return this.pendingIndividualRecipients.filter(e=>e.user_id).map(e=>e.user_id)},nonBoardRecipientMembers(){return this.members.filter(e=>!this.recipientUserIds.includes(e.id))},boardRecipientMembers(){return this.members.filter(e=>this.recipientUserIds.includes(e.id))},excludedMembersCount(){var t,n;const e=((n=(t=this.targetGroup)==null?void 0:t.users)==null?void 0:n.map(p=>p.id))||[];return e?Object.keys(this.localExcluded).filter(p=>e.includes(+p)).length:0},groupUsersCount(){var e;return(e=this.targetGroup)==null?void 0:e.users_count},groupUsersCountAfterExclusions(){return this.groupUsersCount-this.excludedMembersCount},hasAllMembersRemoved(){return this.excludedMembersCount>=this.groupUsersCount},isDirty(){const e=Object.keys(this.excluded),t=Object.keys(this.localExcluded);return e.length!==t.length||e.some(n=>!t.includes(n))},...T({inviteeGroup:e=>e.invites.targetGroup,inviteeGroups:e=>e.invites.emailGroupInvitees,excludedInviteeGroupMembers:e=>e.invites.emailExcludedGroupMembers,recipientGroup:e=>e.delivery.targetGroup,recipientGroups:e=>e.delivery.pendingGroupRecipients,pendingIndividualRecipients:e=>e.delivery.pendingIndividualRecipients,excludedRecipientGroupMembers:e=>e.delivery.pendingExcludedGroupMembers})},watch:{groupUsersCountAfterExclusions(e){var t;Number.isNaN(e)||!((t=this.localGroups)!=null&&t.length)||(this.localGroups=this.localGroups.map(n=>{const p=n.id||n.groupId;if(+this.targetGroup.id==+p){const s=this.isDeliveryRoute?"users_count":"usersCount";return{...n,[s]:e}}return n}))},excludedInviteeGroupMembers:{deep:!0,immediate:!0,handler(e){this.localExcluded=e}},excludedRecipientGroupMembers:{deep:!0,immediate:!0,handler(e){this.localExcluded=e}},inviteeGroups:{deep:!0,immediate:!0,handler(e){this.localGroups=e}},recipientGroups:{deep:!0,immediate:!0,handler(e){this.localGroups=e}}},mounted(){this.$emit("allow-close-function",this.allowSidebarClose),this.setData()},beforeUnmount(){this.$emit("allow-close-function",null)},methods:{setData(){if(this.isDeliveryRoute){this.localGroups=[...this.recipientGroups],this.localExcluded={...this.excludedRecipientGroupMembers};return}this.localGroups=[...this.inviteeGroups],this.localExcluded={...this.excludedInviteeGroupMembers}},allowSidebarClose(){return this.isDirty?(this.isShowingAbandonChangesWarningModal=!0,this.isClosingSidebar=!0,!1):!0},handleGoBackClicked(){if(this.isDirty){this.isShowingAbandonChangesWarningModal=!0;return}this.handleDiscard()},handleDiscard(){if(this.isClosingSidebar){this.$emit("allow-close-function",null),P.emitter.emit("settings:hide");return}this.$router.replace({name:this.routeData.backRoute,params:{incomingTab:this.routeData.tab}})},handleConfirmGroup(){if(this.hasAllMembersRemoved){this.isShowingAllMembersRemovedModal=!0;return}this.storeData(),this.$router.replace({name:this.routeData.backRoute,params:{incomingTab:this.routeData.tab}})},storeData(){this.isDeliveryRoute&&(this.$store.commit("pendingExcludedGroupMembers",this.localExcluded),this.$store.commit("pendingGroupRecipients",this.localGroups)),this.$store.commit("setEmailGroupInvitees",this.localGroups),this.$store.commit("setEmailInviteExcludedGroupMembers",this.localExcluded)},handleExcludeMember(e){if(this.excludedMembersCount+1===this.groupUsersCount){this.isShowingAllMembersRemovedModal=!0;return}this.localExcluded[e.id]=!0}}},rs={class:"tw-mr-1"};function os(e,t,n,p,s,i){const c=o("icon"),u=o("group-member"),h=o("group-member-status"),b=o("list-items"),y=o("all-members-removed-modal"),S=o("abandon-changes-warning-modal"),I=o("teleport-wrapper"),k=o("users-list");return l(),g(k,{"back-callback":i.handleGoBackClicked},{"drawer-header":r(()=>[m(C(i.isDeliveryRoute?"Board Delivery":"Invite Contributors"),1)]),header:r(()=>[a("span",rs,C(i.header),1),d(c,{fill:"",type:"invites",class:"tw-text-icon"})]),footer:r(()=>[a("button",{class:"btn-p-lg btn-p-primary",type:"button",onClick:t[0]||(t[0]=(..._)=>i.handleConfirmGroup&&i.handleConfirmGroup(..._))}," Confirm group ")]),default:r(()=>[i.isDeliveryRoute?(l(),g(b,{key:0},{default:r(()=>[(l(!0),v(E,null,O(i.members,_=>(l(),v("div",{key:_.id,class:"tw-flex tw-justify-between tw-items-center"},[d(u,{member:_,excluded:!!s.localExcluded[_.id],onExclude:()=>i.handleExcludeMember(_),onInclude:()=>delete s.localExcluded[_.id]},null,8,["member","excluded","onExclude","onInclude"]),d(h,{excluded:!!s.localExcluded[_.id]},null,8,["excluded"])]))),128))]),_:1})):(l(),v(E,{key:1},[i.boardRecipientMembers.length?(l(),g(b,{key:0},{header:r(()=>t[3]||(t[3]=[m(" Board recipient(s) ")])),default:r(()=>[(l(!0),v(E,null,O(i.boardRecipientMembers,_=>(l(),v("div",{key:_.id,class:"tw-flex tw-justify-between tw-items-center"},[d(u,{member:_,excluded:!!s.localExcluded[_.id],onExclude:()=>i.handleExcludeMember(_),onInclude:()=>delete s.localExcluded[_.id]},null,8,["member","excluded","onExclude","onInclude"]),d(h,{excluded:!!s.localExcluded[_.id]},null,8,["excluded"])]))),128))]),_:1})):f("",!0),i.nonBoardRecipientMembers.length?(l(),g(b,{key:1},Se({default:r(()=>[(l(!0),v(E,null,O(i.nonBoardRecipientMembers,_=>(l(),v("div",{key:_.id,class:"tw-flex tw-justify-between tw-items-center"},[d(u,{member:_,excluded:!!s.localExcluded[_.id],onExclude:()=>i.handleExcludeMember(_),onInclude:()=>delete s.localExcluded[_.id]},null,8,["member","excluded","onExclude","onInclude"]),d(h,{excluded:!!s.localExcluded[_.id]},null,8,["excluded"])]))),128))]),_:2},[i.boardRecipientMembers.length?{name:"header",fn:r(()=>[t[4]||(t[4]=m(" Group member(s) "))]),key:"0"}:void 0]),1024)):f("",!0)],64)),d(I,{to:"#modals"},{default:r(()=>[s.isShowingAllMembersRemovedModal?(l(),g(y,{key:0,onClose:t[1]||(t[1]=_=>s.isShowingAllMembersRemovedModal=!1)})):f("",!0),s.isShowingAbandonChangesWarningModal?(l(),g(S,{key:1,onClose:t[2]||(t[2]=_=>{s.isShowingAbandonChangesWarningModal=!1,s.isClosingSidebar=!1}),onDiscard:i.handleDiscard},null,8,["onDiscard"])):f("",!0)]),_:1})]),_:1},8,["back-callback"])}const vt=w(ss,[["render",os]]),as={components:{CtaOverlayBadge:oi,Setting:ae,TemplateButton:Et},mixins:[Ye],computed:{...re(J,["templateId"]),...B(["isBoardLocked","isHeaderColorHidden"]),allowChangingTemplate(){return this.can("canChangeTemplate")&&!this.isBoardLocked}},methods:{handleTemplateClicked(){this.allowChangingTemplate&&this.$router.replace({name:"backgrounds"})}}};function ls(e,t,n,p,s,i){const c=o("template-button"),u=o("cta-overlay-badge"),h=o("setting");return l(),g(h,{class:"background"},{label:r(()=>t[0]||(t[0]=[m(" Background ")])),setting:r(()=>[d(u,{"icon-type":"edit"},{badge:r(()=>t[1]||(t[1]=[m(" Change ")])),default:r(()=>[d(c,{"class-name":e.templateId?`kb-template-${e.templateId}`:null,"show-badges":!1,style:Jt({cursor:i.allowChangingTemplate?"pointer":"auto"}),"is-header-color-hidden":e.isHeaderColorHidden,onClick:i.handleTemplateClicked},null,8,["class-name","style","is-header-color-hidden","onClick"])]),_:1})]),_:1})}const ds=w(as,[["render",ls],["__scopeId","data-v-092d6cbc"]]),us={components:{Icon:U,Setting:ae},props:{disabled:{type:Boolean,default:!1},tooltipContent:{type:String,default:null}}},cs=["disabled"];function ms(e,t,n,p,s,i){const c=o("icon"),u=o("setting");return l(),g(u,{"tooltip-content":n.tooltipContent},{label:r(()=>[D(e.$slots,"label",{},void 0,!0)]),setting:r(()=>[a("button",{class:"navigation-button",disabled:n.disabled,onClick:t[0]||(t[0]=h=>e.$emit("click"))},[a("span",null,[D(e.$slots,"default",{},void 0,!0)]),n.disabled?f("",!0):(l(),g(c,{key:0,fill:"",type:"chevron-right",class:"tw-text-gray-80"}))],8,cs)]),default:r(()=>[D(e.$slots,"default",{},void 0,!0)]),_:3},8,["tooltip-content"])}const st=w(us,[["render",ms],["__scopeId","data-v-f315520d"]]),ps={components:{NavigationSetting:st},computed:{...B(["canEditBoard","isSinglePostBoard","typefaceName"])}};function hs(e,t,n,p,s,i){const c=o("navigation-setting");return e.isSinglePostBoard?(l(),g(c,{key:0,disabled:!e.canEditBoard,onClick:t[0]||(t[0]=()=>e.$router.replace({name:"fonts"}))},{label:r(()=>t[1]||(t[1]=[m(" Body font ")])),default:r(()=>[m(" "+C(e.typefaceName),1)]),_:1},8,["disabled"])):f("",!0)}const vs=w(ps,[["render",hs]]),gs={components:{DropdownSetting:Te,OptionMenuItem:le},data(){return{fontSizeOptions:[{text:"Small",value:"sm"},{text:"Medium",value:"md"},{text:"Large",value:"lg"}]}},computed:{...T({boardBodyFontSize:e=>e.board.body_font_size}),...B(["canEditBoard","isSinglePostBoard"]),bodyFontSize(){return this.fontSizeOptions.find(e=>e.value===this.boardBodyFontSize).text}}},fs=["onClick"];function bs(e,t,n,p,s,i){const c=o("option-menu-item"),u=o("dropdown-setting");return e.isSinglePostBoard?(l(),g(u,{key:0,disabled:!e.canEditBoard},{label:r(()=>t[0]||(t[0]=[m(" Body font size ")])),"button-text":r(()=>[m(C(i.bodyFontSize),1)]),default:r(()=>[(l(!0),v(E,null,O(s.fontSizeOptions,h=>(l(),g(c,{key:h.value},{default:r(()=>[a("button",{onClick:b=>e.$store.dispatch("setBodyFontSize",h.value)},C(h.text),9,fs)]),_:2},1024))),128))]),_:1},8,["disabled"])):f("",!0)}const ys=w(gs,[["render",bs]]),_s={components:{NavigationSetting:st},props:{disabled:{type:Boolean,default:!0}},computed:{...B(["canEditBoard","isSinglePostBoard","typefaceName"])}};function ws(e,t,n,p,s,i){const c=o("navigation-setting");return e.isSinglePostBoard?f("",!0):(l(),g(c,{key:0,disabled:!e.canEditBoard,onClick:t[0]||(t[0]=()=>e.$router.replace({name:"fonts"}))},{label:r(()=>t[1]||(t[1]=[m(" Font ")])),default:r(()=>[m(" "+C(e.typefaceName),1)]),_:1},8,["disabled"]))}const ks=w(_s,[["render",ws]]),Cs={components:{NavigationSetting:st},computed:{...T({titleFontClass:e=>e.board.title_font_class}),...T(["typefaces"]),...B(["canEditBoard","isSinglePostBoard"]),titleTypefaceName(){return this.titleFontClass?this.typefaces.find(e=>e.name===this.titleFontClass).display_name:"Museo Sans (default)"}}};function Ss(e,t,n,p,s,i){const c=o("navigation-setting");return e.isSinglePostBoard?(l(),g(c,{key:0,disabled:!e.canEditBoard,onClick:t[0]||(t[0]=()=>e.$router.replace({name:"title-fonts"}))},{label:r(()=>t[1]||(t[1]=[m(" Title font ")])),default:r(()=>[m(" "+C(i.titleTypefaceName),1)]),_:1},8,["disabled"])):f("",!0)}const Is=w(Cs,[["render",Ss]]),Ts={components:{DropdownSetting:Te,OptionMenuItem:le},data(){return{fontSizeOptions:[{text:"Small",value:"sm"},{text:"Medium",value:"md"},{text:"Large",value:"lg"}]}},computed:{...T({boardTitleFontSize:e=>e.board.title_font_size}),...B(["canEditBoard","isSinglePostBoard"]),titleFontSize(){return this.fontSizeOptions.find(e=>e.value===this.boardTitleFontSize).text}}},Es=["onClick"];function Ds(e,t,n,p,s,i){const c=o("option-menu-item"),u=o("dropdown-setting");return e.isSinglePostBoard?(l(),g(u,{key:0,disabled:!e.canEditBoard},{label:r(()=>t[0]||(t[0]=[m(" Title font size ")])),"button-text":r(()=>[m(C(i.titleFontSize),1)]),default:r(()=>[(l(!0),v(E,null,O(s.fontSizeOptions,h=>(l(),g(c,{key:h.value},{default:r(()=>[a("button",{onClick:b=>e.$store.dispatch("setTitleFontSize",h.value)},C(h.text),9,Es)]),_:2},1024))),128))]),_:1},8,["disabled"])):f("",!0)}const Rs=w(Ts,[["render",Ds]]),Ms={components:{InputError:Dt,TextInput:be},directives:{focus:We},props:{fullUrl:{type:String,required:!0},boardId:{type:String,required:!0},customUrl:{type:String,default:""},isEditing:{type:Boolean,required:!0},disabled:{type:Boolean,required:!1}},data(){return{isFocused:!1,url:this.customUrl||"",error:""}},methods:{handleSubmit(){if(this.validate()){if(!this.customUrl&&!this.url){this.handleCancel();return}this.url!==this.customUrl&&this.$emit("submit",this.url)}},handleCancel(){this.$emit("cancel")},validate(){return this.error="",this.url.length>255?(this.error="The URL cannot be more than 255 characters.",!1):this.url&&!/^[a-zA-Z0-9][\w-]*[a-zA-Z0-9]$/.test(this.url)?(this.error="The URL must only contain letters, numbers, and dashes.",!1):!0}}},$s={class:"tw-mt-1"},Bs={key:0},Us={class:"input-container tw-relative tw-w-full"},As={class:"tw-mt-3"},xs=["disabled"];function Ns(e,t,n,p,s,i){const c=o("text-input"),u=o("input-error"),h=kt("focus");return l(),v("div",$s,[n.isEditing?(l(),v("div",Bs,[a("form",{onSubmit:t[6]||(t[6]=Ie((...b)=>i.handleSubmit&&i.handleSubmit(...b),["prevent"]))},[d(u,{error:s.error},{default:r(()=>[a("div",Us,[a("div",{class:"input-group-addon",onClick:t[0]||(t[0]=()=>e.$refs.input.focus())}," .../"+C(n.boardId)+"/ ",1),Y(d(c,{ref:"input",modelValue:s.url,"onUpdate:modelValue":t[1]||(t[1]=b=>s.url=b),type:"text",maxlength:"255",class:"tw-input-md",onFocus:t[2]||(t[2]=b=>s.isFocused=!0),onBlur:t[3]||(t[3]=b=>s.isFocused=!1),onKeydown:Ce(i.handleCancel,["esc"])},null,8,["modelValue","onKeydown"]),[[h]])])]),_:1},8,["error"]),a("div",As,[a("button",{class:"btn-p btn-p-primary tw-mr-2",onClick:t[4]||(t[4]=(...b)=>i.handleSubmit&&i.handleSubmit(...b))}," Save "),a("button",{class:"btn-p btn-p-secondary",onClick:t[5]||(t[5]=(...b)=>i.handleCancel&&i.handleCancel(...b))}," Cancel ")])],32)])):f("",!0),Y(a("div",null,[a("button",{class:"edit-button",disabled:n.disabled,onClick:t[7]||(t[7]=b=>e.$emit("edit"))},C(n.fullUrl),9,xs)],512),[[j,!n.isEditing]])])}const Gs=w(Ms,[["render",Ns],["__scopeId","data-v-7523850f"]]),Os={components:{CopyButton:Ke,Editor:Gs,Icon:U,Setting:ae,Tooltip:je},directives:{focus:We},data(){return{isEditing:!1}},computed:{...T({customUrl:e=>e.board.custom_url}),...T(["isConsumer"]),...B(["boardPublicId","boardUrl","canEditBoard","isMemorialBoard"])},methods:{handleUrlCopyError(){ie("Error copying board url")},handleUrlCopied(){x("Board URL copied")},async handleCustomUrlSubmit(e){this.isEditing=!1;const{success:t}=await this.$store.dispatch("setCustomUrl",e);t&&(x("Your custom url has been updated! Reloading..."),setTimeout(()=>{window.location.href=this.boardUrl},1e3))}}};function Ps(e,t,n,p,s,i){const c=o("icon"),u=o("copy-button"),h=o("tooltip"),b=o("editor"),y=o("setting");return!e.isConsumer||e.isMemorialBoard?(l(),g(y,{key:0,"tooltip-content":"Add a descriptive ending to your board's URL. This can be changed without impacting access to the board."},{label:r(()=>t[3]||(t[3]=[m(" Vanity URL ")])),setting:r(()=>[s.isEditing?f("",!0):(l(),v(E,{key:0},[d(h,{content:"Copy URL"},{default:r(()=>[d(u,{ref:"copy",text:e.boardUrl,class:"icon-button",onCopied:i.handleUrlCopied,onError:i.handleUrlCopyError},{default:r(()=>[d(c,{fill:"",type:"copy",class:"tw-mr-2"})]),_:1},8,["text","onCopied","onError"])]),_:1}),e.canEditBoard?f("",!0):(l(),g(h,{key:0,content:"Edit URL"},{default:r(()=>[a("button",{class:"icon-button",onClick:t[0]||(t[0]=S=>s.isEditing=!0)},[d(c,{fill:"",type:"edit",class:"tw-text-icon tw-text-gray-80"})])]),_:1}))],64))]),default:r(()=>[d(b,{ref:"editor",class:"vanity-url",disabled:!e.canEditBoard,"full-url":e.boardUrl,"board-id":e.boardPublicId,"custom-url":e.customUrl,"is-editing":s.isEditing,onCancel:t[1]||(t[1]=S=>s.isEditing=!1),onEdit:t[2]||(t[2]=S=>s.isEditing=!0),onSubmit:i.handleCustomUrlSubmit},null,8,["disabled","full-url","board-id","custom-url","is-editing","onSubmit"])]),_:1})):f("",!0)}const Ls=w(Os,[["render",Ps],["__scopeId","data-v-164201fc"]]),Vs={components:{BackgroundSetting:ds,BodyFontSetting:vs,BodyFontSizeSetting:ys,Container:q,FontSetting:ks,HeaderColorSetting:pi,IncludeContributorNameSetting:mi,IntroAnimationSetting:ci,NavbarLogoSetting:ui,NewPostPlacementSetting:di,OverlayAnimationSetting:li,SettingsContainer:Z,TimestampsSetting:ai,TitleFontSetting:Is,TitleFontSizeSetting:Rs,VanityUrl:Ls}};function zs(e,t,n,p,s,i){const c=o("background-setting"),u=o("header-color-setting"),h=o("navbar-logo-setting"),b=o("title-font-setting"),y=o("title-font-size-setting"),S=o("body-font-setting"),I=o("body-font-size-setting"),k=o("font-setting"),_=o("intro-animation-setting"),$=o("overlay-animation-setting"),R=o("new-post-placement-setting"),L=o("include-contributor-name-setting"),M=o("timestamps-setting"),V=o("vanity-url"),Q=o("settings-container"),ee=o("container");return l(),g(ee,null,{header:r(()=>t[0]||(t[0]=[m(" Appearance ")])),default:r(()=>[d(Q,null,{default:r(()=>[d(c),d(u),d(h),d(b),d(y),d(S),d(I),d(k),d(_),d($),d(R),d(L),d(M),d(V)]),_:1})]),_:1})}const Fs=w(Vs,[["render",zs],["__scopeId","data-v-95e7cc24"]]),qs={components:{Container:q,Icon:U},mixins:[hi]},Ys={class:"tw-flex tw-flex-col tw-gap-y-2"},Hs=["onClick"],js=["src","alt"];function Ws(e,t,n,p,s,i){const c=o("icon"),u=o("container");return l(),g(u,{"back-callback":()=>e.$router.replace({name:"appearance"})},{header:r(()=>t[0]||(t[0]=[m(" Fonts ")])),default:r(()=>[a("div",Ys,[(l(!0),v(E,null,O(e.localTypefaces,h=>(l(),v("button",{key:h.id,class:W(["font",{selected:h.name===e.selectedTypefaceName}]),onClick:b=>e.choose(h.name)},[a("img",{src:`/images/fonts/${h.name}.svg`,alt:h.display_name,class:"tw-h-[32px]"},null,8,js),h.name===e.selectedTypefaceName?(l(),g(c,{key:0,fill:"",type:"check",class:"tw-text-icon tw-text-black tw-mr-2"})):f("",!0)],10,Hs))),128))])]),_:1},8,["back-callback"])}const gt=w(qs,[["render",Ws],["__scopeId","data-v-0be242f9"]]),Ks={},Qs={class:"tw-flex tw-flex-col tw-justify-center tw-items-center tw-text-center tw-px-4"},Js={class:"tw-mb-4"},Xs={class:"tw-text-base tw-font-semibold tw-uppercase tw-mb-1.5"},Zs={class:"tw-text-6xl tw-font-semibold tw-mb-5"},er={class:"tw-text-xl tw-font-normal tw-text-gray-80 tw-text-center tw-mb-6"};function tr(e,t){return l(),v("div",Qs,[a("div",Js,[D(e.$slots,"image")]),a("div",Xs,[D(e.$slots,"eyebrow-heading")]),a("div",Zs,[D(e.$slots,"header")]),a("div",er,[D(e.$slots,"description")]),a("div",null,[D(e.$slots,"cta")])])}const ir=w(Ks,[["render",tr]]),nr={components:{FeatureLander:ir},computed:{upgradeUrl(){const e=this.getUpgradeType();return`${this.board.url}/upgrade?to=${e}`},...B(["canUpgradeBoard","canApplyPackageCredit","isLiteBoard","isDemoSinglePostBoard"]),...T(["board"])},methods:{getUpgradeType(){return this.isDemoSinglePostBoard?"solo":this.isLiteBoard?"lite-milestone-upgrade":"premium-milestone-upgrade"},trackDemoUpgradeClicked(){F.boardUpgradeClicked(Je,"custom-background-settings")},applyCredit(){this.canApplyPackageCredit&&(this.trackDemoUpgradeClicked(),P.emitter.emit("show-apply-package-credit-modal"))}}},sr={class:"tw-flex tw-flex-col tw-space-y-6"},rr=["href"];function or(e,t,n,p,s,i){const c=o("feature-lander");return l(),g(c,null,{image:r(()=>t[2]||(t[2]=[a("img",{width:"380",src:"/images/customize-background.png",alt:"customize background"},null,-1)])),"eyebrow-heading":r(()=>t[3]||(t[3]=[m(" Custom branding ")])),header:r(()=>t[4]||(t[4]=[m(" Customize backgrounds ")])),description:r(()=>[a("div",sr,[t[5]||(t[5]=a("div",null," Customize the background designs to create a more personalized experience. ",-1)),a("div",null," Custom backgrounds are available on "+C(e.isDemoSinglePostBoard?"upgraded Solo":"Milestone")+" boards and all business, pro, & enterprise plans. ",1)])]),cta:r(()=>[e.canUpgradeBoard?(l(),v("a",{key:0,class:"btn-p-lg btn-p-primary",href:i.upgradeUrl,onClick:t[0]||(t[0]=(...u)=>i.trackDemoUpgradeClicked&&i.trackDemoUpgradeClicked(...u))}," Upgrade Now ",8,rr)):e.canApplyPackageCredit?(l(),v("button",{key:1,class:"btn-p-lg btn-p-primary",onClick:t[1]||(t[1]=Ie((...u)=>i.applyCredit&&i.applyCredit(...u),["prevent"]))}," Upgrade Now ")):f("",!0)]),_:1})}const ar=w(nr,[["render",or]]),lr={components:{TemplateButton:Et},props:{templates:{type:Array,required:!0},canEdit:{type:Boolean,default:!1},isUserTemplates:{type:Boolean,default:!1}},emits:["click","edit"],computed:{...B(["isHeaderColorHidden"]),...re(ut,["isLoadingBackgroundAnimationPreview","previewAnimation"]),...re(J,{currentTemplate:e=>e.currentTemplate,stateTemplates:e=>e.templates})},methods:{...he(ut,["loadBackgroundAnimation","setIsShowingBackgroundAnimationPreview","setPreviewAnimation"]),isSelected(e){return this.currentTemplate&&this.currentTemplate.id===e},isNew(e){var t;return((t=this.stateTemplates[e])==null?void 0:t.is_new)??!1},async handlePlayAnimation(e){this.loadBackgroundAnimation(e)},handleClose(){this.setIsShowingBackgroundAnimationPreview(!1),this.setPreviewAnimation(null)}}},dr={class:"templates-container"};function ur(e,t,n,p,s,i){const c=o("template-button");return l(),v("div",dr,[(l(!0),v(E,null,O(n.templates,u=>(l(),g(c,{key:u,name:e.stateTemplates[u].name,"class-name":e.stateTemplates[u].css_class,"is-selected":i.isSelected(u),"can-edit":n.canEdit,"is-user-template":n.isUserTemplates,"is-new":i.isNew(u),"animation-id":e.stateTemplates[u].animation_id,"preview-animation":e.previewAnimation?e.previewAnimation.id:null,"is-loading-background-animation-preview":e.isLoadingBackgroundAnimationPreview,"is-header-color-hidden":e.isHeaderColorHidden,class:"template-button",onPlayAnimation:i.handlePlayAnimation,onClick:h=>e.$emit("click",u),onEdit:h=>e.$emit("edit",u)},null,8,["name","class-name","is-selected","can-edit","is-user-template","is-new","animation-id","preview-animation","is-loading-background-animation-preview","is-header-color-hidden","onPlayAnimation","onClick","onEdit"]))),128))])}const Bt=w(lr,[["render",ur],["__scopeId","data-v-f5689870"]]),cr={components:{Icon:U,FeatureLocked:ar,Templates:Bt},emits:["click"],computed:{showUpgradePrompt(){return this.isConsumer&&!this.isMilestoneBoard&&!this.isMemorialBoard&&!this.isUpgradedSinglePostBoard},...B(["canEditBoard","canApplyPackageCredit","isMemorialBoard","isMilestoneBoard","isUpgradedSinglePostBoard"]),...re(J,["customTemplates","customUserTemplates"]),...T(["isConsumer"])},methods:{...he(J,["setDefaultCustomTemplate","setSelectedCustomTemplate"]),handleAddCustomBackground(){this.setDefaultCustomTemplate(),this.$router.replace({name:"custom-background"})},handleEditTemplate(e){this.setSelectedCustomTemplate(e),this.$router.replace({name:"custom-background"})}}},mr={key:1},pr={class:"tw-flex tw-flex-col md:tw-flex-row tw-space-y-2 md:space-y-0 tw-justify-between tw-items-start tw-mb-6"},hr={class:"tw-mb-4"},vr={key:0,class:"tw-h-[160px] tw-flex tw-items-center tw-justify-center tw-text-base tw-text-gray-80 tw-font-normal"},gr={key:0};function fr(e,t,n,p,s,i){const c=o("feature-locked"),u=o("icon"),h=o("templates");return l(),v("div",null,[i.showUpgradePrompt?(l(),g(c,{key:0})):(l(),v("div",mr,[a("div",pr,[t[4]||(t[4]=a("div",{class:"tw-font-semibold tw-text-3xl"}," Custom backgrounds ",-1)),a("button",{class:"btn-p btn-p-primary",onClick:t[0]||(t[0]=(...b)=>i.handleAddCustomBackground&&i.handleAddCustomBackground(...b))},[d(u,{type:"plus",fill:""}),t[3]||(t[3]=a("span",null,"Create new",-1))])]),a("div",hr,[t[5]||(t[5]=a("div",{class:"tw-text-base tw-text-gray-100 tw-font-semibold tw-mt-0 tw-mb-1.5"}," Your Backgrounds ",-1)),d(h,{templates:e.customUserTemplates,"is-user-templates":!0,"can-edit":e.canEditBoard,onClick:t[1]||(t[1]=b=>e.$emit("click",b)),onEdit:i.handleEditTemplate},null,8,["templates","can-edit","onEdit"]),e.customUserTemplates.length?f("",!0):(l(),v("div",vr," You don't have any custom templates "))]),e.customTemplates.length?(l(),v("div",gr,[t[6]||(t[6]=a("div",{class:"tw-text-base tw-text-gray-100 tw-font-semibold tw-mt-0 tw-mb-1.5"}," Your Organization Backgrounds ",-1)),d(h,{templates:e.customTemplates,onClick:t[2]||(t[2]=b=>e.$emit("click",b))},null,8,["templates"])])):f("",!0)]))])}const br=w(cr,[["render",fr]]),yr={components:{Icon:U,LoadingArea:Me,Templates:Bt},mixins:[Qe],props:{group:{type:Object,default:()=>({})},loadingCategoryId:{type:String|Number,default:null}},emits:["click","load-category"],computed:{showGroup(){return!!this.group.categories.length||!!this.group.templates.length},isSummarizable(){return this.group.is_dynamic?!1:this.group.is_summarizable},groupTemplates(){return this.group.is_dynamic?this.group.templates??this.group.categories[0].templates??[]:this.group.templates}},methods:{...he(J,["isCategoryCollapsed"]),handleShowMore(e){e.hasBeenLoaded?this.updateIsCollapsed(e.id,!1):this.$emit("load-category",e)},updateIsCollapsed(e,t){this.isCategoryCollapsed({groupName:this.group.name,categoryId:e,isCollapsed:t})},hasMoreTemplates(e){return e.hasBeenLoaded?e.isCollapsed:this.isMobileSize?e.templateCount>4&&e.templates.length===4:e.templateCount>3&&e.templates.length===4},getCategoryTemplates(e){return this.hasMoreTemplates(e)?this.isMobileSize?e.templates.slice(0,4):e.templates.slice(0,3):e.templates}}},_r={key:0},wr={key:0},kr={key:1,class:"tw-flex tw-flex-col tw-gap-y-4"},Cr=["id"],Sr={class:"tw-text-base tw-text-gray-100 tw-font-semibold tw-mt-0 tw-mb-1.5"},Ir=["onClick"],Tr=["onClick"];function Er(e,t,n,p,s,i){const c=o("templates"),u=o("icon"),h=o("loading-area");return i.showGroup?(l(),v("div",_r,[i.isSummarizable?f("",!0):(l(),v("div",wr,[d(c,{templates:i.groupTemplates,onClick:t[0]||(t[0]=b=>e.$emit("click",b))},null,8,["templates"])])),i.isSummarizable?(l(),v("div",kr,[(l(!0),v(E,null,O(n.group.categories,b=>(l(),v("div",{id:b.htmlID,key:b.id},[a("div",Sr,C(b.name),1),d(c,{templates:i.getCategoryTemplates(b),onClick:t[1]||(t[1]=y=>e.$emit("click",y))},null,8,["templates"]),d(h,{loading:n.loadingCategoryId===b.id,class:"category-loader"},{"loading-text":r(()=>t[2]||(t[2]=[a("span",{class:"tw-text-sm tw-text-gray-70 tw-font-semibold"}," Loading... ",-1)])),default:r(()=>[i.hasMoreTemplates(b)?(l(),v("button",{key:0,class:"show-button",onClick:y=>i.handleShowMore(b)},[t[3]||(t[3]=a("span",null," Show more ",-1)),d(u,{type:"chevron-right",fill:"",class:"show-more-icon"})],8,Ir)):f("",!0),b.isCollapsed?f("",!0):(l(),v("button",{key:1,class:"show-button",onClick:y=>i.updateIsCollapsed(b.id,!0)},[t[4]||(t[4]=a("span",null," Show less ",-1)),d(u,{type:"chevron-right",fill:"",class:"show-less-icon"})],8,Tr))]),_:2},1032,["loading"])],8,Cr))),128))])):f("",!0)])):f("",!0)}const Dr=w(yr,[["render",Er],["__scopeId","data-v-37c03ccb"]]),Rr={components:{Selector:Ze},props:{categories:{type:Array,required:!0},modelValue:{type:String,default:""}},computed:{options(){const e=[{value:"",text:"Showing: All"}];return this.categories.map(t=>e.push({value:t.htmlID,text:t.name})),e}}},Mr={class:"selector-container"};function $r(e,t,n,p,s,i){const c=o("selector");return l(),v("div",Mr,[d(c,{"model-value":n.modelValue,options:i.options,"onUpdate:modelValue":t[0]||(t[0]=u=>e.$emit("update:modelValue",u))},null,8,["model-value","options"])])}const Br=w(Rr,[["render",$r],["__scopeId","data-v-682b2a36"]]),Ur={components:{Container:q,Tab:Ee,Tabs:De,LoadingArea:Me,CategoryGroup:Dr,CategorySelector:Br,CustomBackgrounds:br,ToggleButton:$i},mixins:[Qe,Ye],props:{incomingTab:{type:String,default:null}},data(){return{loadingCategoryGroup:null,isLoadingCategories:!1,loadingCategoryId:null,isLoadingCustomTemplates:!1,selectedThemeCategory:"",isShowingThemes:!1}},computed:{isLoadingThemeCategory(){return this.loadingCategoryGroup==="Theme"},loadCustomTab(){return!!this.categoryGroups.length},showCustomTab(){return this.canEditBoard||!this.isConsumer},themeCategories(){const e=this.categoryGroups.find(t=>t.name==="Themes");return!e||!e.categories.length?[]:e.categories.map(t=>({htmlID:t.htmlID,name:t.name}))},...B(["boardPublicId","isBoardLocked","isHeaderColorHidden","isMemorialBoard","isMilestoneBoard","isSinglePostBoard","isDemoSinglePostBoard","isUpgradedSinglePostBoard","canEditBoard"]),...re(J,["categoryGroups","customTemplates","customUserTemplates"]),...T({isConsumer:"isConsumer",isCustomTemplatesOnly:"isCustomTemplatesOnly",board:"board"})},watch:{selectedThemeCategory(e){const t=this.isMobileSize?document.querySelector(".child-container"):document.querySelector(".drawer-container__child-container");if(!e){t.scrollTop=0;return}const n=document.querySelector(`#${e}`),p=this.isMobileSize?51:63;t.scrollTop=n.offsetTop-t.offsetTop+p,F.boardBackgroundThemeSelected(e.replace("--","-"))}},methods:{...he(J,["getCategory","getCategoryGroupSummary","getCategoryGroupTemplates","getCustomTemplates","setBoardTemplate"]),handleTemplateClicked(e){this.setBoardTemplate(e,this.boardPublicId)},isCategoryGroupLoaded(e){return e.templates.length||e.categories.length},async handleCustomTabClicked(){this.isShowingThemes=!1,!(this.customUserTemplates.length||this.customTemplates.length)&&(this.isLoadingCustomTemplates=!0,await this.getCustomTemplates(this.boardPublicId),this.isLoadingCustomTemplates=!1)},async handleTabClicked(e){this.isShowingThemes=e.name==="Themes",!this.isCategoryGroupLoaded(e)&&(this.loadingCategoryGroup=e.name,!e.is_dynamic&&e.is_summarizable?await this.getCategoryGroupSummary(e):await this.getCategoryGroupTemplates(e),F.boardBackgroundTabClicked(e.name),this.loadingCategoryGroup=null)},async loadCategory(e,t){this.loadingCategoryId=t.id,await this.getCategory({group:e,id:t.id}),this.loadingCategoryId=null,F.boardBackgroundThemeShowMoreClicked(t.name)},handleRedirectToPricing(){window.location.href=`${window.location.origin}/pricing`}}},Ar={class:"tw-hidden md:tw-flex tw-w-full tw-items-center tw-justify-end"},xr={class:"template-picker"};function Nr(e,t,n,p,s,i){const c=o("toggle-button"),u=o("category-selector"),h=o("category-group"),b=o("loading-area"),y=o("tab"),S=o("custom-backgrounds"),I=o("tabs"),k=o("container");return l(),g(k,{"back-callback":()=>e.$router.replace({name:"appearance"}),class:"template-picker-container"},Se({header:r(()=>[t[2]||(t[2]=a("span",null," Backgrounds ",-1))]),default:r(()=>[a("div",xr,[Y(d(u,{modelValue:s.selectedThemeCategory,"onUpdate:modelValue":t[1]||(t[1]=_=>s.selectedThemeCategory=_),categories:i.themeCategories},null,8,["modelValue","categories"]),[[j,s.isShowingThemes&&!i.isLoadingThemeCategory]]),d(I,{class:W(["tabs",{"filter-spacing":s.isShowingThemes&&!i.isLoadingThemeCategory}])},{default:r(()=>[e.isCustomTemplatesOnly?f("",!0):(l(!0),v(E,{key:0},O(e.categoryGroups,(_,$)=>(l(),g(y,{id:_.name,key:_.name,order:$+1,title:_.name==="Memorial"?"Backgrounds":_.name,class:"tw-relative",onShown:R=>i.handleTabClicked(_)},{default:r(()=>[d(b,{loading:s.loadingCategoryGroup===_.name,class:"template-picker-loader"},{default:r(()=>[a("div",null,[d(h,{group:_,"loading-category-id":s.loadingCategoryId,onClick:i.handleTemplateClicked,onLoadCategory:R=>i.loadCategory(_,R)},null,8,["group","loading-category-id","onClick","onLoadCategory"])])]),_:2},1032,["loading"])]),_:2},1032,["id","order","title","onShown"]))),128)),i.loadCustomTab?(l(),g(y,{key:1,id:"custom",order:e.categoryGroups.length+1,title:"Custom",available:i.showCustomTab,active:n.incomingTab==="custom",onShown:i.handleCustomTabClicked},{default:r(()=>[d(b,{loading:s.isLoadingCustomTemplates},{default:r(()=>[d(S,{onClick:i.handleTemplateClicked},null,8,["onClick"])]),_:1},8,["loading"])]),_:1},8,["order","available","active","onShown"])):f("",!0)]),_:1},8,["class"])])]),_:2},[e.isSinglePostBoard?void 0:{name:"headerExtra",fn:r(()=>[a("div",Ar,[t[3]||(t[3]=a("span",{class:"tw-font-normal tw-text-sm tw-mr-2"}," Header color ",-1)),d(c,{disabled:e.isBoardLocked||!e.canEditBoard,"sr-text":"Toggle displaying an accent color at the top of the board.","tooltip-content":"Display an accent color at the top of the board.","model-value":!e.isHeaderColorHidden,size:"small","onUpdate:modelValue":t[0]||(t[0]=_=>e.$store.dispatch("setIsHeaderColorHidden",!e.isHeaderColorHidden))},null,8,["disabled","model-value"]),t[4]||(t[4]=a("div",{class:"tw-border tw-border-solid tw-border-gray-50 tw-ml-4 tw-mr-3 tw-h-6"},null,-1))])]),key:"0"}]),1032,["back-callback"])}const Gr=w(Ur,[["render",Nr],["__scopeId","data-v-ab1752fc"]]),Or={components:{Icon:U,SettingsContainer:Z,BoardToggleButtonSetting:It},computed:{showSpecialOccasionNotifications(){return this.guest||this.isSinglePostBoard?!1:this.isMemorialBoard||this.isSpecialOccasionBoard&&!this.isConsumer},showShoutOutOrEventNotifications(){return!this.guest&&(this.isP2PBoard||this.isEventBoard)},...T({user:e=>({isSubscribedToDailyActivity:e.isSubscribedToDailyActivity,isSubscribedToWeeklyActivity:e.isSubscribedToWeeklyActivity})}),...T(["board","isConsumer"]),...B(["guest","isCreator","isEventBoard","isP2PBoard","isMemorialBoard","isSinglePostBoard","isSpecialOccasionBoard"])},methods:{handleWatcherChange(e){e?this.$store.dispatch("setBoardWatcher"):this.$store.dispatch("removeBoardWatcher")},handleWeeklyActivitySubscription(e){e?this.$store.dispatch("subscribeToWeeklyActivity"):this.$store.dispatch("unsubscribeToWeeklyActivity")}}};function Pr(e,t,n,p,s,i){const c=o("icon"),u=o("board-toggle-button-setting"),h=o("settings-container");return i.showShoutOutOrEventNotifications||i.showSpecialOccasionNotifications?(l(),g(h,{key:0},{headerIcon:r(()=>[d(c,{type:"notifications",fill:"#C674ED"})]),header:r(()=>t[0]||(t[0]=[m(" Notifications ")])),default:r(()=>[i.showShoutOutOrEventNotifications?(l(),v(E,{key:0},[d(u,{"tooltip-content":"Email notification if the board has new posts from the previous day that you haven't seen yet.","model-value":e.isCreator||e.user.isSubscribedToDailyActivity,disabled:e.guest||e.isCreator,"sr-text":"Toggle daily activity notification","onUpdate:modelValue":i.handleWatcherChange},{default:r(()=>t[1]||(t[1]=[m(" Daily activity ")])),_:1},8,["model-value","disabled","onUpdate:modelValue"]),d(u,{"tooltip-content":"Weekly email digest updates on board activity over the past week.","model-value":e.user.isSubscribedToWeeklyActivity,disabled:e.guest,"sr-text":"Toggle weekly digest updates","onUpdate:modelValue":i.handleWeeklyActivitySubscription},{default:r(()=>t[2]||(t[2]=[m(" Weekly digest ")])),_:1},8,["model-value","disabled","onUpdate:modelValue"])],64)):f("",!0),i.showSpecialOccasionNotifications?(l(),g(u,{key:1,"tooltip-content":"Watch to receive a once daily update when new posts are added to the board that you haven't seen.","model-value":e.user.isSubscribedToDailyActivity||e.isCreator,disabled:e.guest||e.isCreator,"sr-text":"Toggle watching the board","onUpdate:modelValue":i.handleWatcherChange},{default:r(()=>t[3]||(t[3]=[m(" Watch board ")])),_:1},8,["model-value","disabled","onUpdate:modelValue"])):f("",!0)]),_:1})):f("",!0)}const Lr=w(Or,[["render",Pr]]),Vr={components:{DropdownSetting:Te,Icon:U,LinkSetting:gi,OptionMenuItem:le,BoardSelectSetting:vi,Setting:ae,SettingsContainer:Z,BoardToggleButtonSetting:It},data(){return{showGiftContributors:!1,tooltips:{giftCard:"Collect money to send a gift card to your recipient along with the Kudoboard delivery.",giftDelivery:"If you deliver a Kudoboard through our system, the gift will be included. You only need to send the gift separately if you are not delivering the Kudoboard through our system (or you want to resend the gift alone).",giftContributors:"This enables the board creator to see who contributed to the gift. The information is not shown to other contributors or the recipient."},giftCurrencies:ct}},computed:{selectedGiftCollectionOption(){return this.giftCollectionOptions.find(e=>e.value===this.board.gift_collection_type).text},giftCollectionOptions(){return[{text:this.board.cash_gift_amount?"Stop collecting contributions":"No gift card included",value:0},{text:"Only board creator can contribute",value:1},{text:"Anyone can contribute",value:2}]},isShowingSettingsModal(){return this.$store.state.isShowingSettingsModal},isCollectingGifts(){return this.board.gift_collection_type!==Rt},cashGiftAmountFormatted(){return this.amountTemplate.replace("1.00",(this.board.cash_gift_amount/100).toFixed(2))},isDelivered(){return this.board.cash_gift_amount&&!this.board.has_unsent_cash_gifts},giftContributorsToggleLabel(){const e=this.giftCardContributorsCount===1?"contributor":"contributors";return this.showGiftContributors?`Hide gift ${e}`:`Show ${this.giftCardContributorsCount} ${e}`},giftCardContributorsCount(){return Object.values(this.giftCardContributors).length},showGiftSettings(){return this.isP2PBoard||this.isEventBoard?!1:this.canEditBoard&&this.allowCashGifts&&!this.isMemorialBoard&&this.board.recipients.length===1&&!this.hasUserGroupAsRecipient},hasUserGroupAsRecipient(){return this.board.recipients.some(e=>e.user_group_id)},giftCurrency(){return this.board.gift_currency||ct[0].value},...B(["canEditBoard","isEventBoard","isMemorialBoard","isP2PBoard","isSinglePostBoard"]),...T(["board","userType","giftCardContributors","amountTemplate","allowMulticurrencyGiftCards"]),...T({allowCashGifts:e=>e.gifts.allowCashGifts,giftCardContributors:e=>e.gifts.giftCardContributors,displayGiftAmount:e=>e.gifts.displayGiftAmount,canDeliverGiftCard:e=>e.permissions.canDeliverGiftCard})},watch:{isShowingSettingsModal(){this.showGiftContributors=!1}},methods:{...St(["setGiftCollectionType","updateDisplayGiftAmount","setGiftCurrency"]),handleSendGift(){P.emitter.emit("settings:navigate","gift-delivery")}}};function zr(e,t,n,p,s,i){const c=o("icon"),u=o("setting"),h=o("board-select-setting"),b=o("board-toggle-button-setting"),y=o("option-menu-item"),S=o("dropdown-setting"),I=o("link-setting"),k=o("settings-container");return i.showGiftSettings?(l(),g(k,{key:0,"tooltip-content":s.tooltips.giftCard},{headerIcon:r(()=>[d(c,{type:"gift-card",fill:"#61C8B3"})]),header:r(()=>t[2]||(t[2]=[m(" Gift card ")])),default:r(()=>[i.isDelivered?(l(),g(u,{key:0},{label:r(()=>t[3]||(t[3]=[m(" Status ")])),setting:r(()=>t[4]||(t[4]=[m(" Delivered ")])),default:r(()=>[t[5]||(t[5]=a("a",{href:"https://support.kudoboard.com/hc/en-us/articles/5325233435923-Overview-of-Kudoboard-s-gift-card-feature-",class:"btn-p-link",target:"_blank",rel:"noopener noreferrer"}," Learn more ",-1))]),_:1})):f("",!0),i.isDelivered?f("",!0):(l(),g(h,{key:1,disabled:!e.canEditBoard,options:i.giftCollectionOptions,"model-value":e.board.gift_collection_type,"onUpdate:modelValue":e.setGiftCollectionType},{label:r(()=>t[6]||(t[6]=[m(" Status ")])),"button-text":r(()=>[m(C(i.selectedGiftCollectionOption),1)]),_:1},8,["disabled","options","model-value","onUpdate:modelValue"])),d(h,{disabled:!e.canEditBoard||e.board.has_gifts||!e.allowMulticurrencyGiftCards,options:s.giftCurrencies,"model-value":i.giftCurrency,"onUpdate:modelValue":e.setGiftCurrency},{label:r(()=>t[7]||(t[7]=[m(" Currency ")])),"button-text":r(()=>[m(C(i.giftCurrency),1)]),_:1},8,["disabled","options","model-value","onUpdate:modelValue"]),e.board.cash_gift_amount>0||i.isCollectingGifts?(l(),g(u,{key:2},{label:r(()=>t[8]||(t[8]=[m(" Amount contributed ")])),setting:r(()=>[m(C(i.cashGiftAmountFormatted),1)]),_:1})):f("",!0),e.board.cash_gift_amount>0&&!i.isDelivered?(l(),g(b,{key:3,disabled:!e.canEditBoard,"model-value":!!e.displayGiftAmount,"sr-text":"Toggle showing gift amount on board","onUpdate:modelValue":t[0]||(t[0]=_=>e.updateDisplayGiftAmount(_))},{default:r(()=>t[9]||(t[9]=[m(" Show amount on board ")])),_:1},8,["disabled","model-value"])):f("",!0),(e.board.cash_gift_amount>0||i.isCollectingGifts)&&i.giftCardContributorsCount?(l(),g(S,{key:4,"tooltip-content":s.tooltips.giftContributors},{label:r(()=>t[10]||(t[10]=[m(" Gift contributors ")])),"button-text":r(()=>[m(C(i.giftContributorsToggleLabel),1)]),default:r(()=>[(l(!0),v(E,null,O(e.giftCardContributors,(_,$)=>(l(),g(y,{key:$},{default:r(()=>[a("div",null,C(_),1)]),_:2},1024))),128))]),_:1},8,["tooltip-content"])):f("",!0),e.canDeliverGiftCard?(l(),g(I,{key:5,"tooltip-content":s.tooltips.giftDelivery},{label:r(()=>t[11]||(t[11]=[m(" Gift delivery ")])),default:r(()=>[a("button",{onClick:t[1]||(t[1]=(..._)=>i.handleSendGift&&i.handleSendGift(..._))},C(e.board.has_unsent_cash_gifts?"Send separately":"Resend"),1)]),_:1},8,["tooltip-content"])):f("",!0)]),_:1},8,["tooltip-content"])):f("",!0)}const Fr=w(Vr,[["render",zr],["__scopeId","data-v-e6565b5d"]]),qr={components:{Icon:U},mixins:[ye],props:{board:{type:Object,required:!0},trackContext:{type:String,required:!1,default:""}},computed:{upgradeUrl(){return this.route("boards.upgrade",this.board.public_id)}},methods:{trackBoardUpgradeClicked(){F.boardUpgradeClicked(this.board.kind,this.trackContext)}}},Yr=["href"];function Hr(e,t,n,p,s,i){const c=o("icon");return l(),v("a",{class:"btn-p-lg btn-p-primary",href:i.upgradeUrl,onClick:t[0]||(t[0]=(...u)=>i.trackBoardUpgradeClicked&&i.trackBoardUpgradeClicked(...u))},[d(c,{fill:"",type:"lock"}),t[1]||(t[1]=a("span",null," Upgrade Board ",-1))],8,Yr)}const jr=w(qr,[["render",Hr]]),Wr={components:{Icon:U,IconColored:Ai,GiftCollection:Fr,UpgradeBoardButton:jr,AdministrationSettings:wi,Container:q,DataAndAnalyticsSettings:_i,NotificationSettings:Lr,SettingsContainer:Z,Setting:ae,AccessAndPrivacy:yi,EngagementSettings:bi,SharingSettings:fi},mixins:[ye],computed:{shouldShowBoardType(){return this.isConsumer&&this.user.type==="creator"&&(this.isMemorialBoard||!this.user.isUnlimited)},prettyBoardKind(){return this.isMemorialBoard?this.isMiniBoard?"Mini Memorial":"Full Memorial":this.isDemoBoard&&this.isStarter?"Starter":Bi(this.board.effective_kind)},...T(["board","isConsumer"]),...T({canEditGiftSettings:e=>e.permissions.canEditGiftSettings,user:e=>({type:e.userType,permissions:e.permissions,isUnlimited:e.userIsUnlimited}),customFields:e=>e.board.custom_fields,allowCashGifts:e=>e.gifts.allowCashGifts}),...B(["isEffectiveMiniBoard","isEffectivePremiumBoard","isEffectiveMilestoneBoard","isLiteBoard","isDemoBoard","isMultiPostDemoBoard","isMiniBoard","isDemoSinglePostBoard","isUpgradedSinglePostBoard","isMemorialBoard","isCreator","isSinglePostBoard","isStarter","canUpgradeBoard"])},methods:{emitShowApplyPackageCreditModal(){P.emitter.emit("show-apply-package-credit-modal")}}},Kr={class:"board-upgrade-header"},Qr={key:0},Jr={key:1},Xr={class:"board-upgrade-text"},Zr={class:"board-upgrade-header"},eo={class:"board-upgrade-text"},to={class:"tw-flex tw-items-center tw-text-4xl tw-font-semibold tw-text-black tw-mb-5"},io={class:"tw-flex tw-flex-col tw-gap-y-4"},no={class:"upgrade-item"},so={class:"upgrade-item"},ro={class:"upgrade-item"},oo={class:"upgrade-item"},ao={class:"upgrade-item"},lo={class:"upgrade-item"},uo={class:"upgrade-item"},co={class:"upgrade-item"},mo={class:"upgrade-item"},po={class:"upgrade-item"},ho={class:"btn-p-lg btn-p-dark tw-mt-6",href:"/upgrade-to-subscription"};function vo(e,t,n,p,s,i){const c=o("upgrade-board-button"),u=o("icon"),h=o("setting"),b=o("settings-container"),y=o("administration-settings"),S=o("access-and-privacy"),I=o("gift-collection"),k=o("notification-settings"),_=o("engagement-settings"),$=o("data-and-analytics-settings"),R=o("sharing-settings"),L=o("icon-colored"),M=o("container");return l(),g(M,null,{header:r(()=>t[1]||(t[1]=[m(" Settings ")])),default:r(()=>[e.isSinglePostBoard||i.shouldShowBoardType?(l(),g(b,{key:0,class:"tw-mb-6"},{default:r(()=>[d(h,null,{default:r(()=>[e.isSinglePostBoard?(l(),v(E,{key:0},[a("div",Kr,[e.isDemoSinglePostBoard?(l(),v("span",Qr,"Solo Board")):f("",!0),e.isUpgradedSinglePostBoard||e.isMiniBoard?(l(),v("span",Jr,"Upgraded Solo Board")):f("",!0)]),a("div",Xr,[e.isDemoSinglePostBoard?(l(),v(E,{key:0},[m(" This is a Solo Board for 1-to-1 appreciation. Upgrade to add a gift card, custom background, or video post. ")],64)):f("",!0),e.isUpgradedSinglePostBoard||e.isMiniBoard?(l(),v(E,{key:1},[m(" This is an upgraded Solo Board for 1-to-1 or 1-to-many appreciation. It includes the option to add a gift card, custom background, & video post. ")],64)):f("",!0)]),e.isDemoSinglePostBoard&&e.canUpgradeBoard?(l(),g(c,{key:0,board:e.board,"track-context":"board-settings-modal",class:"tw-mt-2"},null,8,["board"])):f("",!0)],64)):i.shouldShowBoardType?(l(),v(E,{key:1},[a("div",Zr,C(i.prettyBoardKind)+" Board ",1),a("div",eo,[e.isMultiPostDemoBoard&&!e.isStarter?(l(),v(E,{key:0},[m(" This board is limited to 5 posts and cannot be delivered. Upgrade for additional features. ")],64)):f("",!0),e.isMultiPostDemoBoard&&e.isStarter?(l(),v(E,{key:1},[m(" This board is limited to 5 posts and has limited functionality. Upgrade for additional features. ")],64)):e.isEffectiveMiniBoard?(l(),v(E,{key:2},[m(" This board is limited to 10 posts. Upgrade for additional features. ")],64)):e.isLiteBoard?(l(),v(E,{key:3},[m(" This board is limited to 20 posts. Upgrade for additional features. ")],64)):e.isEffectivePremiumBoard?(l(),v(E,{key:4},[m(" This board is limited to 100 posts. Upgrade for additional features. ")],64)):e.isEffectiveMilestoneBoard?(l(),v(E,{key:5},[m(" This board accepts unlimited posts and allows you to play it as a slideshow. ")],64)):f("",!0)]),e.user.permissions.canUpgradeBoard?(l(),g(c,{key:0,board:e.board,"track-context":"board-settings-modal",class:"tw-mt-2"},null,8,["board"])):f("",!0),e.isConsumer&&e.user.permissions.canApplyPackageCredit?(l(),v("button",{key:1,class:"btn-p-lg btn-p-dark tw-mt-2",onClick:t[0]||(t[0]=Ie((...V)=>i.emitShowApplyPackageCreditModal&&i.emitShowApplyPackageCreditModal(...V),["prevent"]))},[d(u,{fill:"",type:"lock"}),t[2]||(t[2]=a("span",null," Upgrade Board ",-1))])):f("",!0)],64)):f("",!0)]),_:1})]),_:1})):f("",!0),d(y),d(S),d(I),d(k),d(_),d($),d(R),e.isConsumer&&e.isCreator&&!e.isMemorialBoard?(l(),g(b,{key:1,class:"business-upsell tw-mt-6"},{default:r(()=>[d(h,null,{default:r(()=>[a("div",to,[d(L,{type:"business",class:"tw-mr-3"}),t[3]||(t[3]=a("span",null," Upgrade to a plan ",-1))]),t[15]||(t[15]=a("div",{class:"tw-text-black tw-text-sm tw-mb-5"}," Everything needed to celebrate employee special occasions, company events, and peer-to-peer shout outs. ",-1)),a("div",io,[a("div",no,[d(u,{fill:"",type:"radio-checked"}),t[4]||(t[4]=a("span",null," Unlimited boards & posts ",-1))]),a("div",so,[d(u,{fill:"",type:"radio-checked"}),t[5]||(t[5]=a("span",null," Multiple board creators ",-1))]),a("div",ro,[d(u,{fill:"",type:"radio-checked"}),t[6]||(t[6]=a("span",null," Custom branding & content library ",-1))]),a("div",oo,[d(u,{fill:"",type:"radio-checked"}),t[7]||(t[7]=a("span",null," Milestone automations ",-1))]),a("div",ao,[d(u,{fill:"",type:"radio-checked"}),t[8]||(t[8]=a("span",null," Tagging, likes, & comments ",-1))]),a("div",lo,[d(u,{fill:"",type:"radio-checked"}),t[9]||(t[9]=a("span",null," Company values ",-1))]),a("div",uo,[d(u,{fill:"",type:"radio-checked"}),t[10]||(t[10]=a("span",null," Analytics & reporting ",-1))]),a("div",co,[d(u,{fill:"",type:"radio-checked"}),t[11]||(t[11]=a("span",null," Slack & MS Teams integrations ",-1))]),a("div",mo,[d(u,{fill:"",type:"radio-checked"}),t[12]||(t[12]=a("span",null," SSO & HRIS integrations ",-1))]),a("div",po,[d(u,{fill:"",type:"radio-checked"}),t[13]||(t[13]=a("span",null," and more! ",-1))])]),a("a",ho,[d(u,{fill:"",type:"lock"}),t[14]||(t[14]=a("span",null," Upgrade to a plan ",-1))])]),_:1})]),_:1})):f("",!0)]),_:1})}const go=w(Wr,[["render",vo],["__scopeId","data-v-5b2d36b6"]]),fo={components:{DialogModal:fe,LoadingButton:H,TeleportWrapper:ge},props:{buttonClasses:{type:String,default:"btn-p btn-p-primary"},disabled:{type:Boolean,default:!1},isLoading:{type:Boolean,default:!1},portal:{type:String,default:null},validationCallback:{type:Function,default:()=>!0}},data(){return{isShowingConfirmation:!1}},methods:{hideConfirmation(){this.isShowingConfirmation=!1},async handleClick(){await this.validationCallback()&&(this.isShowingConfirmation=!0)}}};function bo(e,t,n,p,s,i){const c=o("loading-button"),u=o("dialog-modal"),h=o("teleport-wrapper");return l(),v("div",null,[d(c,{disabled:n.disabled,"is-loading":n.isLoading,class:W(n.buttonClasses),onClick:i.handleClick},{default:r(()=>[D(e.$slots,"default")]),_:3},8,["disabled","is-loading","class","onClick"]),d(h,{to:n.portal,disabled:!n.portal},{default:r(()=>[s.isShowingConfirmation?(l(),g(u,{key:0,onOk:t[0]||(t[0]=b=>e.$emit("ok")),onClose:t[1]||(t[1]=b=>{i.hideConfirmation(),e.$emit("close")})},{header:r(()=>[D(e.$slots,"modalHeader")]),"ok-button":r(()=>[D(e.$slots,"ok-button")]),"cancel-button":r(()=>[D(e.$slots,"cancel-button")]),default:r(()=>[D(e.$slots,"modalText")]),_:3})):f("",!0)]),_:3},8,["to","disabled"])])}const te=w(fo,[["render",bo]]),yo={components:{Icon:U},props:{url:{type:String,required:!0}}},_o={class:"tw-flex tw-justify-start tw-items-center"},wo=["href"];function ko(e,t,n,p,s,i){const c=o("icon");return l(),v("div",_o,[a("a",{class:"email-preview-link",href:n.url,target:"_blank",rel:"noopener noreferrer"},[d(c,{fill:"",type:"eye-open",class:"tw-mr-1 tw-text-icon"}),t[0]||(t[0]=a("span",null," Preview ",-1))],8,wo)])}const rt=w(yo,[["render",ko],["__scopeId","data-v-6bf6d2c7"]]),we=35,Co={components:{ListItem:nt,ConfirmationButton:te,Icon:U,Tooltip:je},props:{contributor:{type:Object,required:!0},selected:{type:Boolean,required:!0}},computed:{hasContributed(){return this.contributor.status&&this.contributor.status.toLowerCase()==="contributed"},truncatedName(){const e=this.contributor.name||this.contributor.slack_real_name||this.contributor.teams_real_name||"";return e.length<we?e:`${e.substr(0,we)}...`},truncatedEmail(){const e=this.contributor.email||this.contributor.slack_user_name||this.contributor.teams_user_name||"";return e.length<we?e:`${e.substr(0,we)}...`}},methods:{handleClick(){this.hasContributed||this.$emit(this.selected?"deselected":"selected")},handleDelete(){this.$store.dispatch("deleteContributor",this.contributor)}}},So={class:"tw-mr-1 tw-whitespace-nowrap tw-overflow-hidden tw-text-ellipsis"},Io={key:1};function To(e,t,n,p,s,i){const c=o("icon"),u=o("tooltip"),h=o("confirmation-button"),b=o("list-item");return l(),g(b,{class:W(["contributor clickable",{"hover:tw-bg-brand-20":n.selected,"tw-cursor-default":i.hasContributed}]),onClick:i.handleClick},{default:r(()=>[Y(d(c,{fill:"",type:"check",class:"tw-mr-1 tw-mb-px"},null,512),[[j,n.selected]]),a("span",So,[n.contributor.name||n.contributor.slack_real_name||n.contributor.teams_real_name?(l(),g(u,{key:0,content:n.contributor.email||n.contributor.slack_user_name||n.contributor.teams_user_name},{default:r(()=>[m(C(i.truncatedName),1)]),_:1},8,["content"])):f("",!0),!n.contributor.name&&!n.contributor.slack_real_name&&!n.contributor.teams_real_name?(l(),v("span",Io,C(i.truncatedEmail),1)):f("",!0)]),i.hasContributed?f("",!0):(l(),g(h,{key:0,"button-classes":"tw-bg-transparent tw-border-none tw-flex tw-items-center tw-p-0",portal:"#modals",onOk:i.handleDelete},{modalHeader:r(()=>t[0]||(t[0]=[m(" Remove Invitee ")])),modalText:r(()=>t[1]||(t[1]=[m(" This will remove the invitee from further notifications. Any emails already sent cannot be retracted. ")])),default:r(()=>[d(c,{fill:"",type:"close"})]),_:1},8,["onOk"]))]),_:1},8,["class","onClick"])}const Eo=w(Co,[["render",To]]),Do={props:{status:{type:String,default:null}}},Ro={class:"status"};function Mo(e,t,n,p,s,i){return l(),v("div",Ro,[a("i",{class:W(["fa fa-circle",n.status&&n.status.toLowerCase()])},null,2),m(" "+C(!n.status||n.status==="Delivered"?"Invited":n.status),1)])}const $o=w(Do,[["render",Mo],["__scopeId","data-v-399d514e"]]),Bo={components:{ConfirmationButton:te,Contributor:Eo,ContributorStatus:$o,EmailPreviewLink:rt,ListItems:it,LoadingArea:Me,UsersList:tt},props:{fromTab:{type:String,default:"link"},selectNonContributors:{type:Boolean,default:!1}},data(){return{isLoading:!1,isSending:!1,selected:{}}},computed:{previewUrl(){return`/boards/${this.boardId}/contributors/ad-hoc-reminders/preview`},slackers(){return this.contributors.filter(e=>(e.status&&e.status.toLowerCase())!=="contributed")},sortedContributors(){return this.contributors.slice().sort((e,t)=>!e.name&&t.name?1:e.name&&!t.name||e.email<t.email?-1:e.email>t.email?1:0)},emailContributors(){return this.contributors.filter(e=>!!e.email)},slackContributors(){return this.contributors.filter(e=>!!e.slack_user_id)},teamsContributors(){return this.contributors.filter(e=>!!e.teams_user_id)},confirmationText(){const e=this.slackContributors.length+this.teamsContributors.length>0?"Send reminder":"Send reminder email";return Object.keys(this.selected).length>1?`${e}s`:e},showEmailPreviewLink(){return!this.slackContributors.length&&!this.teamsContributors.length||this.emailContributors.some(e=>this.selected[e.id])},...T({boardId:e=>e.board.public_id,contributorCount:e=>e.invites.contributorCount,contributors:e=>e.invites.contributors||[]})},mounted(){this.loadContributors(),this.loadContributorCount()},unmounted(){this.$store.commit("unloadContributors")},methods:{backCallback(){this.$router.replace({name:"invite-contributors",params:{incomingTab:this.fromTab}})},async handleSendReminders(){this.isSending=!0;try{const e=await this.$store.dispatch("sendAdHocReminders",Object.keys(this.selected)),{count:t}=e.data.data;x(`${t} reminder${t===1?"":"s"} sent!`),this.selected={}}catch(e){console.error(e),ne(e)}finally{this.isSending=!1,this.$refs.confirmationButton.hideConfirmation()}},async loadContributors(){this.isLoading=!0;try{await this.$store.dispatch("loadContributors"),this.selectNonContributors&&this.$nextTick(()=>{this.toggleSelectAll()})}catch(e){console.error(e),ne(e)}finally{this.isLoading=!1}},async loadContributorCount(){this.isLoading=!0;try{await this.$store.dispatch("loadContributorCount")}catch(e){console.error(e),ne(e)}finally{this.isLoading=!1}},toggleSelectAll(){if(Object.keys(this.selected).length===this.slackers.length){this.selected={};return}this.selected=Object.fromEntries(this.slackers.map(e=>[e.id,!0]))}}};function Uo(e,t,n,p,s,i){const c=o("contributor"),u=o("contributor-status"),h=o("list-items"),b=o("loading-area"),y=o("confirmation-button"),S=o("email-preview-link"),I=o("users-list");return l(),g(I,{"back-callback":i.backCallback},{"drawer-header":r(()=>t[1]||(t[1]=[m(" Invite contributors ")])),header:r(()=>[m(" Invited contributors ("+C(e.contributorCount)+") ",1)]),footer:r(()=>[d(y,{ref:"confirmationButton","button-classes":"btn-p-lg btn-p-primary tw-mr-2","is-loading":s.isSending,disabled:!Object.keys(s.selected).length||s.isLoading,portal:"#modals",onOk:i.handleSendReminders},{modalHeader:r(()=>[m(C(i.confirmationText),1)]),modalText:r(()=>t[2]||(t[2]=[m(" Are you sure you want to send these reminders? ")])),default:r(()=>[m(C(i.confirmationText)+" ",1)]),_:1},8,["is-loading","disabled","onOk"]),i.showEmailPreviewLink?(l(),g(S,{key:0,url:i.previewUrl},null,8,["url"])):f("",!0)]),default:r(()=>[d(b,{loading:s.isLoading},{default:r(()=>[Y(a("button",{class:"btn-p-link tw-mb-1.5",onClick:t[0]||(t[0]=(...k)=>i.toggleSelectAll&&i.toggleSelectAll(...k))}," Select all ",512),[[j,i.slackers.length]]),d(h,null,{default:r(()=>[(l(!0),v(E,null,O(i.sortedContributors,k=>(l(),v("div",{key:k.id,class:"tw-flex tw-justify-between tw-items-center"},[d(c,{contributor:k,selected:!!s.selected[k.id],onSelected:()=>s.selected[k.id]=!0,onDeselected:()=>delete s.selected[k.id]},null,8,["contributor","selected","onSelected","onDeselected"]),d(u,{status:k.status},null,8,["status"])]))),128))]),_:1})]),_:1},8,["loading"])]),_:1},8,["back-callback"])}const Ao=w(Bo,[["render",Uo]]),se="YYYY-MM-DD h:mm A",xo={},No={class:"notification-container"};function Go(e,t){return l(),v("div",No,[D(e.$slots,"default")])}const Ut=w(xo,[["render",Go],["__scopeId","data-v-8521c3ef"]]),Oo={components:{Icon:U,StatusPill:ki},props:{deliveredAt:{type:String,default:null},deliveryDate:{type:String,default:null}}},Po={key:0},Lo={key:1};function Vo(e,t,n,p,s,i){const c=o("icon"),u=o("status-pill");return l(),g(u,{theme:n.deliveredAt||n.deliveryDate?"success":null},{default:r(()=>[n.deliveredAt?(l(),v(E,{key:0},[d(c,{fill:"",type:"radio-checked"}),t[0]||(t[0]=a("span",{class:"tw-pt-px"}," Delivered ",-1))],64)):(l(),v(E,{key:1},[n.deliveryDate?(l(),v("span",Po," Scheduled ")):(l(),v("span",Lo," Not Scheduled "))],64))]),_:1},8,["theme"])}const At=w(Oo,[["render",Vo]]),zo={components:{ConfirmButton:te},methods:{async handleDeliverNow(){await this.$store.dispatch("deliverNow"),this.$store.commit("showDeliverySuccessModal")}}};function Fo(e,t,n,p,s,i){const c=o("confirm-button");return l(),g(c,{portal:"#modals","button-classes":"btn-p-link tw-font-normal tw-text-base",onOk:i.handleDeliverNow},{modalHeader:r(()=>t[0]||(t[0]=[m(" Deliver now ")])),modalText:r(()=>t[1]||(t[1]=[m(" Are you sure you want to deliver your Kudoboard immediately? ")])),default:r(()=>[t[2]||(t[2]=m(" Deliver now "))]),_:1},8,["onOk"])}const qo=w(zo,[["render",Fo]]),Yo={components:{ConfirmButton:te},methods:{async handleResetDelivery(){await this.$store.dispatch("resetDelivery"),await this.$store.dispatch("resetScheduledDelivery"),x("The board delivery has been reset")}}};function Ho(e,t,n,p,s,i){const c=o("confirm-button");return l(),g(c,{portal:"#modals","button-classes":"btn-p-link tw-font-normal tw-text-base",onOk:i.handleResetDelivery},{modalHeader:r(()=>t[0]||(t[0]=[m(" Reset delivery ")])),modalText:r(()=>t[1]||(t[1]=[m(" Did you deliver your board to the wrong email address? Reset delivery here to send it to someone else. ")])),default:r(()=>[t[2]||(t[2]=m(" Reset "))]),_:1},8,["onOk"])}const jo=w(Yo,[["render",Ho]]),Wo={components:{CopyButton:Ke,DeliverNowButton:qo,DeliveryStatus:At,EmailPreviewLink:He,NameLine:Ci,ResetDeliveryButton:jo,RecipientsLabel:Ni,Setting:ae,SettingsContainer:Z},computed:{channelName(){if(!this.pendingMessagingChannel)return null;const e=this.isSlackConnected?"slack_channel_name":"teams_channel_name";return this.pendingMessagingChannel[e]},isDeliveringViaEmail(){return this.board.delivery_method==="email"},showDeliverySettings(){return this.isP2PBoard||this.isEventBoard?!1:!this.isMemorialBoard},prettySendDate(){const e=this.isDelivered?this.board.delivered_at:this.board.delivery_date;return e?pe.tz(e,se,this.board.delivery_timezone).format("MMMM D"):null},prettySendTime(){return this.isDelivered?pe.tz(this.board.delivered_at,se,"America/Chicago").clone().tz(this.board.delivery_timezone).format("h:mma z"):this.board.delivery_date?pe.tz(this.board.delivery_date,se,this.board.delivery_timezone).format("h:mma z"):null},...T({pendingMessagingChannel:e=>e.delivery.pendingMessagingChannel,pendingRecipientNote:e=>e.delivery.pendingRecipientNote}),...T(["board","isConsumer","isSlackConnected"]),...B(["canEditBoard","deliveryStatusDescription","hasManyRecipients","isDelivered","isEventBoard","isMemorialBoard","isP2PBoard","isScheduled","isSinglePostBoard","isDemoSinglePostBoard","isSpecialOccasionBoard","boardQrDownloadTokenUrl","uniqueRecipients"])},methods:{handleCopied(){x("Board link copied")}}},Ko={class:"tw-flex tw-items-center tw-justify-between tw-w-full"},Qo={class:"tw-flex tw-items-center tw-gap-x-2"},Jo={key:0,class:"tw-mt-2 setting__settings-text tw-text-sm"},Xo={key:0},Zo=["href"],ea={class:"tw-flex tw-flex-col tw-items-end"},ta={class:"tw-flex tw-flex-col tw-items-end"};function ia(e,t,n,p,s,i){const c=o("deliver-now-button"),u=o("reset-delivery-button"),h=o("delivery-status"),b=o("copy-button"),y=o("setting"),S=o("recipients-label"),I=o("name-line"),k=o("email-preview-link"),_=o("settings-container");return i.showDeliverySettings?(l(),g(_,{key:0,"tooltip-content":"This is used if you plan to send your Kudoboard to an individual/group after all posts are collected."},{header:r(()=>t[0]||(t[0]=[m(" Board Delivery ")])),default:r(()=>[e.isSpecialOccasionBoard||e.isP2PBoard||e.isEventBoard||e.isSinglePostBoard?(l(),g(y,{key:0},{default:r(()=>[a("div",Ko,[t[1]||(t[1]=a("span",{class:"setting__label"}," Status ",-1)),a("div",Qo,[e.canEditBoard?(l(),v(E,{key:0},[e.isDelivered?f("",!0):(l(),g(c,{key:0})),e.isDelivered&&!e.isDemoSinglePostBoard?(l(),g(u,{key:1})):f("",!0)],64)):f("",!0),d(h,{"delivered-at":e.board.delivered_at,"delivery-date":e.board.delivery_date},null,8,["delivered-at","delivery-date"])])]),e.deliveryStatusDescription||e.isDelivered?(l(),v("div",Jo,[m(C(e.deliveryStatusDescription)+" ",1),e.isDelivered?(l(),v("span",Xo,[t[3]||(t[3]=m(" Use the ")),d(b,{text:`${e.board.url}#view`,class:"copy-link",onCopied:i.handleCopied},{default:r(()=>t[2]||(t[2]=[m(" board link ")])),_:1},8,["text","onCopied"]),t[4]||(t[4]=m(" or ")),a("a",{href:e.boardQrDownloadTokenUrl,target:"_blank",class:"copy-link tw-p-0 tw-m-0 tw-bg-[transparent] tw-border-0"}," QR code ",8,Zo),t[5]||(t[5]=m(" to reshare at any time. "))])):f("",!0)])):f("",!0)]),_:1})):f("",!0),d(y,{class:"recipients"},{label:r(()=>[m(C(e.uniqueRecipients>1?"Recipients":"Recipient"),1)]),setting:r(()=>[a("div",ea,[e.hasManyRecipients?(l(),g(S,{key:0,recipients:e.uniqueRecipients},null,8,["recipients"])):(l(!0),v(E,{key:1},O(e.uniqueRecipients,($,R)=>(l(),g(I,{key:R,person:$,class:"text-right-md"},null,8,["person"]))),128))])]),_:1}),i.channelName?(l(),g(y,{key:1},{label:r(()=>t[6]||(t[6]=[m(" Channel ")])),setting:r(()=>[m(C(i.channelName),1)]),_:1})):f("",!0),e.canEditBoard&&i.isDeliveringViaEmail&&!e.isDelivered?(l(),g(y,{key:2},{label:r(()=>t[7]||(t[7]=[m(" Delivery email ")])),setting:r(()=>[d(k,{"board-id":e.board.public_id,note:e.pendingRecipientNote},null,8,["board-id","note"])]),_:1})):f("",!0),i.prettySendDate?(l(),g(y,{key:3,class:"delivery-date"},{label:r(()=>[m(C(e.isDelivered?"Delivered at":"Contribution deadline"),1)]),setting:r(()=>[a("div",ta,[a("div",null,C(i.prettySendDate),1),a("div",null,C(i.prettySendTime),1)])]),_:1})):f("",!0)]),_:1})):f("",!0)}const na=w(Wo,[["render",ia],["__scopeId","data-v-12fa11aa"]]),sa={components:{DialogModal:fe},mixins:[ye],props:{boardId:{type:String,required:!0}},methods:{onUpgradeClicked(){F.boardUpgradeClicked(Je,"max-deliveries-modal"),window.location.href=this.route("boards.upgrade",this.boardId)}}};function ra(e,t,n,p,s,i){const c=o("dialog-modal");return l(),g(c,{onOk:i.onUpgradeClicked,onClose:t[0]||(t[0]=u=>e.$emit("close"))},{header:r(()=>t[1]||(t[1]=[m(" Upgrade your board to make more deliveries ")])),"ok-button":r(()=>t[2]||(t[2]=[m(" Upgrade board ")])),"cancel-button":r(()=>t[3]||(t[3]=[m(" Skip for now ")])),default:r(()=>[t[4]||(t[4]=m(" You can only deliver 25 free solo boards per day. Upgrade to a premium package for unlimited solo boards. "))]),_:1},8,["onOk"])}const xt=w(sa,[["render",ra]]),oa={components:{MarketingModal:Oi,TeleportWrapper:ge},props:{canAccessGroups:{type:Boolean,default:!1}},data(){return{isShowingModal:!1}},methods:{showLanderModal(){this.isShowingModal=!0},hideLanderModal(){this.isShowingModal=!1}}};function aa(e,t,n,p,s,i){const c=o("marketing-modal"),u=o("teleport-wrapper");return n.canAccessGroups?f("",!0):(l(),v("button",{key:0,onClick:t[2]||(t[2]=(...h)=>i.showLanderModal&&i.showLanderModal(...h))},[D(e.$slots,"default",{},void 0,!0),d(u,{to:"#modals"},{default:r(()=>[s.isShowingModal?(l(),g(c,{key:0,onClose:i.hideLanderModal},{image:r(()=>t[3]||(t[3]=[a("img",{class:"tw-w-full",src:"/images/groups-empty-state.png",alt:"Groups Use Case"},null,-1)])),header:r(()=>t[4]||(t[4]=[m(" Save time with Groups ")])),footer:r(()=>[a("a",{class:"btn-p btn-p-primary",href:"/admin/plan",onClick:t[0]||(t[0]=(...h)=>i.hideLanderModal&&i.hideLanderModal(...h))}," Upgrade "),a("button",{class:"dismiss-btn",onClick:t[1]||(t[1]=(...h)=>i.hideLanderModal&&i.hideLanderModal(...h))}," Skip for now ")]),default:r(()=>[t[5]||(t[5]=m(" Celebrate with the same people often? Create a group and make invitations and delivery a breeze "))]),_:1},8,["onClose"])):f("",!0)]),_:1})]))}const Nt=w(oa,[["render",aa],["__scopeId","data-v-7e515b3e"]]),la={name:"Recipient",components:{TextInput:be,UsersAutocomplete:Ti,Icon:U,InputError:K},mixins:[Ct],props:{index:{type:Number,required:!0},modelValue:{type:Object,required:!0},showValidation:{type:Boolean,required:!0},useUserDropdown:{type:Boolean,required:!0},requireEmail:{type:Boolean,required:!1,default:!0},allowOutsideRecipients:{type:Boolean,required:!0,default:!0},emailOnly:{type:Boolean,default:!1},canRemove:{type:Boolean,required:!0},nameOnly:{type:Boolean,default:!1}},data(){return{selectedEmail:null,internalRecipient:oe(this.modelValue)}},computed:{showError(){return this.showValidation&&!this.isValid},isExistingUser(){return!!this.internalRecipient.user_id},isValid(){return this.isExistingUser||this.isValidEmail&&(this.emailOnly||this.isValidName)},isValidEmail(){return this.internalRecipient.email?xe(this.internalRecipient.email):!this.requireEmail},isValidName(){return!!this.internalRecipient.first_name},errorMessage(){return this.isValid?"":this.isValidEmail?this.isValidName?"":"The recipient's first name is required.":this.requireEmail?"A valid email is required.":"The email is invalid"}},watch:{internalRecipient:{deep:!0,handler(e){this.selectedEmail&&e.user_id&&e.email.trim()!==this.selectedEmail&&(this.internalRecipient.user_id=null,this.selectedEmail=null),this.setRecipientValidity(),this.cleanRecipientName(),this.$emit("update:modelValue",this.internalRecipient)}},isValid(){this.setRecipientValidity()},showValidation(e){e&&this.maybeCleanEmail()},modelValue:{deep:!0,handler(e){JSON.stringify(e)!==JSON.stringify(this.internalRecipient)&&(this.internalRecipient=oe(e))}}},mounted(){this.setRecipientValidity(),this.cleanRecipientName(),this.$emit("update:modelValue",this.internalRecipient)},methods:{maybeCleanEmail(){this.internalRecipient.email&&(this.internalRecipient.email=this.internalRecipient.email.trim())},setRecipientValidity(){this.internalRecipient.valid=this.isValid},handleAutocomplete(e){this.internalRecipient.user_id=e.id,this.internalRecipient.email=e.email,this.selectedEmail=e.email,this.internalRecipient.first_name=e.first_name,this.internalRecipient.last_name=e.last_name,this.internalRecipient.slack_user_id=null,this.internalRecipient.slack_user_name=null,this.internalRecipient.slack_real_name=null,this.internalRecipient.slack_channel_id=null,this.internalRecipient.slack_channel_name=null,this.internalRecipient.teams_user_id=null,this.internalRecipient.teams_user_name=null,this.internalRecipient.teams_real_name=null,this.internalRecipient.teams_channel_id=null,this.internalRecipient.teams_channel_name=null},handleEmailInputBlur(){const e=this.$refs.autocomplete.$el.querySelector("input").value;this.validateRecipient(e)},validateRecipient(e){return xe(e)?(this.internalRecipient.email=e,e):null},focus(){this.emailOnly?this.$refs.emailContainer.querySelector("input").focus():this.$refs.firstName.$el.focus()},cleanRecipientName(){this.internalRecipient&&(this.internalRecipient.first_name=this.internalRecipient.first_name.replace("&amp;","&").replace("&gt;",">").replace("&lt;","<"),this.internalRecipient.last_name=this.internalRecipient.last_name.replace("&amp;","&").replace("&gt;",">").replace("&lt;","<"))}}},da=["name"],ua={key:0,class:"tw-mb-2 tw-flex tw-gap-x-2"},ca={key:1,ref:"emailContainer",class:""};function ma(e,t,n,p,s,i){const c=o("icon"),u=o("text-input"),h=o("users-autocomplete"),b=o("input-error");return l(),g(b,{error:i.showError?i.errorMessage:"",class:W(["tw-relative",{"recipient-error":i.showError}])},{default:r(()=>[Y(a("button",{class:"tw-absolute -tw-right-[9px] -tw-top-[9px] tw-z-[2] tw-border-none tw-bg-transparent tw-p-0 active:focus:tw-outline-none",onClick:t[0]||(t[0]=y=>e.$emit("remove-recipient",n.modelValue))},[d(c,{type:"close-circle",fill:"",class:"tw-text-brand tw-text-icon"})],512),[[j,n.canRemove]]),Y(a("input",{"onUpdate:modelValue":t[1]||(t[1]=y=>s.internalRecipient.user_id=y),type:"hidden",name:`recipients[${n.index}][id]`},null,8,da),[[Xt,s.internalRecipient.user_id]]),n.emailOnly?f("",!0):(l(),v("div",ua,[d(u,{ref:"firstName",modelValue:s.internalRecipient.first_name,"onUpdate:modelValue":t[2]||(t[2]=y=>s.internalRecipient.first_name=y),placeholder:"First name",name:`recipients[${n.index}][first_name]`,disabled:i.isExistingUser,"converts-emojis":!0,class:"tw-input-md"},null,8,["modelValue","name","disabled"]),d(u,{modelValue:s.internalRecipient.last_name,"onUpdate:modelValue":t[3]||(t[3]=y=>s.internalRecipient.last_name=y),placeholder:"Last name",name:`recipients[${n.index}][last_name]`,disabled:i.isExistingUser,"converts-emojis":!0,class:"tw-input-md"},null,8,["modelValue","name","disabled"])])),n.nameOnly?f("",!0):(l(),v("div",ca,[n.useUserDropdown?(l(),g(h,{key:0,ref:"autocomplete",modelValue:s.internalRecipient.email,"onUpdate:modelValue":t[4]||(t[4]=y=>s.internalRecipient.email=y),placeholder:"Recipient email",onBlur:i.handleEmailInputBlur,onSelected:i.handleAutocomplete},null,8,["modelValue","onBlur","onSelected"])):(l(),g(u,{key:1,modelValue:s.internalRecipient.email,"onUpdate:modelValue":t[5]||(t[5]=y=>s.internalRecipient.email=y),type:"text",placeholder:"Recipient email",name:`recipients[${n.index}][email]`,class:"tw-input-md"},null,8,["modelValue","name"]))],512))]),_:1},8,["error","class"])}const pa=w(la,[["render",ma],["__scopeId","data-v-26c966cd"]]),ha={name:"RecipientsEditor",components:{GroupsLanderModal:Nt,Icon:U,GroupRecipient:xi,Recipient:pa},props:{showValidation:{type:Boolean,required:!0},recipients:{type:Array,required:!0},groupRecipients:{type:Array,default:()=>[]},useUserDropdown:{type:Boolean,required:!0},requireEmail:{type:Boolean,required:!1,default:!0},allowOutsideRecipients:{type:Boolean,required:!0,default:!0},emailOnly:{type:Boolean,default:!1},isMemorialBoard:{type:Boolean,default:!1},addRecipientValidation:{type:Function,default:null},isMiniBoard:{type:Boolean,default:!1},isLimitedUnpackagedBoard:{type:Boolean,default:!1},groups:{type:Array,default:()=>[]}},computed:{addLabel(){return this.isMemorialBoard?"Add another honoree":"Add another recipient"},canAddMore(){return this.isMemorialBoard?this.totalRecipientCount<Di:this.totalRecipientCount<(this.isMiniBoard&&this.isLimitedUnpackagedBoard?Ri:Mi)},hasGroups(){return!this.board.cash_gift_amount&&!!this.groups.length},hasGroupRecipients(){return!!this.groupRecipients.length},hasSelectedGroupRecipients(){return this.groupRecipients.some(e=>e.id)},selectedRecipientGroupIds(){return this.groupRecipients.filter(e=>e.id).map(e=>e.id)},totalRecipientCount(){const e=this.hasGroupRecipients?this.groupRecipients.reduce((t,n)=>isNaN(n.users_count)?t:t+n.users_count,0):0;return this.recipients.length+e},...T(["board","canAccessGroups","isAdmin"]),...B(["isDemoSinglePostBoard"])},methods:{handleAddRecipient(){if(this.isDemoSinglePostBoard&&this.totalRecipientCount>=Ei){this.$emit("redirect-to-upgrade");return}this.addRecipientValidation&&!this.addRecipientValidation(this.recipients)||(this.$emit("update-recipients",[...this.recipients,this.createRecipient()]),this.$nextTick(()=>this.focusLastRecipient()))},handleUpdateRecipient(e,t){this.$emit("update-recipient",{recipient:e,index:t})},handleRemoveRecipient(e){this.$emit("update-recipients",this.recipients.toSpliced(this.recipients.indexOf(e),1))},createRecipient(){return{user_id:null,email:"",first_name:"",last_name:"",valid:!1}},focusLastRecipient(){const e=this.recipients.length-1;this.$refs.recipients.forEach(t=>{t.index===e&&t.focus()})}}},va={class:"tw-flex tw-flex-col tw-space-y-2"},ga={key:1,class:"tw-flex tw-space-x-3 tw-mt-2"},fa={key:2,class:"add-recipients-note"};function ba(e,t,n,p,s,i){const c=o("recipient"),u=o("group-recipient"),h=o("icon"),b=o("groups-lander-modal");return l(),v("div",null,[a("div",va,[(l(!0),v(E,null,O(n.recipients,(y,S)=>(l(),g(c,{ref_for:!0,ref:"recipients",key:S,index:S,"model-value":y,"can-remove":n.recipients.length>1||i.hasSelectedGroupRecipients,"show-validation":n.showValidation,"use-user-dropdown":n.useUserDropdown,"require-email":n.requireEmail,"allow-outside-recipients":n.allowOutsideRecipients,"email-only":n.emailOnly,"name-only":n.isMemorialBoard,"onUpdate:modelValue":I=>i.handleUpdateRecipient(I,S),onRemoveRecipient:i.handleRemoveRecipient},null,8,["index","model-value","can-remove","show-validation","use-user-dropdown","require-email","allow-outside-recipients","email-only","name-only","onUpdate:modelValue","onRemoveRecipient"]))),128))]),e.canAccessGroups&&i.hasGroups&&i.hasGroupRecipients?(l(),v("div",{key:0,class:W(["tw-space-y-2",{"tw-mt-2":!!n.recipients.length}])},[(l(!0),v(E,null,O(n.groupRecipients,(y,S)=>(l(),g(u,{ref_for:!0,ref:"group-recipients",key:y.id,"can-remove":!!n.recipients.length||n.groupRecipients.length>1,groups:n.groups,"show-validation":n.showValidation,"selected-group-id":y.id||null,"selected-group-ids":i.selectedRecipientGroupIds,onRemoveGroupRecipient:I=>e.$emit("remove-group-recipient",S),onChangeGroupRecipient:I=>e.$emit("change-group-recipient",S,I),onEditGroupExclusions:I=>e.$emit("edit-group-exclusions",S)},null,8,["can-remove","groups","show-validation","selected-group-id","selected-group-ids","onRemoveGroupRecipient","onChangeGroupRecipient","onEditGroupExclusions"]))),128))],2)):f("",!0),i.canAddMore?(l(),v("div",ga,[Y(a("button",{class:"add-button",onClick:t[0]||(t[0]=(...y)=>i.handleAddRecipient&&i.handleAddRecipient(...y))},[d(h,{fill:"",type:"plus-circle"}),a("span",null,C(i.addLabel),1)],512),[[j,i.canAddMore]]),e.canAccessGroups&&i.hasGroups&&n.groupRecipients.length<n.groups.length?(l(),v("button",{key:0,class:"add-button",onClick:t[1]||(t[1]=y=>e.$emit("add-group-recipient",{}))},[d(h,{fill:"",type:"plus-circle"}),t[3]||(t[3]=a("span",null," Add a group ",-1))])):f("",!0),!e.canAccessGroups&&e.isAdmin?(l(),g(b,{key:1,"can-access-groups":e.canAccessGroups,class:"add-button"},{default:r(()=>[d(h,{fill:"",type:"plus-circle"}),t[4]||(t[4]=a("span",null,"Add a group",-1))]),_:1},8,["can-access-groups"])):f("",!0)])):f("",!0),D(e.$slots,"error",{},void 0,!0),!i.canAddMore&&!n.isMemorialBoard?(l(),v("span",fa,[t[5]||(t[5]=a("strong",null,"Note:",-1)),t[6]||(t[6]=m(" You can add more than 5 recipients after ")),a("a",{class:"clickable",onClick:t[2]||(t[2]=y=>e.$emit("redirect-to-upgrade"))}," upgrading a board. ")])):f("",!0)])}const Gt=w(ha,[["render",ba],["__scopeId","data-v-496554ef"]]),ya={components:{CheckboxInput:Gi,MaxDeliveriesModal:xt,ConfirmButton:te,CopyableSlot:Mt,EmailPreviewLink:He,InputError:K,Icon:U,LoadingButton:H,RecipientsEditor:Gt,TextareaInput:$e},mixins:[de],data(){return{localCcContributors:!0,localRecipientNote:"",localRecipients:[],localGroupRecipients:[],localExcludedUserIds:{},isDelivering:!1,isSaving:!1,isScheduling:!1,isShowingValidation:!1,requireEmail:!this.isConsumer,error:null,deliveryError:null,message:null,type:null,selectableGroups:[],showMaxDeliveriesModal:!1}},computed:{ccContributors(){return this.board.cc_contributors},recipientEmails(){return this.localRecipients.map(e=>e.email).filter(e=>!!e)},isRecipientsDirty(){return this.isIndividualRecipientsDirty||this.isGroupRecipientsDirty||this.isGroupExclusionsDirty},isIndividualRecipientsDirty(){const e=this.localRecipients.filter(t=>!!(t.user_id||t.email||t.first_name||t.last_name));return e.length!==this.savedEmailIndividualRecipients.length?!0:!e.every((t,n)=>{const p=this.savedEmailIndividualRecipients[n];return this.areEmptyOrEquals(t.user_id,p.user_id)&&this.areEmptyOrEquals(t.first_name,p.first_name)&&this.areEmptyOrEquals(t.last_name,p.last_name)&&this.areEmptyOrEquals(t.email,p.email)})},isGroupRecipientsDirty(){if(!this.selectableGroups.length)return!1;const e=this.localGroupRecipients.filter(t=>!!t.id).map(t=>t.id);return e.length!==this.savedGroupRecipients.length?!0:this.savedGroupRecipients.some(t=>!e.includes(t.id))},isGroupExclusionsDirty(){const e=Object.keys(this.localExcludedUserIds),t=Object.keys(this.savedExcludedGroupMembers);return e.length!==t.length?!0:!e.every((n,p)=>{const s=t[p];return this.areEmptyOrEquals(n,s)})},isSettingsDirty(){return this.savedRecipientNote!==this.localRecipientNote||this.ccContributors!==this.localCcContributors||this.board.delivery_method!=="email"},markDeliveredText(){return"Are you sure you want to mark your board as delivered? "+(this.recipientEmails.length?"This will automatically follow up with the recipient so they can print their board & thank contributors.":"This will stop any future reminder emails from going out.")},hasLocalGroupRecipients(){return!!this.localGroupRecipients.length},boardUrlForRecipient(){return this.recipientUrl??this.board.url},...T(["allowOutsideRecipients","board","isConsumer","recipientUrl"]),...T({pendingExcludedGroupMembers:e=>e.delivery.pendingExcludedGroupMembers,pendingGroupRecipients:e=>e.delivery.pendingGroupRecipients,pendingRecipientNote:e=>e.delivery.pendingRecipientNote}),...B(["canUpdateEmailContent","isScheduled","isMiniBoard","isLimitedUnpackagedBoard","isSinglePostBoard","boardQrDownloadTokenUrl","pendingEmailIndividualRecipients","savedEmailIndividualRecipients","savedGroupRecipients","savedExcludedGroupMembers","savedRecipientNote","recipientUserIds"])},watch:{ccContributors:{deep:!0,immediate:!0,handler(e){this.localCcContributors=e}},pendingExcludedGroupMembers:{immediate:!0,handler(e){this.localExcludedUserIds=oe(e)}},pendingGroupRecipients:{immediate:!0,handler(){this.updateLocalGroupRecipients()}},selectableGroups:{immediate:!0,handler(){this.updateLocalGroupRecipients()}},pendingEmailIndividualRecipients:{immediate:!0,handler(e){this.localRecipients=oe(e)}},pendingRecipientNote:{immediate:!0,handler(e){this.localRecipientNote=e}}},mounted(){this.maybeLoadGroups()},beforeUnmount(){this.storeCurrentData()},methods:{updateLocalGroupRecipients(){const e=this.pendingGroupRecipients.map(t=>t.id);this.localGroupRecipients=this.selectableGroups.filter(t=>e.includes(t.id))},storeCurrentData(){this.isRecipientsDirty&&this.$store.commit("pendingIndividualRecipients",this.localRecipients),this.$store.commit("pendingRecipientNote",this.localRecipientNote),this.$store.commit("pendingGroupRecipients",this.localGroupRecipients),this.$store.commit("pendingExcludedGroupMembers",this.localExcludedUserIds)},validateAddRecipient(e){return e.length===1&&(this.board.cash_gift_amount||this.board.gift_collection_type!==Rt)?(this.error="You can't have more than one recipient on a board with gift collection.",!1):!0},handleRedirectToUpgrade(){window.location.href=`${this.board.url}/upgrade`},async handleSave(){if(this.resetErrors(),!!await this.validateRecipients(this.isScheduled)){this.isSaving=!0;try{await this.saveAll(),x("Your changes were saved.")}catch(e){console.error(e),this.error=z(e)}finally{this.isSaving=!1}}},async handleDeliverNow(){this.$refs.confirmDelivery.hideConfirmation(),this.isDelivering=!0;try{await this.saveAll(),await this.deliverNow(),this.$emit("close"),this.$store.commit("showDeliverySuccessModal")}catch(e){if(console.error(e),e.response.status===418){P.emitter.once("email-was-verified",this.handleDeliverNow),this.showEmailVerification(null,"deliver");return}if("max_demo_solo_deliveries"in e.response.data.errors){this.showMaxDeliveriesModal=!0;return}this.deliveryError=z(e)}finally{this.isDelivering=!1}},async handleScheduleDelivery(){if(this.resetErrors(),!!await this.validateRecipients(!0)){this.isScheduling=!0;try{await this.saveAll(),this.$router.replace({name:"delivery-schedule-email"})}catch(e){console.error(e),this.deliveryError=z(e)}finally{this.isScheduling=!1}}},async handleMarkDelivered(){try{await this.$store.dispatch("markDelivered"),x("Your board has been marked as delivered!")}catch(e){console.error(e),ne(e)}},deliverNow(){return this.$store.dispatch("deliverNow")},saveAll(){return Promise.all([this.saveRecipients(),this.saveSettings()])},saveRecipients(){if(!this.isRecipientsDirty)return null;const e=this.localRecipients.map(p=>({user_id:p.user_id,first_name:p.first_name,last_name:p.last_name,email:p.email})),t=this.localGroupRecipients.map(p=>p.id),n=Object.keys(this.localExcludedUserIds);return this.$store.dispatch("saveRecipients",{recipients:e,groups:t,excludedUserIds:n})},saveSettings(){return this.isSettingsDirty?this.$store.dispatch("saveDeliverySettings",{recipientNote:this.localRecipientNote,ccContributors:this.localCcContributors,deliveryMethod:"email"}):null},async validateRecipients(e){let t=!0,n=!0;return this.hasLocalGroupRecipients&&this.localGroupRecipients.some(p=>!p.id)&&(n=!1),this.requireEmail=e,this.isShowingValidation=!0,await this.$nextTick(),this.localRecipients.length&&(t=this.localRecipients.every(p=>p.valid)),(!t||!n)&&this.scrollToFirstError(),t&&n},scrollToFirstError(){const e=this.$el.querySelector(".recipient-error");e&&(document.querySelector(".drawer-container__child-container").scrollTop=e.offsetTop-70)},resetErrors(){this.error=null,this.deliveryError=null},async handleAddGroupRecipient(e){if(e.id){const t=await this.getGroupWithUsers(e.id);if(!t)return;t.users.filter(n=>this.recipientUserIds.includes(n.id)).forEach(n=>{this.excludedGroupMembers[n.id]=!0})}this.localGroupRecipients.push(e)},handleRemoveGroupRecipient(e){this.localGroupRecipients.splice(e,1)},handleChangeGroupRecipient(e,t){this.localGroupRecipients[e]=t},areEmptyOrEquals(e,t){return!e&&!t||e===t},async maybeLoadGroups(){if(!this.isConsumer)try{const{data:{data:e}}=await X.get(`/api/groups?board_id=${this.board.public_id}`),t=e.filter(n=>!!n.users_count);this.pendingGroupRecipients.length&&t.forEach(n=>{const p=this.pendingGroupRecipients.find(s=>s.id===n.id);p&&(n.users_count=p.users_count)}),this.selectableGroups=t}catch(e){console.error(e),ne(e)}},async handleEditGroupExclusions(e){let t=this.localGroupRecipients[e];t&&(t.users||(t=await this.getGroupWithUsers(t.id)),this.$store.commit("targetRecipientGroup",t),this.storeCurrentData(),this.$router.replace({name:"group-recipient"}))},async getGroupWithUsers(e){try{return(await X.get(`/api/groups/${e}`)).data.data}catch(t){return console.error(t),ne(t),ie(z(t)),null}},handleRecipientUpdated({recipient:e,index:t}){this.localRecipients[t]=e},handleRecipientsUpdated(e){this.localRecipients=e},deliverNowValidationCallback(){return this.resetErrors(),this.validateRecipients(!0)}}},_a={key:0,class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"},wa={class:"tw-mb-2"},ka={key:0},Ca={class:"tw-flex tw-items-center tw-gap-x-3"},Sa={key:3,class:"tw-mt-5 tw-text-gray-80 tw-text-sm tw-italic"},Ia={class:"share-text"},Ta={class:"tw-pt-[3px]"},Ea=["href"],Da={class:"drawer-container__footer"};function Ra(e,t,n,p,s,i){const c=o("input-error"),u=o("recipients-editor"),h=o("textarea-input"),b=o("checkbox-input"),y=o("icon"),S=o("confirm-button"),I=o("loading-button"),k=o("email-preview-link"),_=o("copyable-slot"),$=o("max-deliveries-modal");return l(),v("div",null,[a("div",null,[t[17]||(t[17]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Who is the recipient? ",-1)),d(u,{recipients:s.localRecipients,"group-recipients":s.localGroupRecipients,"show-validation":s.isShowingValidation,"use-user-dropdown":!e.isConsumer,"require-email":s.requireEmail,"allow-outside-recipients":e.allowOutsideRecipients,"add-recipient-validation":i.validateAddRecipient,"is-mini-board":e.isMiniBoard,"is-limited-unpackaged-board":e.isLimitedUnpackagedBoard,groups:s.selectableGroups,class:"tw-mb-6",onRedirectToUpgrade:i.handleRedirectToUpgrade,onAddGroupRecipient:i.handleAddGroupRecipient,onRemoveGroupRecipient:i.handleRemoveGroupRecipient,onChangeGroupRecipient:i.handleChangeGroupRecipient,onEditGroupExclusions:i.handleEditGroupExclusions,onUpdateRecipient:i.handleRecipientUpdated,onUpdateRecipients:i.handleRecipientsUpdated},{error:r(()=>[d(c,{error:s.error,class:"recipients-editor-error"},null,8,["error"])]),_:1},8,["recipients","group-recipients","show-validation","use-user-dropdown","require-email","allow-outside-recipients","add-recipient-validation","is-mini-board","is-limited-unpackaged-board","groups","onRedirectToUpgrade","onAddGroupRecipient","onRemoveGroupRecipient","onChangeGroupRecipient","onEditGroupExclusions","onUpdateRecipient","onUpdateRecipients"]),a("div",null,[e.canUpdateEmailContent?(l(),v("div",_a," Enter a custom message (optional) ")):f("",!0),e.canUpdateEmailContent?(l(),g(h,{key:1,modelValue:s.localRecipientNote,"onUpdate:modelValue":t[0]||(t[0]=R=>s.localRecipientNote=R),rows:"5",class:"tw-mb-3 tw-input-md",placeholder:"Optional message"},null,8,["modelValue"])):f("",!0),e.isSinglePostBoard?f("",!0):(l(),g(b,{key:2,modelValue:s.localCcContributors,"onUpdate:modelValue":t[1]||(t[1]=R=>s.localCcContributors=R),class:"checkbox--notify-contributors"},{default:r(()=>t[4]||(t[4]=[m(" Notify contributors when Kudoboard is delivered ")])),_:1},8,["modelValue"])),a("div",wa,[e.board.delivery_date?f("",!0):(l(),v("div",ka,[a("div",Ca,[d(S,{ref:"confirmDelivery","button-classes":"btn-p-lg btn-p-primary",portal:"#modals","is-loading":s.isDelivering,"validation-callback":i.deliverNowValidationCallback,onOk:i.handleDeliverNow},{modalHeader:r(()=>t[5]||(t[5]=[m(" Deliver now ")])),modalText:r(()=>t[6]||(t[6]=[m(" Are you sure you want to deliver your Kudoboard immediately? ")])),default:r(()=>[t[7]||(t[7]=a("span",null," Deliver now ",-1)),d(y,{fill:"",type:"send",class:"send-icon"})]),_:1},8,["is-loading","validation-callback","onOk"]),d(I,{type:"button",class:"btn-p-lg btn-p-secondary",loading:s.isScheduling,onClick:i.handleScheduleDelivery},{default:r(()=>[d(y,{fill:"",type:"schedule"}),t[8]||(t[8]=a("span",null," Schedule ",-1))]),_:1},8,["loading","onClick"])]),d(c,{error:s.deliveryError},null,8,["error"])]))]),d(k,{"board-id":e.board.public_id,note:s.localRecipientNote},null,8,["board-id","note"]),e.board.cash_gift_amount>0?(l(),v("p",Sa,t[9]||(t[9]=[m(" The recipient can redeem their gift card from the "),a("span",{class:"tw-inline sm:tw-block"},"delivery email.",-1)]))):f("",!0)]),t[18]||(t[18]=a("hr",{class:"tw-my-7"},null,-1)),a("div",Ia,[d(y,{fill:"",type:"copy-link",class:"tw-text-[24px] tw-mr-2"}),a("span",Ta,[t[13]||(t[13]=m(" Or share board via a ")),d(_,{content:`${i.boardUrlForRecipient}#view`},{default:r(()=>t[10]||(t[10]=[a("a",{class:"copy-link"}," board link ",-1)])),_:1},8,["content"]),t[14]||(t[14]=m(" or ")),a("a",{href:e.boardQrDownloadTokenUrl,target:"_blank",class:"copy-link"}," QR code ",8,Ea),t[15]||(t[15]=m(" & then ")),d(S,{"button-classes":"tw-inline-block tw-underline tw-text-gray-80 tw-p-0 tw-border-none tw-bg-transparent",class:"tw-inline-block",portal:"#modals",onOk:i.handleMarkDelivered},{modalHeader:r(()=>t[11]||(t[11]=[m(" Mark delivered ")])),modalText:r(()=>[m(C(i.markDeliveredText),1)]),default:r(()=>[t[12]||(t[12]=m(" mark it delivered "))]),_:1},8,["onOk"])])]),a("div",Da,[d(I,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isSettingsDirty&&!i.isRecipientsDirty,"is-loading":s.isSaving,onClick:i.handleSave},{default:r(()=>t[16]||(t[16]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[2]||(t[2]=R=>e.$router.replace({name:"settings"}))}," Cancel ")])]),s.showMaxDeliveriesModal?(l(),g($,{key:0,"board-id":e.board.public_id,onClose:t[3]||(t[3]=()=>s.showMaxDeliveriesModal=!1)},null,8,["board-id"])):f("",!0)])}const Ot=w(ya,[["render",Ra],["__scopeId","data-v-8bef1b58"]]),Ma={components:{StylesWrapper:Li},props:{autocompleteUrl:{type:String,default:null},placeholder:{type:String,default:null},showNames:{type:Boolean,default:!1},modelValue:{type:Array,required:!0},tagifyDefaultClass:{type:String,default:"tagify-default"},tagifyFocusClass:{type:String,default:"tagify-focus-default"}},data(){return{internalTemplates:{tag(e,{settings:t}){const n=e.groupId?'<img src="/images/icons/invites-black.svg" class="tw-h-[14px] tw-w-[14px]" />':"",p=e.hideRemove?"":`<x title='' class="${t.classNames.tagX}" role='button' aria-label='remove tag'></x>`,s=`${t.classNames.tag} ${e.class||""}`,i=e.groupId?"tw-mr-1":"";return`<tag title="${e.title||e.value}"
                                contenteditable='false'
                                spellcheck='false'
                                tabIndex="${t.a11y.focusableTags?0:-1}"
                                class="${s}"
                                ${this.getAttributes(e)}>
                        ${p}
                        <div class="tw-flex">
                            <span class="${i} ${t.classNames.tagText}">${e[t.tagTextProp]||e.value}</span>
                            ${n}
                        </div>
                    </tag>`},dropdownItem(e){const t=e.name||e.groupName,n=t?`<span class="tw-font-normal">${t}</span>`:"";return`
                        <div
                            class='tagify__dropdown__item'
                            tabindex="0"
                            role="option"
                            ${this.getAttributes(e)}
                        >
                            ${n}
                            <span class="tw-gray-80">
                                ${e.email||e.value}
                            </span>
                        </div>
                    `}}}},watch:{modelValue:{deep:!0,handler(e){if(e.length>this.tagify.value.length){const t=e.filter(n=>!this.tagify.value.find(p=>(p.userId||null)===n.userId&&(p.name||p.value)===n.name));this.tagify.addTags(t.map(n=>this.toTag(n)))}else if(e.length<this.tagify.value.length){const t=this.tagify.value.filter(p=>!e.find(s=>s.userId===p.userId&&s.name===p.name)).map(p=>p.value),n=Array.from(this.$el.querySelectorAll("tag")).filter(p=>t.includes(p.getAttribute("value")));this.tagify.removeTags(n)}e&&e.length?this.setPlaceholder(""):this.setPlaceholder(this.placeholder)}},placeholder(e){this.setPlaceholder(e)}},mounted(){this.tagify=new Pi(this.$refs.input,{callbacks:{change:this.handleChange,input:this.handleInput,invalid:()=>{},focus:this.toggleClasses,blur:this.toggleClasses},delimiters:`,| |
|\r`,dropdown:{enabled:3,maxItems:5,searchKeys:["value","searchBy","realName"]},editTags:!1,placeholder:this.placeholder,tagTextProp:"displayValue",templates:{...this.internalTemplates},trim:!0,validate:this.validateTag,whitelist:[]}),this.tagify.toggleClass(this.tagifyDefaultClass),this.modelValue.length&&this.tagify.loadOriginalValues(this.modelValue.map(e=>this.toTag(e)))},beforeUnmount(){this.tagify&&this.tagify.destroy()},methods:{toggleClasses(){this.tagify.toggleClass(this.tagifyDefaultClass),this.tagify.toggleClass(this.tagifyFocusClass)},validateTag(e){return!!e.userId},toTag(e){return{userId:e.userId||null,realName:e.realName||null,userName:e.userName,displayValue:e.userName,value:`${e.userId||"null"}-${e.userName}`}},setPlaceholder(e){this.tagify.DOM.input.setAttribute("data-placeholder",e)},handleChange(e){const t=JSON.parse(e.detail.value||"[]");this.$emit("update:modelValue",t.map(n=>({userId:n.userId||null,realName:n.realName||null,userName:n.userName||n.value})))},handleInput(e){const t=e.detail.value;this.autocompleteUrl&&this.updateWhitelist(t)},updateWhitelist:Vi.debounce(async function(t){const n=t.replace(/(<|>)/g,"");try{const s=(await X.get(`${this.autocompleteUrl}${n}`)).data.map(i=>({userId:i.id||null,realName:i.real_name||null,userName:i.name||null,value:`${i.name} (${i.real_name})`,displayValue:`@${i.name}`,searchBy:n}));this.tagify.settings.whitelist=s,s.length?this.tagify.dropdown.show.call(this.tagify,n):this.tagify.dropdown.hide.call(this.tagify)}catch(p){console.log(p)}},300),resetWhitelist(){this.tagify.settings.whitelist=[]},reset(){this.tagify.removeAllTags()}}},$a={ref:"input",type:"text"};function Ba(e,t,n,p,s,i){const c=o("styles-wrapper");return l(),g(c,null,{default:r(()=>[a("input",$a,null,512)]),_:1})}const Pt=w(Ma,[["render",Ba],["__scopeId","data-v-21101fc2"]]),Ua={name:"Recipient",components:{InputError:K,MessagingAutocomplete:Re,MultipleMessagingInput:Pt,Selector:Ze},mixins:[Ct],props:{recipients:{type:Array,required:!0},showValidation:{type:Boolean,required:!0},deliveryMethod:{type:String,required:!0}},data(){return{deliverType:"pm",deliverTypeOptions:[{text:"Deliver via direct message",value:"dm"},{text:"Deliver in channel",value:"pm"}],editRecipients:[],channel:null,channelName:""}},computed:{isValid(){return!!this.recipients.length},errorMessage(){return this.isValid||!this.showValidation?"":this.recipients.length===0?"At least one board recipient is required.":this.deliverType==="pm"&&!this.channel?"The board delivery channel is required.":""},...T(["isConsumer"]),...T({pendingMessagingChannel:e=>e.delivery.pendingMessagingChannel}),...B(["savedMessagingChannel"])},watch:{editRecipients:{immediate:!0,deep:!0,handler(e){this.$emit("update-recipients",this.mapRecipients(e,this.channel))}},channel:{immediate:!0,deep:!0,handler(e){this.channelName=(e==null?void 0:e.name)||"",this.$emit("update-recipients",this.mapRecipients(this.editRecipients,e))}},pendingMessagingChannel:{immediate:!0,deep:!0,handler(e){this.channel=e}}},mounted(){this.editRecipients=this.recipients.map(e=>{const t={};return t.userId=e[`${this.deliveryMethod}_user_id`],t.userName=e[`${this.deliveryMethod}_user_name`],t.realName=e[`${this.deliveryMethod}_real_name`],this.channel={},this.channel.real_name=e[`${this.deliveryMethod}_channel_real_name`],this.channel.id=e[`${this.deliveryMethod}_channel_id`],this.channel.name=e[`${this.deliveryMethod}_channel_name`],this.channel.id||(this.deliverType="dm"),t})},beforeUnmount(){this.$store.commit("setMessagingChannel",this.channel)},methods:{handleChannelAutoComplete(e){this.channel=e},handleChangeDeliveryType(){this.deliverType==="dm"&&(this.channel=null)},mapRecipients(e,t){return e.map(n=>{const p={};return p[`${this.deliveryMethod}_user_id`]=n.userId,p[`${this.deliveryMethod}_user_name`]=n.userName,p[`${this.deliveryMethod}_real_name`]=n.realName,t?(p[`${this.deliveryMethod}_channel_id`]=t.id,p[`${this.deliveryMethod}_channel_name`]=t.name):(p[`${this.deliveryMethod}_channel_id`]=null,p[`${this.deliveryMethod}_channel_name`]=null),p})},focus(){this.$refs.channelContainer.querySelector("input").focus()}}},Aa={key:1,class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"};function xa(e,t,n,p,s,i){const c=o("selector"),u=o("messaging-autocomplete"),h=o("multiple-messaging-input"),b=o("input-error");return l(),g(b,{ref:"channelContainer",error:i.errorMessage},{default:r(()=>[t[4]||(t[4]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Delivery method ",-1)),d(c,{modelValue:s.deliverType,"onUpdate:modelValue":[t[0]||(t[0]=y=>s.deliverType=y),i.handleChangeDeliveryType],options:s.deliverTypeOptions,class:"tw-mb-4"},null,8,["modelValue","options","onUpdate:modelValue"]),s.deliverType==="pm"?(l(),v(E,{key:0},[t[3]||(t[3]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Recipient details ",-1)),s.deliverType==="pm"?(l(),g(u,{key:0,modelValue:s.channelName,"onUpdate:modelValue":t[1]||(t[1]=y=>s.channelName=y),url:"/api/messaging/autocomplete/search?type=channels&",placeholder:"Channel",class:"tw-mb-2",onSelected:i.handleChannelAutoComplete},null,8,["modelValue","onSelected"])):f("",!0)],64)):(l(),v("div",Aa," Recipient(s) ")),d(h,{ref:"usernames",modelValue:s.editRecipients,"onUpdate:modelValue":t[2]||(t[2]=y=>s.editRecipients=y),"autocomplete-url":"/api/messaging/autocomplete/search?type=users&query=","show-names":!e.isConsumer,placeholder:"Board recipients"},null,8,["modelValue","show-names"])]),_:1},8,["error"])}const Na=w(Ua,[["render",xa],["__scopeId","data-v-cf2d153e"]]),Ga={components:{ConfirmButton:te,CopyableSlot:Mt,ErrorPanel:zi,Icon:U,LoadingButton:H,MessagingRecipients:Na,TextareaInput:$e},mixins:[de],props:{deliveryMethod:{type:String,required:!0}},data(){return{localCcContributors:!1,localRecipientNote:"",localRecipients:[],isDelivering:!1,isSaving:!1,isScheduling:!1,isShowingValidation:!1,requireEmail:!this.isConsumer,error:null,deliveryError:null,message:null,type:null}},computed:{boardUrlForRecipient(){return this.recipientUrl??this.board.url},ccContributors(){return this.board.cc_contributors},recipientEmails(){return this.localRecipients.map(e=>e.email).filter(e=>!!e)},isRecipientsDirty(){if(this.localRecipients.length!==this.savedMessagingRecipients.length)return!0;function e(t,n){return!t&&!n||t===n}return!this.localRecipients.every((t,n)=>{const p=this.savedMessagingRecipients[n];return e(t[`${this.deliveryMethod}_user_id`],p[`${this.deliveryMethod}_user_id`])&&e(t[`${this.deliveryMethod}_user_name`],p[`${this.deliveryMethod}_user_name`])&&e(t[`${this.deliveryMethod}_real_name`],p[`${this.deliveryMethod}_real_name`])&&e(t[`${this.deliveryMethod}_channel_id`],p[`${this.deliveryMethod}_channel_id`])&&e(t[`${this.deliveryMethod}_channel_name`],p[`${this.deliveryMethod}_channel_name`])})},isSettingsDirty(){return this.savedRecipientNote!==this.localRecipientNote||this.ccContributors!==this.localCcContributors||this.board.delivery_method!==this.deliveryMethod},markDeliveredText(){return"Are you sure you want to mark your board as delivered? "+(this.recipientEmails.length?"This will automatically follow up with the recipient so they can print their board & thank contributors.":"This will stop any future reminder emails from going out.")},...T(["allowOutsideRecipients","board","isConsumer","recipientUrl"]),...T({pendingRecipientNote:e=>e.delivery.pendingRecipientNote}),...B(["isScheduled","boardQrDownloadTokenUrl","pendingMessagingRecipients","savedMessagingRecipients","savedRecipientNote"])},watch:{ccContributors:{immediate:!0,handler(e){this.localCcContributors=e}},pendingMessagingRecipients:{immediate:!0,deep:!0,handler(e){this.localRecipients=oe(e)}},pendingRecipientNote:{immediate:!0,handler(e){this.localRecipientNote=e}}},beforeUnmount(){this.isRecipientsDirty&&this.$store.commit("pendingIndividualRecipients",this.localRecipients),this.$store.commit("pendingRecipientNote",this.localRecipientNote)},methods:{async handleSave(){if(this.resetErrors(),!!await this.validateRecipients(this.isScheduled)){this.isSaving=!0;try{await this.saveAll(),x("Your changes were saved.")}catch(e){console.error(e),this.error=z(e)}finally{this.isSaving=!1}}},async handleDeliverNow(){if(this.$refs.confirmDelivery.hideConfirmation(),this.resetErrors(),!!await this.validateRecipients(!0)){this.isDelivering=!0;try{await this.saveAll(),await this.deliverNow(),this.$emit("close"),this.$store.commit("showDeliverySuccessModal")}catch(e){if(console.error(e),e.response.status===418){P.emitter.once("email-was-verified",this.handleDeliverNow),this.showEmailVerification(null,"deliver");return}this.deliveryError=z(e)}finally{this.isDelivering=!1}}},async handleScheduleDelivery(){if(this.resetErrors(),!!await this.validateRecipients(!0)){this.isScheduling=!0;try{await this.saveAll(),this.$router.replace({name:`delivery-schedule-${this.deliveryMethod}`})}catch(e){console.error(e),this.deliveryError=z(e)}finally{this.isScheduling=!1}}},async handleMarkDelivered(){try{await this.$store.dispatch("markDelivered"),this.$router.replace({name:"settings",params:{success:"Your board has been marked as delivered!"}})}catch(e){console.error(e),ne(e)}},deliverNow(){return this.$store.dispatch("deliverNow")},saveAll(){return Promise.all([this.saveRecipients(),this.saveSettings()])},saveRecipients(){return this.isRecipientsDirty?this.$store.dispatch("saveRecipients",{recipients:this.localRecipients}):null},saveSettings(){return this.isSettingsDirty?this.$store.dispatch("saveDeliverySettings",{recipientNote:this.localRecipientNote,ccContributors:this.localCcContributors,deliveryMethod:this.deliveryMethod}):null},async validateRecipients(e){this.requireEmail=e,this.isShowingValidation=!0,await this.$nextTick();const t=!!this.localRecipients.length;return t||this.scrollToFirstError(),t},scrollToFirstError(){const e=this.$el.querySelector(".error-message");if(!e)return;const t=e.closest(".row");t&&t.scrollIntoView()},resetErrors(){this.error=null,this.deliveryError=null},handleUpdateRecipients(e){this.localRecipients=e}}},Oa={key:0},Pa={class:"tw-flex tw-items-center tw-gap-x-3"},La={key:0,class:"tw-mt-5 tw-text-gray-80 tw-text-sm tw-italic"},Va={class:"share-text"},za=["href"],Fa={class:"drawer-container__footer"};function qa(e,t,n,p,s,i){const c=o("messaging-recipients"),u=o("error-panel"),h=o("textarea-input"),b=o("icon"),y=o("confirm-button"),S=o("loading-button"),I=o("copyable-slot");return l(),v("div",null,[a("div",null,[d(c,{recipients:s.localRecipients,"show-validation":s.isShowingValidation,"delivery-method":n.deliveryMethod,class:"tw-mb-4",onUpdateRecipients:i.handleUpdateRecipients},null,8,["recipients","show-validation","delivery-method","onUpdateRecipients"]),d(u,{errors:s.error&&[s.error]},null,8,["errors"]),a("div",null,[t[6]||(t[6]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Enter a custom message (optional) ",-1)),d(h,{modelValue:s.localRecipientNote,"onUpdate:modelValue":t[0]||(t[0]=k=>s.localRecipientNote=k),rows:"5",placeholder:"Optional message",class:"tw-mb-3 tw-input-md"},null,8,["modelValue"]),a("div",null,[e.board.delivery_date?f("",!0):(l(),v("div",Oa,[d(u,{errors:s.deliveryError&&[s.deliveryError]},null,8,["errors"]),a("div",Pa,[d(y,{ref:"confirmDelivery","button-classes":"btn-p-lg btn-p-primary",portal:"#modals","is-loading":s.isDelivering,onOk:i.handleDeliverNow},{modalHeader:r(()=>t[2]||(t[2]=[m(" Deliver now ")])),modalText:r(()=>t[3]||(t[3]=[m(" Are you sure you want to deliver your Kudoboard immediately? ")])),default:r(()=>[t[4]||(t[4]=a("span",null," Deliver now ",-1)),d(b,{fill:"",type:"send",class:"send-icon"})]),_:1},8,["is-loading","onOk"]),d(S,{type:"button",class:"btn-p-lg btn-p-secondary",loading:s.isScheduling,onClick:i.handleScheduleDelivery},{default:r(()=>[d(b,{fill:"",type:"schedule"}),t[5]||(t[5]=a("span",null," Schedule ",-1))]),_:1},8,["loading","onClick"])])]))]),e.board.cash_gift_amount>0?(l(),v("p",La," The recipient can redeem their gift card from the delivery message in "+C(n.deliveryMethod==="teams"?"Teams":"Slack")+". ",1)):f("",!0)]),t[14]||(t[14]=a("hr",{class:"tw-my-7"},null,-1)),a("div",Va,[d(b,{fill:"",type:"copy-link",class:"tw-text-icon tw-mr-2"}),a("div",null,[t[10]||(t[10]=m(" Or share board via a ")),d(I,{content:`${i.boardUrlForRecipient}#view`},{default:r(()=>t[7]||(t[7]=[a("a",{class:"copy-link"}," board link ",-1)])),_:1},8,["content"]),t[11]||(t[11]=m(" or ")),a("a",{href:e.boardQrDownloadTokenUrl,target:"_blank",class:"copy-link"}," QR code ",8,za),t[12]||(t[12]=m(" & then ")),d(y,{"button-classes":"tw-inline-block tw-underline tw-text-gray-80 tw-p-0 tw-border-none tw-bg-transparent",class:"tw-inline-block",portal:"#modals",onOk:i.handleMarkDelivered},{modalHeader:r(()=>t[8]||(t[8]=[m(" Mark delivered ")])),modalText:r(()=>[m(C(i.markDeliveredText),1)]),default:r(()=>[t[9]||(t[9]=m(" mark it delivered "))]),_:1},8,["onOk"])])]),a("div",Fa,[d(S,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isSettingsDirty&&!i.isRecipientsDirty,"is-loading":s.isSaving,onClick:i.handleSave},{default:r(()=>t[13]||(t[13]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[1]||(t[1]=k=>e.$router.replace({name:"settings"}))}," Cancel ")])])])}const Ya=w(Ga,[["render",qa],["__scopeId","data-v-373dbbbe"]]),Ha={mixins:[ye],props:{boardId:{type:String,default:null},canApplyPackageCredit:{type:Boolean,default:!1},trackContext:{type:String,default:null}},computed:{upgradeUrl(){return this.route("boards.upgrade",this.boardId)}},methods:{emitShowApplyPackageCreditModal(){this.trackDemoUpgradeClicked(),P.emitter.emit("show-apply-package-credit-modal")},trackDemoUpgradeClicked(){F.boardUpgradeClicked(Je,this.trackContext)}}},ja={class:"demo-overlay"},Wa={class:"demo-overlay__prompt"},Ka={class:"tw-font-semibold tw-text-xl tw-mt-5"},Qa={class:"tw-text-base tw-mt-1"},Ja=["href"];function Xa(e,t,n,p,s,i){return l(),v("div",ja,[a("div",Wa,[a("div",Ka,[D(e.$slots,"heading",{},()=>[t[2]||(t[2]=m(" Demo boards cannot be delivered "))],!0)]),a("div",Qa,[D(e.$slots,"subheading",{},()=>[t[3]||(t[3]=m(" Upgrade this board to exit Demo mode "))],!0)]),n.canApplyPackageCredit?f("",!0):(l(),v("a",{key:0,class:"btn-p btn-p-primary tw-mb-6 tw-mt-3",href:i.upgradeUrl,onClick:t[0]||(t[0]=(...c)=>i.trackDemoUpgradeClicked&&i.trackDemoUpgradeClicked(...c))}," Upgrade now ",8,Ja)),n.canApplyPackageCredit?(l(),v("span",{key:1,class:"btn-p btn-p-primary tw-mb-6 tw-mt-3",onClick:t[1]||(t[1]=Ie((...c)=>i.emitShowApplyPackageCreditModal&&i.emitShowApplyPackageCreditModal(...c),["prevent"]))}," Upgrade now ")):f("",!0)])])}const Lt=w(Ha,[["render",Xa],["__scopeId","data-v-8a76af6a"]]),Za={href:"/admin/plan",target:"_blank",class:"btn-p btn-p-primary",rel:"noopener noreferrer"},el={__name:"invites-messaging-integration-upsell",setup(e){return(t,n)=>(l(),g(Fi,{class:"tw-mt-4"},{header:r(()=>n[0]||(n[0]=[a("span",{class:"tw-text-brand"},"Integrations",-1)])),title:r(()=>n[1]||(n[1]=[m(" Integrate with Slack or MS Teams ")])),description:r(()=>n[2]||(n[2]=[m(" Easily integrate Kudoboard with your team's communication platforms to invite, tag others, or deliver Kudoboards. Only available on "),a("strong",{class:"tw-text-black"},"Pro",-1),m(" and "),a("strong",{class:"tw-text-black"},"Enterprise",-1),m(" plans. ")])),cta:r(()=>[a("a",Za,[d(U,{type:"lock",fill:"",class:"tw-text-icon"}),n[3]||(n[3]=m(" Upgrade "))])]),image:r(()=>n[4]||(n[4]=[a("img",{alt:"Messaging Integrations Graphic",class:"tw-max-w-[240px]",src:"/images/integrations-hero.png"},null,-1)])),_:1}))}},Vt=w(el,[["__scopeId","data-v-ebcb574b"]]),tl={components:{Container:q,ConfirmButton:te,DeliverySummary:na,DemoBoardOverlay:Lt,EmailDeliverySettings:Ot,Icon:U,InvitesMessagingIntegrationUpsell:Vt,MessagingDeliverySettings:Ya,Notification:Ut,Tab:Ee,Tabs:De},mixins:[ye],computed:{isDeliverable(){return this.board.delivery_date&&this.board.delivery_method},isEmailDelivery(){return this.board.delivery_method==="email"||!this.board.delivery_method},isSlackDelivery(){return this.board.delivery_method==="slack"},isTeamsDelivery(){return this.board.delivery_method==="teams"},deliveryMessage(){if(!this.board.delivery_date||!this.board.delivery_method)return null;const e=A(this.board.delivery_date,se).format("MM/DD/YYYY"),t=A(this.board.delivery_date,se).format("h:mma");return`
                Board will be delivered via ${this.board.delivery_method==="email"?"email":this.board.delivery_method.charAt(0).toUpperCase()+this.board.delivery_method.slice(1)} at:
                <span class="tw-font-semibold">${t}</span>
                on
                <span class="tw-font-semibold">${e}</span>.
            `},...T(["isConsumer","isSlackConnected","isTeamsConnected","board","showMessagingIntegrationsUpsell"]),...B(["canEditBoard","isDelivered","isDemoSinglePostBoard","isMultiPostDemoBoard","isMiniBoard","isStarter"]),...T({canApplyPackageCredit:e=>e.permissions.canApplyPackageCredit})},methods:{handleClose(){P.emitter.emit("settings:hide")},async handleEditDelivery(){await this.$store.dispatch("resetScheduledDelivery"),x("The scheduled delivery has been reset.")}}},il={key:0},nl={class:"tw-flex"},sl=["innerHTML"];function rl(e,t,n,p,s,i){const c=o("delivery-summary"),u=o("icon"),h=o("confirm-button"),b=o("notification"),y=o("email-delivery-settings"),S=o("tab"),I=o("messaging-delivery-settings"),k=o("invites-messaging-integration-upsell"),_=o("tabs"),$=o("demo-board-overlay"),R=o("container");return l(),g(R,null,{header:r(()=>t[0]||(t[0]=[m(" Delivery settings ")])),default:r(()=>[e.board.delivery_date||e.isDelivered||!e.canEditBoard?(l(),v("div",il,[d(c),e.board.delivery_date&&!e.isDelivered&&e.canEditBoard?(l(),g(h,{key:0,ref:"confirmationButton",portal:"#modals","button-classes":"btn-p-lg btn-p-primary tw-mt-1",onOk:i.handleEditDelivery},{modalHeader:r(()=>t[1]||(t[1]=[m(" Edit board delivery ")])),modalText:r(()=>t[2]||(t[2]=[a("span",null," Are you sure you want to edit the board delivery details? ",-1),a("span",{class:"tw-font-semibold"}," It will need to be rescheduled once you are done. ",-1)])),default:r(()=>[d(u,{type:"edit",fill:""}),t[3]||(t[3]=a("span",null," Edit ",-1))]),_:1},8,["onOk"])):f("",!0)])):(l(),v(E,{key:1},[a("div",null,[Y(d(b,{class:"tw-mb-3"},{default:r(()=>[a("div",nl,[d(u,{fill:"",type:"schedule",class:"tw-mr-1 tw-text-4xl tw-pb-1"}),a("div",{innerHTML:i.deliveryMessage},null,8,sl)])]),_:1},512),[[j,!e.isConsumer&&i.isDeliverable]]),e.isSlackConnected||e.isTeamsConnected||e.showMessagingIntegrationsUpsell?(l(),g(_,{key:0,links:!0,"update-location":!1,class:"tabs"},{default:r(()=>[d(S,{id:"email",order:1,title:"Email",active:i.isEmailDelivery,"remove-when-hidden":!0},{default:r(()=>[d(y,{onClose:i.handleClose},null,8,["onClose"])]),_:1},8,["active"]),e.isSlackConnected?(l(),g(S,{key:0,id:"slack",order:2,title:"Slack",active:i.isSlackDelivery,"remove-when-hidden":!0},{default:r(()=>[d(I,{"delivery-method":"slack",onClose:i.handleClose},null,8,["onClose"])]),_:1},8,["active"])):f("",!0),e.isTeamsConnected?(l(),g(S,{key:1,id:"teams",order:3,title:"Microsoft Teams",active:i.isTeamsDelivery,"remove-when-hidden":!0},{default:r(()=>[d(I,{"delivery-method":"teams",onClose:i.handleClose},null,8,["onClose"])]),_:1},8,["active"])):f("",!0),e.showMessagingIntegrationsUpsell?(l(),g(S,{key:2,id:"messaging-integrations-upsell",order:4,title:"Slack/Teams","remove-when-hidden":!0},{default:r(()=>[d(k)]),_:1})):f("",!0)]),_:1})):f("",!0),!e.isSlackConnected&&!e.isTeamsConnected&&!e.showMessagingIntegrationsUpsell?(l(),g(y,{key:1,onClose:i.handleClose},null,8,["onClose"])):f("",!0)]),e.isMultiPostDemoBoard&&!e.isStarter?(l(),g($,{key:0,"board-id":e.board.public_id,"can-apply-package-credit":e.canApplyPackageCredit,"track-context":"delivery-settings",class:"tw-absolute tw-pt-[122px] md:tw-pt-[65px] tw-right-0 tw-left-0 tw-top-0"},null,8,["board-id","can-apply-package-credit"])):f("",!0)],64))]),_:1})}const ol=w(tl,[["render",rl],["__scopeId","data-v-2364c2ef"]]),al={components:{DropdownMenu:Yi,MenuButton:Hi,MenuItems:qi},props:{buttonClasses:{type:String,default:"btn-p btn-p-primary"},disabled:{type:Boolean,default:!1}},methods:{close(){this.$refs.menu.close()}}},ll={class:"tw-flex"},dl=["disabled"];function ul(e,t,n,p,s,i){const c=o("menu-button"),u=o("menu-items"),h=o("dropdown-menu");return l(),v("div",ll,[a("button",{type:"button",class:W(["primary-button",n.buttonClasses]),disabled:n.disabled,onClick:t[0]||(t[0]=b=>e.$emit("primary-button-clicked"))},[D(e.$slots,"primary-button",{},void 0,!0)],10,dl),d(h,{ref:"menu",placement:"bottom-end"},{default:r(()=>[d(c,{disabled:n.disabled,class:W(["menu-button",[n.buttonClasses,n.disabled?"disabled-rule":"rule"]])},{default:r(()=>[D(e.$slots,"menu-button",{},void 0,!0)]),_:3},8,["disabled","class"]),d(u,null,{default:r(()=>[D(e.$slots,"menu-items",{},void 0,!0)]),_:3})]),_:3},512)])}const zt=w(al,[["render",ul],["__scopeId","data-v-e93308a1"]]),cl={components:{Modal:fe},props:{recipients:{type:Array,required:!0}},computed:{hasMultipleRecipients(){return this.recipients.length>1},bodyText(){return`
                The following ${Ui("(user is a board recipient/are board recipients)",this.hasMultipleRecipients)}
                and will receive an invite to contribute to the board:
            `}}},ml={class:"tw-m-h-[350px] tw-overflow-y-scroll tw-mt-3 tw-text-black tw-font-normal"},pl={class:"tw-pl-6 tw-mb-1"};function hl(e,t,n,p,s,i){const c=o("modal");return l(),g(c,{onClose:t[2]||(t[2]=u=>e.$emit("close"))},{header:r(()=>t[3]||(t[3]=[m(" Are you sure you want to invite? ")])),footer:r(()=>[a("button",{class:"btn-p btn-p-primary",type:"button",onClick:t[0]||(t[0]=u=>e.$emit("close"))}," Cancel invite "),a("button",{class:"btn-p btn-p-secondary js-invite",type:"button",onClick:t[1]||(t[1]=u=>e.$emit("invite"))}," Invite anyway ")]),default:r(()=>[m(" "+C(i.bodyText)+" ",1),a("div",ml,[a("ul",pl,[(l(!0),v(E,null,O(n.recipients,(u,h)=>(l(),v("li",{key:h},C(u),1))),128))])])]),_:1})}const vl=w(cl,[["render",hl]]),gl={components:{Notification:Ut},props:{count:{type:Number,default:null},currentTab:{type:String,required:!0}},watch:{count(){P.emitter.emit("contributor-count-updated",this.count)}}};function fl(e,t,n,p,s,i){const c=o("notification");return n.count?(l(),g(c,{key:0,class:"tw-justify-between"},{default:r(()=>[a("span",null,[a("a",{tabindex:"0",onClick:t[0]||(t[0]=u=>e.$router.replace({name:"contributors-invited",params:{fromTab:n.currentTab,selectNonContributors:!1}})),onKeydown:t[1]||(t[1]=Ce(u=>e.$router.replace({name:"contributors-invited",params:{fromTab:n.currentTab,selectNonContributors:!1}}),["enter"]))},C(n.count)+" "+C(n.count===1?"contributor":"contributors"),33),t[4]||(t[4]=m(" already invited "))]),a("a",{tabindex:"0",onClick:t[2]||(t[2]=u=>e.$router.replace({name:"contributors-invited",params:{fromTab:n.currentTab,selectNonContributors:!0}})),onKeydown:t[3]||(t[3]=Ce(u=>e.$router.replace({name:"contributors-invited",params:{fromTab:n.currentTab,selectNonContributors:!0}}),["enter"]))}," Reminders ",32)]),_:1})):f("",!0)}const Ft=w(gl,[["render",fl]]),bl={components:{ExpandingLink:Wi,Icon:U},props:{recentInvitees:{type:Array,required:!0},remainingRecentInvitees:{type:Array,required:!0}},data(){return{isShowing:!1}},computed:{remainingInviteeIds(){return this.remainingRecentInvitees.map(e=>e.id)}},methods:{handleSelectAll(){this.$emit("selected",this.remainingRecentInvitees.slice()),this.isShowing=!1}}},yl={class:"margin-bottom-md tw-mt-1"},_l={class:"inner-container"},wl=["onClick"],kl={key:0},Cl={key:1},Sl={key:2},Il={key:3};function Tl(e,t,n,p,s,i){const c=o("icon"),u=o("expanding-link");return l(),v("div",yl,[d(u,{title:"Add from recent invite list",expanded:s.isShowing},{default:r(()=>[a("div",_l,[Y(a("div",null," You don't have any recently invited users ",512),[[j,n.recentInvitees.length===0]]),Y(a("div",null," There are no more recent invitees to invite! ",512),[[j,n.recentInvitees.length&&n.remainingRecentInvitees.length===0]]),(l(!0),v(E,null,O(n.remainingRecentInvitees,h=>(l(),v("div",{key:h.id,class:"tw-flex tw-flex-col tw-mb-1.5"},[a("button",{class:"invitee-link",onClick:b=>e.$emit("selected",h)},[d(c,{type:"plus",fill:"tw-text-icon"}),h.name?(l(),v("span",kl,C(h.name)+" <"+C(h.email)+"> ",1)):h.slack_real_name?(l(),v("span",Cl,C(h.slack_real_name)+" @"+C(h.slack_user_name),1)):h.teams_real_name?(l(),v("span",Sl,C(h.teams_real_name)+" @"+C(h.teams_user_name),1)):!h.name&&!h.slack_real_name&&!h.teams_real_name?(l(),v("span",Il,C(h.email),1)):f("",!0)],8,wl)]))),128)),Y(a("button",{type:"button",class:"btn-p-link",onClick:t[0]||(t[0]=(...h)=>i.handleSelectAll&&i.handleSelectAll(...h))},[d(c,{type:"plus",fill:"tw-text-icon"}),t[1]||(t[1]=a("span",null," Add all ",-1))],512),[[j,n.remainingRecentInvitees.length]])])]),_:1},8,["expanded"])])}const qt=w(bl,[["render",Tl],["__scopeId","data-v-0c9b6dd2"]]),Ae=3,El={components:{ConfirmButton:te,DeliveryStatus:At,EmailPreviewLink:rt,Icon:U,SettingsContainer:Z,Setting:ae,ToggleButtonSetting:ve},props:{channelName:{type:String,default:null},inviteDate:{type:String,required:!0},inviteId:{type:Number,required:!0},inviteTimezone:{type:String,required:!0},inviteMethod:{type:String,required:!0},inviteOffset:{type:String,default:null},invitees:{type:Array,required:!0},ccInvitees:{type:Boolean,default:!1},showCc:{type:Boolean,default:!0},showReminderEmail:{type:Boolean,default:!0},remindInvitees:{type:Boolean,default:!0},previewUrl:{type:String,default:null}},computed:{displayInvitees(){return this.invitees.slice(0,Ae)},additionalInviteesCount(){return this.invitees.length<=Ae?0:this.invitees.length-Ae},prettySendDate(){return pe.tz(this.inviteDate,se,this.inviteTimezone).format("MMMM D")},prettySendTime(){return pe.tz(this.inviteDate,se,this.inviteTimezone).clone().tz(this.inviteTimezone).format("h:mma z")}},methods:{getInviteeDisplayDetails(e){return this.inviteMethod!=="email"?e.realName:e.name&&e.users_count?`${e.name} (${e.users_count})`:e.email},handleEdit(){this.$refs.confirmationButton.hideConfirmation(),x("The scheduled invite has been reset."),this.$store.dispatch("resetScheduledInvite",{scheduledInviteId:this.inviteId})}}},Dl={class:"tw-flex tw-flex-col tw-items-end"},Rl=["person"],Ml={class:"tw-flex tw-flex-col tw-items-end"};function $l(e,t,n,p,s,i){const c=o("delivery-status"),u=o("setting"),h=o("email-preview-link"),b=o("toggle-button-setting"),y=o("settings-container"),S=o("icon"),I=o("confirm-button");return l(),v("div",null,[d(y,null,{header:r(()=>t[1]||(t[1]=[m(" Scheduled invite details ")])),default:r(()=>[d(u,null,{label:r(()=>t[2]||(t[2]=[m(" Status ")])),setting:r(()=>[d(c,{"delivery-date":n.inviteDate},null,8,["delivery-date"])]),default:r(()=>[t[3]||(t[3]=a("div",{class:"tw-mt-2 tw-text-sm tw-font-normal tw-text-gray-90"}," Contributors will be invited at the scheduled date and time below. ",-1))]),_:1}),d(u,{class:"invitees"},{label:r(()=>[m(C(n.invitees.length>1?"Contributors":"Contributor"),1)]),setting:r(()=>[a("div",Dl,[(l(!0),v(E,null,O(i.displayInvitees,k=>(l(),v("div",{key:k.email,person:k},C(i.getInviteeDisplayDetails(k)),9,Rl))),128)),i.additionalInviteesCount?(l(),v(E,{key:0},[a("div",null," and "+C(i.additionalInviteesCount)+" "+C(i.additionalInviteesCount>1?"others":"other"),1),i.additionalInviteesCount?(l(),v("button",{key:0,class:"btn-p-link",onClick:t[0]||(t[0]=k=>e.$router.replace({name:"scheduled-invitees",params:{inviteMethod:n.inviteMethod}}))}," View all ")):f("",!0)],64)):f("",!0)])]),_:1}),n.channelName?(l(),g(u,{key:0},{label:r(()=>t[4]||(t[4]=[m(" Channel ")])),setting:r(()=>[m(C(n.channelName),1)]),_:1})):f("",!0),n.previewUrl?(l(),g(u,{key:1},{label:r(()=>t[5]||(t[5]=[m(" Invitation email ")])),setting:r(()=>[d(h,{url:n.previewUrl},null,8,["url"])]),_:1})):f("",!0),d(u,{class:"invite-date"},{label:r(()=>t[6]||(t[6]=[m(" Send date ")])),setting:r(()=>[a("div",Ml,[a("div",null,C(i.prettySendDate),1),a("div",null,C(i.prettySendTime),1)])]),_:1}),n.showCc?(l(),g(b,{key:2,disabled:!0,"tooltip-content":"Contributors see each other's email addresses (works well if the group knows each other).","sr-text":"Toggle cc contributors","model-value":n.ccInvitees},{default:r(()=>t[7]||(t[7]=[m(" CC contributors on invitation ")])),_:1},8,["model-value"])):f("",!0),n.showReminderEmail?(l(),g(b,{key:3,disabled:!0,"tooltip-content":"Contributors who have not posted will receive a reminder 24 hours before scheduled delivery.","model-value":n.remindInvitees,"sr-text":"Toggle send reminder email"},{default:r(()=>t[8]||(t[8]=[m(" Send reminder email ")])),_:1},8,["model-value"])):f("",!0)]),_:1}),d(I,{ref:"confirmationButton",portal:"#modals","button-classes":"btn-p-lg btn-p-primary tw-mt-1",onOk:i.handleEdit},{modalHeader:r(()=>t[9]||(t[9]=[m(" Edit scheduled invite ")])),modalText:r(()=>t[10]||(t[10]=[a("span",null," Are you sure you want to edit this invite? ",-1),a("span",{class:"tw-font-semibold"}," It will need to be rescheduled once you are done. ",-1)])),default:r(()=>[d(S,{type:"edit",fill:""}),t[11]||(t[11]=a("span",null," Edit ",-1))]),_:1},8,["onOk"])])}const Yt=w(El,[["render",$l],["__scopeId","data-v-d19ade2c"]]),Bl={components:{GroupsLanderModal:Nt,ContributorCount:Ft,InputError:K,ExpandableButton:zt,MultipleEmailInput:ji,RecentInviteesPicker:qt,ScheduledInvite:Yt,VueRecaptcha:et,Icon:U,OptionMenuItem:le,InviteRecipientModal:vl,TextareaInput:$e,EmailPreviewLink:rt,SettingsContainer:Z,ToggleButtonSetting:ve,TeleportWrapper:ge},mixins:[de],props:{featureFlags:{type:Object,default:()=>{}}},data(){return{RECAPTCHA_SITE_KEY:Xe,captchaResponse:null,cc:!1,error:null,isLoading:!1,isShowingInviteRecipientsModal:!1,invitedRecipients:[],invitees:[],excluded:{},message:"",recentInvitees:[],confirmedInviteRecipientsCallback:null}},computed:{groupInvitees(){return this.invitees.filter(e=>e.groupId)},autocompleteUrl(){const e=this.inviteeUserIds.length?`&exclude_user_ids=${this.inviteeUserIds.join(",")}`:"",t=this.inviteeGroupIds.length?`&exclude_group_ids=${this.inviteeGroupIds.join(",")}`:"";return this.isConsumer?null:`/api/users/autocomplete/search?type=most-tagged${e}${t}&search=`},hasInvitedRecipients(){var e;return!!((e=this.invitedRecipients)!=null&&e.length)},inviteeEmails(){return this.invitees.filter(e=>!e.userId&&!e.groupId&&!e.id).map(e=>e.email)},inviteeUserIds(){return this.invitees.filter(e=>e.userId||e.user_id).map(e=>e.userId||e.user_id)},inviteeGuestIds(){return this.invitees.filter(e=>e.id&&!e.userId&&!e.groupId).map(e=>e.id)},inviteeGroupIds(){return this.groupInvitees.map(e=>e.groupId)},previewUrl(){return`/boards/${this.boardId}/contributors/invite-preview?context=${encodeURIComponent(this.message||"")}`},remainingRecentInvitees(){return this.recentInvitees.filter(e=>{const t=e.userId||e.user_id;return t?!this.inviteeUserIds.includes(t):e.id?!this.inviteeGuestIds.includes(e.id):e.email?!this.inviteeEmails.includes(e.email):!0})},isNotShoutOutBoardOrEventBoard(){return!(this.isP2PBoard||this.isEventBoard)},hasPendingScheduledInvite(){return this.scheduledEmailInvite&&!this.scheduledEmailInvite.invited_at},boardExclusions(){let e={};return this.scheduledEmailInvite&&(e=this.scheduledEmailInvite.exclusions.reduce((t,n)=>(t[n.user.id]=1,t),{})),e},isFormDirty(){const e=this.emailIndividualInvitees.filter(n=>!n.userId&&!n.groupId&&!n.id).map(n=>n.email),t=this.emailIndividualInvitees.filter(n=>n.userId).map(n=>n.userId);return this.hasNewGroupInvites||!this.areArrayEqual(this.inviteeEmails,e)||!this.areArrayEqual(this.inviteeUserIds,t)||!this.areArrayEqual(Object.keys(this.excluded),Object.keys(this.boardExclusions))||this.message.trim()!==this.inviteMessage.trim()||this.cc!==this.ccInvitees},hasNewGroupInvites(){return this.isConsumer?!1:this.emailIndividualInvitees.filter(t=>t.groupId).map(t=>t.groupId).some(t=>!this.scheduleGroupInviteIds.includes(t))},numberOfInvitees(){return this.inviteeEmails.length+this.inviteeUserIds.length+this.inviteeGuestIds.length+this.invitees.filter(e=>e.groupId).map(e=>e.usersCount).reduce((e,t)=>e+t,0)},scheduleGroupInviteIds(){return this.scheduledEmailInvite?this.scheduledEmailInvite.contributors.filter(e=>e.group).map(e=>e.group.id):[]},...T(["googleApiKey","googleClientId","isConsumer","permissions","board","excludedInviteeGroupMembers","initialInvitees","canAccessGroups","isAdmin"]),...T({boardId:e=>e.board.public_id,contributorCount:e=>e.invites.contributorCount,isScheduled:e=>!!e.board.delivery_date,remindInvitees:e=>e.board.remind_invitees,ccInvitees:e=>e.board.cc_invitees,canApplyPackageCredit:e=>e.permissions.canApplyPackageCredit,emailIndividualInvitees:e=>e.invites.emailIndividualInvitees,emailGroupInvitees:e=>e.invites.emailGroupInvitees,scheduledEmailInviteDate:e=>e.invites.scheduledEmailInviteDate,scheduledEmailInviteTimezone:e=>e.invites.scheduledEmailInviteTimezone,scheduledEmailInviteOffset:e=>e.invites.scheduledEmailInviteOffset,emailExcludedGroupMembers:e=>e.invites.emailExcludedGroupMembers,inviteMessage:e=>e.invites.message,scheduledEmailInvite:e=>e.invites.scheduledEmailInvite}),...B(["canUpdateEmailContent","isDemoBoard","isP2PBoard","isEventBoard","recipientUserIds","isStarter"])},watch:{inviteMessage:{immediate:!0,handler(e){this.message=e}},ccInvitees:{immediate:!0,handler(e){this.cc=e}},emailIndividualInvitees:{deep:!0,immediate:!0,handler(e){e&&e.length&&(this.invitees=oe(e))}},emailGroupInvitees:{deep:!0,immediate:!0,handler(e){e&&e.length&&(this.invitees=[...this.invitees.filter(t=>!t.group&&!t.groupId),...e])}},emailExcludedGroupMembers:{deep:!0,immediate:!0,handler(e){e&&(this.excluded=e)}}},mounted(){this.isDemoBoard||(this.$store.dispatch("loadContributorCount"),this.loadInitialValues())},beforeUnmount(){this.storeCurrentData()},methods:{storeCurrentData(){this.$store.commit("setInviteMessage",this.message),this.$store.commit("setEmailIndividualInvitees",this.invitees),this.$store.commit("setEmailGroupInvitees",this.groupInvitees),this.$store.commit("setEmailInviteExcludedGroupMembers",this.excluded)},isScheduledInviteValid(){return this.error=null,this.invitees.length||this.emailGroupInvitees.length?!0:(this.error="A user is required for scheduled invites",!1)},loadInitialValues(){this.loadRecentInvitees()},async handleShowScheduleInvites(){if(this.error=null,this.$refs.expandableButton.close(),F.scheduleSendClicked(),!!this.isScheduledInviteValid())try{if(this.invitedRecipients=await this.getInvitedRecipients(),this.hasInvitedRecipients){this.isShowingInviteRecipientsModal=!0,this.confirmedInviteRecipientsCallback=()=>{this.$router.replace({name:"schedule-invite",params:{inviteMethod:"email"}})};return}this.$router.replace({name:"schedule-invite",params:{inviteMethod:"email"}})}catch(e){console.error(e),this.error=z(e)}},async handleInput(e){const t=e.filter(n=>n.groupId).map(n=>n.groupId);t.length&&this.addGroupInvitee(t,[...this.invitees]),this.invitees=e},async addGroupInvitee(e,t){const n=t.filter(i=>i.groupId).map(i=>i.groupId),[p]=e.filter(i=>!n.includes(i));if(!p)return;const s=await this.getGroup(p);this.excludeBoardRecipientsInGroup(s),this.showGroup(s)},async excludeBoardRecipientsInGroup(e){e.users.filter(t=>this.recipientUserIds.includes(t.id)).forEach(t=>{this.excluded[t.id]=e.id})},async getGroup(e){try{return(await X.get(`/api/groups/${e}`)).data.data}catch(t){return console.error(t),ie(z(t)),null}},async loadRecentInvitees(){try{const e=await X.get(`/api/user/recent-invitees?invite_type=email&board_id=${this.boardId}`);this.recentInvitees=e.data.data}catch(e){console.error(e)}},handleImportEmails(e){this.invitees=this.invitees.concat(e.map(t=>({id:null,userId:null,email:t,firstName:null,lastName:null})))},handleRecentInviteeClicked(e){const t=Array.isArray(e)?e:[e];t.length===1?F.boardInvitesPreviousContributorAddClicked():F.boardInvitesAllPreviousContributorsButtonClicked(),this.invitees=this.invitees.concat(t.map(n=>({id:n.id,userId:n.user_id,email:n.email,firstName:n.name||null,lastName:null})))},async handleInviteeClicked(e){if(!e.groupId)return;const t=await this.getGroup(e.groupId);this.showGroup(t)},showGroup(e){F.boardInviteGroupClicked(),this.storeCurrentData(),this.$store.commit("setTargetInviteGroup",e),this.$router.replace({name:"group-invited"})},async handleSendInvites(){this.error=null;try{if(this.invitedRecipients=await this.getInvitedRecipients(),this.hasInvitedRecipients){this.isShowingInviteRecipientsModal=!0,this.confirmedInviteRecipientsCallback=this.sendInvites;return}this.sendInvites()}catch(e){console.error(e),this.error=z(e)}},async sendInvites(){this.isLoading=!0;try{await this.$store.dispatch("sendInvites",{guestIds:this.inviteeGuestIds,emails:this.inviteeEmails,userIds:this.inviteeUserIds,groupIds:this.inviteeGroupIds,excludedUserIds:Object.keys(this.excluded),message:this.message,cc:this.cc,captcha:this.captchaResponse}),x("Your invites were sent!"),this.recentInvitees=[],this.invitees=[],!this.isConsumer&&this.loadRecentInvitees(),this.$refs.emails.reset(),this.resetCaptcha(),F.boardInviteSent()}catch(e){if(console.error(e),e.response.status===418){P.emitter.once("email-was-verified",this.sendInvites),this.showEmailVerification(null,"invite");return}this.error=z(e),this.resetCaptcha()}finally{this.isLoading=!1,this.confirmedInviteRecipientsCallback=null}},resetCaptcha(){this.captchaResponse=null,this.$refs.captcha.reset()},handleConfirmInvitingRecipients(){this.isShowingInviteRecipientsModal=!1,this.confirmedInviteRecipientsCallback()},handleCancelForceInviteRecipient(){this.isShowingInviteRecipientsModal=!1,this.$refs.captcha.reset()},async getInvitedRecipients(){return(await this.$store.dispatch("checkForInvitedRecipients",{emails:this.inviteeEmails,userIds:this.inviteeUserIds,groupIds:this.inviteeGroupIds,excludedUserIds:Object.keys(this.excluded)})).data.data.invited_recipients},handleEditInviteDelivery(){this.$router.replace({name:"schedule-invite",params:{inviteMethod:"email"}})},areArrayEqual(e,t){return JSON.stringify(e.slice().sort((n,p)=>n.id-p.id))===JSON.stringify(t.slice().sort((n,p)=>n.id-p.id))}}},Ul={class:"tw-mt-2 tw-relative"},Al={class:"tw-mb-4"},xl={class:"tw-text-lg tw-font-semibold tw-mb-2"},Nl={key:0},Gl={class:"tw-mb-3"},Ol={class:"tw-text-lg tw-font-semibold tw-mb-2"},Pl={class:"tw-mb-5"},Ll={class:"tw-flex"},Vl=["disabled"];function zl(e,t,n,p,s,i){const c=o("contributor-count"),u=o("scheduled-invite"),h=o("multiple-email-input"),b=o("recent-invitees-picker"),y=o("icon"),S=o("groups-lander-modal"),I=o("textarea-input"),k=o("toggle-button-setting"),_=o("settings-container"),$=o("vue-recaptcha"),R=o("option-menu-item"),L=o("expandable-button"),M=o("email-preview-link"),V=o("input-error"),Q=o("invite-recipient-modal"),ee=o("teleport-wrapper");return l(),v("div",Ul,[e.permissions.canEditBoard?(l(),g(c,{key:0,count:e.contributorCount,"current-tab":"email",class:"tw-mb-4"},null,8,["count"])):f("",!0),i.hasPendingScheduledInvite?(l(),g(u,{key:1,"invite-date":e.scheduledEmailInviteDate,"invite-id":e.scheduledEmailInvite.id,"invite-offset":e.scheduledEmailInviteOffset,"invite-timezone":e.scheduledEmailInviteTimezone,"invite-method":"email",invitees:s.invitees,"cc-invitees":e.ccInvitees,"remind-invitees":e.remindInvitees,"preview-url":i.previewUrl},null,8,["invite-date","invite-id","invite-offset","invite-timezone","invitees","cc-invitees","remind-invitees","preview-url"])):(l(),v(E,{key:2},[a("div",Al,[a("div",xl,[t[6]||(t[6]=m(" Add contributor email")),e.canAccessGroups?(l(),v("span",Nl,", group")):f("",!0),t[7]||(t[7]=m(", or paste a list "))]),d(h,{ref:"emails","model-value":s.invitees,"autocomplete-url":i.autocompleteUrl,"show-names":!e.isConsumer,placeholder:"Use a comma to separate emails","onUpdate:modelValue":i.handleInput,onClick:i.handleInviteeClicked},null,8,["model-value","autocomplete-url","show-names","onUpdate:modelValue","onClick"]),s.recentInvitees.length?(l(),g(b,{key:0,"recent-invitees":s.recentInvitees,"remaining-recent-invitees":i.remainingRecentInvitees,onSelected:i.handleRecentInviteeClicked},null,8,["recent-invitees","remaining-recent-invitees","onSelected"])):f("",!0),e.isAdmin?(l(),g(S,{key:1,"can-access-groups":e.canAccessGroups,class:"add-button"},{default:r(()=>[d(y,{fill:"",type:"plus-circle"}),t[8]||(t[8]=a("span",null," Add a group ",-1))]),_:1},8,["can-access-groups"])):f("",!0)]),a("div",Gl,[a("div",Ol,C(e.isScheduled?"Shared added context with contributors":"Share context or a deadline for contributors"),1),e.canUpdateEmailContent?(l(),g(I,{key:0,modelValue:s.message,"onUpdate:modelValue":t[0]||(t[0]=G=>s.message=G),class:"tw-h-[128px] tw-input-md",placeholder:"Optional message"},null,8,["modelValue"])):f("",!0)]),e.permissions.canEditBoard?(l(),g(_,{key:0},{default:r(()=>[d(k,{"tooltip-content":"Contributors see each other's email addresses (works well if the group knows each other).","model-value":s.cc,"sr-text":"Toggle cc contributors","onUpdate:modelValue":t[1]||(t[1]=G=>s.cc=G)},{default:r(()=>t[9]||(t[9]=[m(" CC contributors on invitation ")])),_:1},8,["model-value"]),i.isNotShoutOutBoardOrEventBoard?(l(),g(k,{key:0,"tooltip-content":"Contributors who have not posted will receive a reminder 24 hours before scheduled delivery.","model-value":e.remindInvitees,disabled:!e.permissions.canEditBoard,"sr-text":"Toggle send reminder email","onUpdate:modelValue":t[2]||(t[2]=G=>e.$store.dispatch("setRemindInvitees",G))},{default:r(()=>t[10]||(t[10]=[m(" Send reminder email ")])),_:1},8,["model-value","disabled"])):f("",!0)]),_:1})):f("",!0),a("div",Pl,[d($,{ref:"captcha",sitekey:s.RECAPTCHA_SITE_KEY,"load-recaptcha-script":!0,onVerify:t[3]||(t[3]=G=>s.captchaResponse=G)},null,8,["sitekey"])]),a("div",Ll,[!i.hasPendingScheduledInvite&&!e.isConsumer?(l(),g(L,{key:0,ref:"expandableButton","button-classes":"btn-p-lg btn-p-primary",disabled:!s.invitees.length,class:"tw-inline-flex js-send",onPrimaryButtonClicked:i.handleSendInvites},{"primary-button":r(()=>t[11]||(t[11]=[a("span",null," Send invites ",-1)])),"menu-button":r(()=>[d(y,{type:"chevron-right",fill:"",class:"drowndown-icon"})]),"menu-items":r(()=>[d(R,null,{default:r(()=>[a("button",{onClick:t[4]||(t[4]=(...G)=>i.handleShowScheduleInvites&&i.handleShowScheduleInvites(...G))},[d(y,{type:"send",fill:""}),t[12]||(t[12]=m(" Schedule send "))])]),_:1})]),_:1},8,["disabled","onPrimaryButtonClicked"])):i.hasPendingScheduledInvite?f("",!0):(l(),v("button",{key:1,class:"btn-p-lg btn-p-primary tw-mr-4 js-send",disabled:!s.invitees.length,onClick:t[5]||(t[5]=(...G)=>i.handleSendInvites&&i.handleSendInvites(...G))}," Send invites ",8,Vl)),d(M,{url:i.previewUrl,class:"tw-ml-3"},null,8,["url"])]),d(V,{error:s.error},null,8,["error"]),d(ee,{to:"#modals"},{default:r(()=>[s.isShowingInviteRecipientsModal?(l(),g(Q,{key:0,recipients:s.invitedRecipients,onClose:i.handleCancelForceInviteRecipient,onInvite:i.handleConfirmInvitingRecipients},null,8,["recipients","onClose","onInvite"])):f("",!0)]),_:1})],64))])}const Fl=w(Bl,[["render",zl],["__scopeId","data-v-11cc269d"]]),ql={props:{boardQrUrl:{type:String,required:!0},boardQrDownloadUrl:{type:String,required:!0}}},Yl={class:"tw-mb-4"},Hl={class:"tw-flex tw-flex-col tw-items-center"},jl=["src"],Wl=["href"];function Kl(e,t,n,p,s,i){return l(),v("div",Yl,[t[0]||(t[0]=a("div",{class:"tw-text-lg tw-text-gray-90 tw-mb-6"}," Great for in-person uses or if you plan to print the Kudoboard invitation ",-1)),a("div",Hl,[a("img",{src:n.boardQrUrl,class:"tw-w-[200px] tw-h-[200px] tw-mb-4"},null,8,jl),a("a",{class:"copy-btn",href:n.boardQrDownloadUrl,target:"_blank"}," Download ",8,Wl)])])}const Ql=w(ql,[["render",Kl],["__scopeId","data-v-a4e1389c"]]),Jl={},Xl={class:"card"},Zl={class:"heading"},ed={class:"tw-text-gray-90 tw-text-lg tw-font-normal"};function td(e,t){return l(),v("div",Xl,[a("div",Zl,[D(e.$slots,"heading",{},void 0,!0)]),a("div",ed,[D(e.$slots,"default",{},void 0,!0)])])}const id=w(Jl,[["render",td],["__scopeId","data-v-eff156c1"]]),nd={components:{Card:id,Icon:U},mixins:[Ye],props:{featureFlags:{type:Object,default:()=>{}}},computed:{...B(["isP2PBoard","isEventBoard"]),...T({hasMentions:e=>e.board.has_mentions}),showInactivityReminderTip(){return this.isP2PBoard||this.isEventBoard}}},sd={class:"tw-text-left"},rd={class:"tw-flex tw-flex-col tw-gap-y-4"};function od(e,t,n,p,s,i){const c=o("icon"),u=o("card");return l(),v("div",sd,[t[10]||(t[10]=a("div",{class:"tw-text-lg tw-text-gray-90 tw-font-normal tw-mb-6"}," First, a few tips to help you get a good response from the people you invite... ",-1)),a("div",rd,[d(u,null,{heading:r(()=>[d(c,{fill:"",type:"image"}),t[0]||(t[0]=a("span",null," Add pictures and videos ",-1))]),default:r(()=>[t[1]||(t[1]=m(" Boards with media added before the invite goes out get a higher response rate and the highest quality posts from contributors. "))]),_:1}),i.showInactivityReminderTip?(l(),g(u,{key:0},{heading:r(()=>[d(c,{fill:"",type:"clock"}),t[2]||(t[2]=a("span",null," Set inactivity reminders ",-1))]),default:r(()=>[t[3]||(t[3]=m(" Set an email reminder and nudge board contributors to recognize great work by coworkers and friends. "))]),_:1})):f("",!0),e.hasMentions&&!i.showInactivityReminderTip?(l(),g(u,{key:1},{heading:r(()=>[d(c,{fill:"",type:"clock"}),t[4]||(t[4]=a("span",null," Consider a deadline ",-1))]),default:r(()=>[t[5]||(t[5]=m(" If there is a deadline to contribute, set it from the Kudoboard before sending out invites. You can always change the deadline later. "))]),_:1})):f("",!0),!e.hasMentions&&!i.showInactivityReminderTip?(l(),g(u,{key:2},{heading:r(()=>[d(c,{fill:"",type:"clock"}),t[6]||(t[6]=a("span",null," Set a deadline ",-1))]),default:r(()=>[t[7]||(t[7]=m(" Boards with a clear-cut deadline get people to act. ")),e.can(e.Permissions.EDIT_BOARD)?(l(),v(E,{key:0},[m(" Before you send invites, schedule a tentative delivery time (you can always change this later). ")],64)):(l(),v(E,{key:1},[m(" Make sure that you give people a timeline so that they know when to get their posts submitted. ")],64))]),_:1})):f("",!0),d(u,null,{heading:r(()=>[d(c,{fill:"",type:"chart"}),t[8]||(t[8]=a("span",null," Build momentum early ",-1))]),default:r(()=>[t[9]||(t[9]=m(" After sending invites, reach out to a few contributors to ask them to post early — boards with early momentum get better response rates. "))]),_:1})])])}const ad=w(nd,[["render",od]]),ld={components:{CopyButton:Ke,Icon:U,TextInput:be},data(){return{clipboard:null,isCopied:!1}},computed:{...T({boardUrl:e=>e.board.url})},methods:{handleCopied(){x("The link has been copied to your clipboard."),F.boardInviteLinkCopied()},handleCopyFailed(){ie("There was a problem copying the link to your clipboard.")}}},dd={class:"tw-flex tw-flex-col tw-items-start tw-gap-y-2 tw-mt-2"},ud={class:"tw-flex tw-flex-col tw-gap-y-2 tw-w-full"};function cd(e,t,n,p,s,i){const c=o("text-input"),u=o("copy-button"),h=o("icon");return l(),v("div",dd,[a("div",ud,[t[3]||(t[3]=a("div",{class:"tw-font-semibold tw-text-lg"}," Copy link below & send it to your invitees ",-1)),d(c,{"model-value":e.boardUrl,"aria-label":"board link",readonly:"",class:"tw-cursor-pointer tw-input-md",onClick:t[0]||(t[0]=b=>e.$refs.copyButton.$el.click())},null,8,["model-value"]),d(u,{ref:"copyButton",text:e.boardUrl,class:"btn-p btn-p-primary tw-w-full copy-link-button",onCopied:i.handleCopied,onError:i.handleCopyFailed},{default:r(()=>t[2]||(t[2]=[m(" Copy Link ")])),_:1},8,["text","onCopied","onError"])]),a("button",{class:"btn-p-link tw-flex tw-items-center",onClick:t[1]||(t[1]=b=>e.$emit("show-instructions"))},[t[4]||(t[4]=a("span",{class:"tw-text-base"}," See tips on organizing great boards ",-1)),d(h,{fill:"",type:"chevron-right",class:"tw-text-sm tw-text-brand tw-ml-1"})])])}const md=w(ld,[["render",cd],["__scopeId","data-v-3a1d8561"]]),pd={components:{ContributorCount:Ft,InputError:K,ExpandableButton:zt,MessagingAutocomplete:Re,MultipleMessagingInput:Pt,RecentInviteesPicker:qt,ScheduledInvite:Yt,VueRecaptcha:et,Icon:U,OptionMenuItem:le,Selector:Ze,TextareaInput:$e},mixins:[de],props:{inviteMethod:{type:String,required:!0}},data(){return{RECAPTCHA_SITE_KEY:Xe,captchaResponse:null,error:null,isLoading:!1,invitees:[],message:"",recentInvitees:[],inviteType:"dm",channel:null,channelName:"",inviteTypeOptions:[{text:"Invite via direct message",value:"dm"},{text:"Invite in channel",value:"pm"}]}},computed:{canSend(){var e,t,n,p,s;return!(this.inviteType==="dm"&&((e=this.invitees)==null?void 0:e.length)===0||this.inviteType==="pm"&&this.inviteMethod.toLowerCase()==="slack"&&((n=(t=this.channel)==null?void 0:t.slack_channel_name)==null?void 0:n.length)===0||this.inviteType==="pm"&&this.inviteMethod.toLowerCase()==="teams"&&((s=(p=this.channel)==null?void 0:p.teams_channel_name)==null?void 0:s.length)===0)},inviteMethodName(){return this.inviteMethod==="slack"?"Slack":"Microsoft Teams"},autocompleteUrl(){return this.isConsumer?null:this.inviteType==="dm"?"/api/messaging/autocomplete/search?type=users&query=":"/api/messaging/autocomplete/search?type=users+usergroups&query="},inviteeUsers(){return this.invitees.filter(e=>e.userId).map(e=>{const t={};return t[`${this.inviteMethod}_user_id`]=e.userId,t[`${this.inviteMethod}_real_name`]=e.realName,t[`${this.inviteMethod}_user_name`]=e.userName,t})},inviteeUserIds(){return this.invitees.filter(e=>e.userId).map(e=>e.userId)},remainingRecentInvitees(){return this.recentInvitees.filter(e=>!this.inviteeUserIds.includes(e[`${this.inviteMethod}_user_id`]))},usernamesPlaceholder(){let e="";return this.inviteType==="dm"?e=`${this.inviteMethodName} users to invite`:this.inviteMethod==="slack"?e="Slack users or user groups to tag (optional)":this.inviteMethod==="teams"&&(e="Microsoft Teams users to tag (optional)"),e},hasPendingScheduledInvite(){return!!this.scheduledMessagingInvite&&!this.scheduledMessagingInvite.invited_at},isFormDirty(){return this.message.trim()!==this.inviteMessage.trim()||this.channel!==this.messagingChannel||!this.areArrayEqual(this.invitees,this.messagingInvitees)},...T(["googleApiKey","googleClientId","isConsumer","permissions","board"]),...T({boardId:e=>e.board.public_id,contributorCount:e=>e.invites.contributorCount,isScheduled:e=>!!e.board.delivery_date,inviteMessage:e=>e.invites.message,messagingInvitees:e=>e.invites.messagingInvitees,messagingChannel:e=>e.invites.messagingChannel,remindInvitees:e=>e.board.remind_invitees,scheduledMessagingInviteDate:e=>e.invites.scheduledMessagingInviteDate,scheduledMessagingInviteTimezone:e=>e.invites.scheduledMessagingInviteTimezone,scheduledMessagingInviteOffset:e=>e.invites.scheduledMessagingInviteOffset}),...B(["isDemoBoard","scheduledMessagingInvite"])},watch:{inviteMessage:{immediate:!0,handler(e){this.message=e.trim()}},messagingInvitees:{immediate:!0,handler(e){e&&e.length&&(this.invitees=e)}},messagingChannel:{immediate:!0,handler(e){this.channel=e,this.inviteType=e?"pm":"dm",this.channelName=e?e.slack_channel_name||e.teams_channel_name:""}},inviteType(){this.channel=null},channel:{deep:!0,handler(e){this.channelName=e?e.slack_channel_name||e.teams_channel_name:""}}},mounted(){this.isDemoBoard||(this.$store.dispatch("loadContributorCount"),!this.isConsumer&&this.loadRecentInvitees())},beforeUnmount(){this.storeCurrentData()},methods:{storeCurrentData(){this.$store.commit("setInviteMessage",this.message),this.$store.commit("setMessagingInvitees",this.invitees),this.$store.commit("setMessagingChannel",this.channel)},handleShowScheduleInvites(){this.$refs.expandableButton.close(),this.isScheduledInviteValid&&this.$router.replace({name:"schedule-invite",params:{inviteMethod:this.inviteMethod}})},async loadRecentInvitees(){try{const e=await X.get(`/api/user/recent-invitees?invite_type=${this.inviteMethod}&board_id=${this.boardId}`);this.recentInvitees=e.data.data}catch(e){console.error(e)}},handleRecentInviteeClicked(e){const t=Array.isArray(e)?e:[e];this.invitees=this.invitees.concat(t.map(n=>({userId:n[`${this.inviteMethod}_user_id`],realName:n[`${this.inviteMethod}_real_name`],userName:n[`${this.inviteMethod}_user_name`]})))},async handleSendInvites(){this.isLoading=!0,this.error=null;try{const e={message:this.message,captcha:this.captchaResponse,channel:this.channel||{}};e[`${this.inviteMethod}Users`]=this.inviteeUsers,await this.$store.dispatch("sendInvites",e),x("Your invites were sent!"),this.recentInvitees=[],this.invitees=[],!this.isConsumer&&this.loadRecentInvitees(),this.resetCaptcha(),F.boardInviteSent()}catch(e){if(console.error(e),e.response.status===418){P.emitter.once("email-was-verified",this.handleSendInvites),this.showEmailVerification(null,"invite");return}this.error=z(e),this.resetCaptcha()}finally{this.isLoading=!1}},resetCaptcha(){this.captchaResponse=null,this.$refs.captcha.reset()},handleChannelAutoComplete(e){this.channel={},this.channel[`${this.inviteMethod}_channel_id`]=e.id,this.channel[`${this.inviteMethod}_channel_name`]=e.name,e.real_name?this.channel[`${this.inviteMethod}_channel_real_name`]=e.real_name:this.channel[`${this.inviteMethod}_channel_real_name`]=null},isScheduledInviteValid(){return this.error=null,this.invitees.length?!0:(this.error="A user is required for scheduled invites",!1)},handleEditInviteDelivery(){this.$router.replace({name:"schedule-invite",params:{inviteMethod:this.inviteMethod}})},areArrayEqual(e,t){return JSON.stringify(e.slice().sort((n,p)=>n.id-p.id))===JSON.stringify(t.slice().sort((n,p)=>n.id-p.id))}}},hd={class:"tw-mb-4"},vd={ref:"channelContainer",class:"margin-bottom-sm"},gd={key:1,class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"},fd={class:"tw-mb-4"},bd={class:"tw-text-lg tw-font-semibold tw-mb-2"},yd={class:"tw-mb-5"},_d={class:"tw-flex"},wd=["disabled"];function kd(e,t,n,p,s,i){const c=o("contributor-count"),u=o("scheduled-invite"),h=o("selector"),b=o("messaging-autocomplete"),y=o("multiple-messaging-input"),S=o("recent-invitees-picker"),I=o("textarea-input"),k=o("vue-recaptcha"),_=o("icon"),$=o("option-menu-item"),R=o("expandable-button"),L=o("input-error");return l(),v("div",null,[e.permissions.canEditBoard?(l(),g(c,{key:0,count:e.contributorCount,"current-tab":n.inviteMethod,class:"tw-mb-4"},null,8,["count","current-tab"])):f("",!0),i.hasPendingScheduledInvite?(l(),g(u,{key:1,"channel-name":s.channelName,"invite-date":e.scheduledMessagingInviteDate,"invite-id":e.scheduledMessagingInvite.id,"invite-offset":e.scheduledMessagingInviteOffset,"invite-timezone":e.scheduledMessagingInviteTimezone,"invite-method":n.inviteMethod,invitees:e.messagingInvitees,"show-cc":!1,"show-reminder-email":!1},null,8,["channel-name","invite-date","invite-id","invite-offset","invite-timezone","invite-method","invitees"])):(l(),v(E,{key:2},[a("div",hd,[t[9]||(t[9]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Invite method ",-1)),d(h,{modelValue:s.inviteType,"onUpdate:modelValue":t[0]||(t[0]=M=>s.inviteType=M),class:"tw-mb-4",options:s.inviteTypeOptions},null,8,["modelValue","options"]),s.inviteType==="pm"?(l(),v(E,{key:0},[t[8]||(t[8]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Invitee details ",-1)),a("div",vd,[d(b,{modelValue:s.channelName,"onUpdate:modelValue":t[1]||(t[1]=M=>s.channelName=M),url:"/api/messaging/autocomplete/search?type=channels&",placeholder:"Channel name",class:"tw-mb-2",onSelected:i.handleChannelAutoComplete},null,8,["modelValue","onSelected"])],512)],64)):(l(),v("div",gd," Invitee(s) ")),d(y,{ref:"usernames",modelValue:s.invitees,"onUpdate:modelValue":t[2]||(t[2]=M=>s.invitees=M),"autocomplete-url":i.autocompleteUrl,"show-names":!e.isConsumer,placeholder:i.usernamesPlaceholder,class:"multiple-input"},null,8,["modelValue","autocomplete-url","show-names","placeholder"]),!e.isConsumer&&s.recentInvitees.length?(l(),g(S,{key:2,"recent-invitees":s.recentInvitees,"remaining-recent-invitees":i.remainingRecentInvitees,onSelected:i.handleRecentInviteeClicked},null,8,["recent-invitees","remaining-recent-invitees","onSelected"])):f("",!0)]),a("div",fd,[a("div",bd,C(e.isScheduled?"Shared added context with contributors":"Share context or a deadline for contributors"),1),d(I,{modelValue:s.message,"onUpdate:modelValue":t[3]||(t[3]=M=>s.message=M),class:"tw-h-[128px] tw-input-md",placeholder:"Optional message"},null,8,["modelValue"])]),a("div",yd,[d(k,{ref:"captcha",sitekey:s.RECAPTCHA_SITE_KEY,"load-recaptcha-script":!0,onVerify:t[4]||(t[4]=M=>s.captchaResponse=M)},null,8,["sitekey"])]),a("div",_d,[!i.hasPendingScheduledInvite&&!e.isConsumer?(l(),g(R,{key:0,ref:"expandableButton","button-classes":"btn-p-lg btn-p-primary",disabled:!i.canSend,class:"tw-mr-2 tw-inline-flex js-send",onPrimaryButtonClicked:t[6]||(t[6]=M=>i.handleSendInvites(!1))},{"primary-button":r(()=>t[10]||(t[10]=[a("span",{class:"js-send"}," Send invites ",-1)])),"menu-button":r(()=>[d(_,{type:"chevron-right",fill:"",class:"drowndown-icon"})]),"menu-items":r(()=>[d($,null,{default:r(()=>[a("button",{onClick:t[5]||(t[5]=(...M)=>i.handleShowScheduleInvites&&i.handleShowScheduleInvites(...M))},[d(_,{type:"send",fill:""}),t[11]||(t[11]=m(" Schedule send "))])]),_:1})]),_:1},8,["disabled"])):i.hasPendingScheduledInvite?f("",!0):(l(),v("button",{key:1,class:"btn-p-lg btn-p-primary tw-mr-4 js-send",disabled:!s.invitees.length,onClick:t[7]||(t[7]=M=>i.handleSendInvites(!1))}," Send invites ",8,wd))]),d(L,{error:s.error},null,8,["error"])],64))])}const Cd=w(pd,[["render",kd],["__scopeId","data-v-bb209125"]]),Sd={components:{Icon:U},props:{facebookShareLink:{type:String,required:!0},whatsAppShareLink:{type:String,required:!0},linkedinShareLink:{type:String,required:!0}}},Id={class:"tw-pb-3"},Td={class:"tw-flex tw-gap-x-2"},Ed=["href"],Dd=["href"],Rd=["href"];function Md(e,t,n,p,s,i){const c=o("icon");return l(),v("div",Id,[t[3]||(t[3]=a("div",{class:"tw-text-lg tw-text-gray-90 tw-mb-5"}," Perfect for boards that you want to make public ",-1)),a("div",Td,[a("a",{href:n.facebookShareLink,target:"_blank",rel:"noopener noreferrer",class:"btn-social-share"},[d(c,{type:"facebook",fill:"#1877F2"}),t[0]||(t[0]=a("span",null," Facebook ",-1))],8,Ed),a("a",{href:n.whatsAppShareLink,target:"_blank",rel:"noopener noreferrer",class:"btn-social-share"},[d(c,{type:"whatsapp",fill:"#25D366"}),t[1]||(t[1]=a("span",null," WhatsApp ",-1))],8,Dd),a("a",{href:n.linkedinShareLink,target:"_blank",rel:"noopener noreferrer",class:"btn-social-share"},[d(c,{type:"linkedin",fill:"#0A66C2"}),t[2]||(t[2]=a("span",null," Linkedin ",-1))],8,Rd)])])}const $d=w(Sd,[["render",Md],["__scopeId","data-v-46f775f6"]]),Bd={components:{Container:q,DemoBoardOverlay:Lt,InvitesEmail:Fl,InvitesInstructions:ad,InvitesLink:md,InvitesMessaging:Cd,InvitesMessagingIntegrationUpsell:Vt,InvitesSocial:$d,Tab:Ee,Tabs:De,InvitesQrCode:Ql,LoadingArea:Me},mixins:[Qe],props:{featureFlags:{type:Object,default:()=>{}},incomingTab:{type:String,default:"link"}},data(){return{isShowingInstructions:!1,isShowingEmailTab:!1,defaultToEmail:!1,slackInvitees:[],teamsInvitees:[],isLoading:!1}},computed:{showDemoBoardOverlay(){return this.isDemoBoard&&!this.isStarter&&this.isShowingEmailTab},whatsAppShareLink(){return this.isMobileSize?this.whatsAppShareLinkMobile:this.whatsAppShareLinkDesktop},...B(["boardQrUrl","boardQrDownloadUrl","facebookShareLink","whatsAppShareLinkDesktop","whatsAppShareLinkMobile","linkedinShareLink","isDemoBoard","isStarter"]),...T(["board","showMessagingIntegrationsUpsell"]),...T({invitePermissions:e=>e.invites.invitePermissions})},beforeMount(){this.setDefaultTab()},async mounted(){this.isLoading=!0;try{const e=await X.get(`/api/boards/${this.board.public_id}/invite-contributors`),{data:t}=e.data;this.$store.commit("setInviteMessage",t.additional_info),this.$store.commit("setInvitePermissions",t.permissions),t.scheduled_invites&&this.$store.dispatch("setScheduledInvites",t.scheduled_invites)}catch(e){console.error(e)}finally{this.isLoading=!1}this.isShowingInstructions=!1,this.isShowingInstructions&&this.$store.commit("stopShowingInviteInstructions")},methods:{setDefaultTab(){const t=new URLSearchParams(window.location.search).get("tab")||this.incomingTab;t&&(this.defaultToEmail=t==="email")}}},Ud={key:0,class:"drawer-container__footer"};function Ad(e,t,n,p,s,i){const c=o("demo-board-overlay"),u=o("invites-instructions"),h=o("invites-link"),b=o("tab"),y=o("invites-email"),S=o("invites-messaging"),I=o("invites-messaging-integration-upsell"),k=o("invites-social"),_=o("invites-qr-code"),$=o("tabs"),R=o("loading-area"),L=o("container");return l(),g(L,null,{header:r(()=>t[5]||(t[5]=[m(" Invite contributors ")])),default:r(()=>[d(R,{"use-if":!0,loading:s.isLoading},{default:r(()=>[i.showDemoBoardOverlay?(l(),g(c,{key:0,"board-id":e.board.public_id,"can-apply-package-credit":e.canApplyPackageCredit,"track-context":"contributor-email-settings",class:"tw-absolute tw-right-0 tw-left-0 tw-top-0 tw-pt-[170px] md:tw-pt-[115px]"},{heading:r(()=>t[6]||(t[6]=[m(" Upgrade to send invites ")])),subheading:r(()=>t[7]||(t[7]=[m(" Or copy the link & send manually ")])),_:1},8,["board-id","can-apply-package-credit"])):f("",!0),a("div",null,[s.isShowingInstructions?(l(),v(E,{key:0},[d(u,{"feature-flags":n.featureFlags,onHide:t[0]||(t[0]=M=>s.isShowingInstructions=!1)},null,8,["feature-flags"]),s.isShowingInstructions?(l(),v("div",Ud,[a("button",{class:"btn-p-lg btn-p-primary",onClick:t[1]||(t[1]=M=>s.isShowingInstructions=!1)}," Continue to Invite ")])):f("",!0)],64)):f("",!0),Y(d($,{class:W(["invite-tabs",{"invite-tabs__demo-board-overlay":i.showDemoBoardOverlay}]),"update-location":!1},{default:r(()=>[d(b,{id:"link",order:1,title:"Link"},{default:r(()=>[d(h,{onShowInstructions:t[2]||(t[2]=M=>s.isShowingInstructions=!0)})]),_:1}),e.invitePermissions.allow_invites?(l(),v(E,{key:0},[d(b,{id:"email",order:2,"remove-when-hidden":!0,title:"Email",active:s.defaultToEmail,onShown:t[3]||(t[3]=M=>s.isShowingEmailTab=!0),onHidden:t[4]||(t[4]=M=>s.isShowingEmailTab=!1)},{default:r(()=>[d(y,{"feature-flags":n.featureFlags},null,8,["feature-flags"])]),_:1},8,["active"]),e.invitePermissions.allow_slack_invites?(l(),g(b,{key:0,id:"slack",order:3,"remove-when-hidden":!0,title:"Slack",active:n.incomingTab==="slack",class:"tw-mt-3"},{default:r(()=>[d(S,{"invite-method":"slack"})]),_:1},8,["active"])):f("",!0),e.invitePermissions.allow_teams_invites?(l(),g(b,{key:1,id:"teams",order:4,"remove-when-hidden":!0,title:"MS Teams",active:n.incomingTab==="teams",class:"tw-mt-3"},{default:r(()=>[d(S,{"invite-method":"teams"})]),_:1},8,["active"])):f("",!0)],64)):f("",!0),e.showMessagingIntegrationsUpsell?(l(),g(b,{key:1,id:"messaging-integration-upsell",order:5,title:"Slack/Teams",class:"tw-mt-3"},{default:r(()=>[d(I)]),_:1})):f("",!0),e.invitePermissions.allow_social_sharing?(l(),g(b,{key:2,id:"social",order:6,title:"Social",class:"tw-mt-3"},{default:r(()=>[d(k,{"facebook-share-link":e.facebookShareLink,"whats-app-share-link":i.whatsAppShareLink,"linkedin-share-link":e.linkedinShareLink},null,8,["facebook-share-link","whats-app-share-link","linkedin-share-link"])]),_:1})):f("",!0),d(b,{id:"qr-code",order:7,title:"QR Code",class:"tw-mt-3"},{default:r(()=>[d(_,{"board-qr-url":e.boardQrUrl,"board-qr-download-url":e.boardQrDownloadUrl},null,8,["board-qr-url","board-qr-download-url"])]),_:1})]),_:1},8,["class"]),[[j,!s.isShowingInstructions]])])]),_:1},8,["loading"])]),_:1})}const xd=w(Bd,[["render",Ad],["__scopeId","data-v-48e1ae3f"]]),Ht="YYYY-MM-DD",Nd="h:mm A",ft=`${Ht} ${Nd}`,Gd="MMMM D, YYYY",Od="H:mm",Pd=0,Ld={components:{DatePicker:Tt,InputError:K,TimeSelect:Qi,TimezoneSelect:Ki},props:{deliveryDate:{type:String,default:null},deliveryTimezone:{type:String,default:null},deliveryDateError:{type:String,default:null},deliveryTimeError:{type:String,default:null}},data(){return{editDeliveryDate:"",editDeliveryTime:"",editDeliveryTimezone:"",startDate:A().add(Pd,"days").toDate(),isLoading:!1}},computed:{datepickerPlaceholder(){return this.deliveryDate?A(this.deliveryDate,Ht).format("L"):"MM/DD/YYYY"}},watch:{deliveryDate:{immediate:!0,handler(e){this.editDeliveryDate=e?A(e,ft).format(Gd):"",this.$emit("update-delivery-date",this.editDeliveryDate),this.editDeliveryTime=e?A(e,ft).format(Od):"9:00",this.$emit("update-delivery-time",this.editDeliveryTime)}},deliveryTimezone:{immediate:!0,handler(e){this.editDeliveryTimezone=e||"America/New_York",this.$emit("update-delivery-timezone",this.editDeliveryTimezone)}}},methods:{async handleSetNewDefaultTimezone(){await this.$store.dispatch("updateDefaultTimezone",this.editDeliveryTimezone)&&this.$store.commit("updateDefaultTimezone",this.editDeliveryTimezone)},updateDeliveryDate(e){this.editDeliveryDate=e,this.$emit("update-delivery-date",e)}}},Vd={class:"tw-flex tw-gap-x-2"},zd={class:"tw-w-[200px]"};function Fd(e,t,n,p,s,i){const c=o("date-picker"),u=o("input-error"),h=o("time-select"),b=o("timezone-select");return l(),v("div",null,[D(e.$slots,"default",{},void 0,!0),d(u,{error:n.deliveryDateError,class:"tw-mb-2"},{default:r(()=>[d(c,{"model-value":s.editDeliveryDate,"min-date":s.startDate,placeholder:i.datepickerPlaceholder,start:s.startDate,"onUpdate:modelValue":i.updateDeliveryDate},null,8,["model-value","min-date","placeholder","start","onUpdate:modelValue"])]),_:1},8,["error"]),d(u,{error:n.deliveryTimeError,class:"tw-mb-2"},{default:r(()=>[a("div",Vd,[a("div",zd,[d(h,{modelValue:s.editDeliveryTime,"onUpdate:modelValue":[t[0]||(t[0]=y=>s.editDeliveryTime=y),t[1]||(t[1]=y=>e.$emit("update-delivery-time",s.editDeliveryTime))],class:"time-select"},null,8,["modelValue"])]),d(b,{modelValue:s.editDeliveryTimezone,"onUpdate:modelValue":[t[2]||(t[2]=y=>s.editDeliveryTimezone=y),t[3]||(t[3]=y=>e.$emit("update-delivery-timezone",s.editDeliveryTimezone))]},null,8,["modelValue"])]),n.deliveryTimezone!==s.editDeliveryTimezone?(l(),v("button",{key:0,class:"btn-p-link tw-mt-1",onClick:t[4]||(t[4]=(...y)=>i.handleSetNewDefaultTimezone&&i.handleSetNewDefaultTimezone(...y))},[t[5]||(t[5]=m(" Make ")),a("b",null,C(s.editDeliveryTimezone),1),t[6]||(t[6]=m(" your default timezone "))])):f("",!0)]),_:1},8,["error"])])}const ot=w(Ld,[["render",Fd],["__scopeId","data-v-e44d9266"]]),jt="YYYY-MM-DD",Ne="h:mm A",bt=`${jt} ${Ne}`,Ge="MMMM D, YYYY",Oe="H:mm",qd=`${Ge} ${Oe}`,Yd={components:{Container:q,DeliveryDeadline:ot,InputError:K,LoadingButton:H,RadioInput:$t,VueRecaptcha:et},props:{inviteMethod:{type:String,required:!0}},data(){return{RECAPTCHA_SITE_KEY:Xe,captchaResponse:null,deliveryDateOptions:[{text:"One week before board delivery date",value:!0},{text:"Pick date & time",value:!1}],localInviteTimezone:"",localInviteTime:"",localInviteDate:"",isLoading:!1,useInviteOffset:!1,submitError:null,hasSavedInviteDetails:!1}},computed:{isSaveDisabled(){return this.useInviteOffset?!1:!this.localInviteDate},isBoardDeliveryWithinAWeek(){return this.boardDeliveryDate?A().add(7,"d").diff(A(this.boardDeliveryDate))>0:!1},isEmailInviteMethod(){return this.inviteMethod==="email"},inviteeEmails(){return this.emailIndividualInvitees.filter(e=>!e.userId&&!e.groupId&&!e.id).map(e=>e.email)},inviteeGroupIds(){return this.emailGroupInvitees.map(e=>e.groupId)},inviteeUserIds(){return this.emailIndividualInvitees.filter(e=>e.userId).map(e=>e.userId)},showOptions(){return this.isBoardDeliverable&&!this.isBoardDeliveryWithinAWeek},...T({ccInvitees:e=>e.board.cc_invitees,boardDeliveryDate:e=>e.board.delivery_date,emailIndividualInvitees:e=>e.invites.emailIndividualInvitees,emailGroupInvitees:e=>e.invites.emailGroupInvitees,scheduledEmailInviteDate:e=>e.invites.scheduledEmailInviteDate,scheduledEmailInviteTimezone:e=>e.invites.scheduledEmailInviteTimezone,emailExcludedGroupMembers:e=>e.invites.emailExcludedGroupMembers,message:e=>e.invites.message,messagingInvitees:e=>e.invites.messagingInvitees,messagingChannel:e=>e.invites.messagingChannel,scheduledMessagingInviteDate:e=>e.invites.scheduledMessagingInviteDate,scheduledMessagingInviteTimezone:e=>e.invites.scheduledMessagingInviteTimezone,scheduledMessagingInviteOffset:e=>e.invites.scheduledMessagingInviteOffset}),...B(["isBoardDeliverable"])},mounted(){this.setDataForInviteMethod()},beforeUnmount(){if(this.hasSavedInviteDetails)return;const e=this.localInviteDate?A(`${this.localInviteDate} ${this.localInviteTime}`,qd).format(bt):null,t=this.useInviteOffset?7:null;if(this.isEmailInviteMethod){this.$store.commit("setScheduledEmailInviteDate",e),this.$store.commit("setScheduledEmailInviteOffset",t),this.$store.commit("setScheduledEmailInviteTimezone",this.localInviteTimezone);return}this.$store.commit("setScheduledMessagingInviteDate",e),this.$store.commit("setScheduledMessagingInviteOffset",t),this.$store.commit("setScheduledMessagingInviteTimezone",this.localInviteTimezone)},methods:{updateDeliveryDate(e){this.localInviteDate=this.getFormattedInviteDate(e)},updateDeliveryTime(e){this.localInviteTime=this.getFormattedInviteTime(e)},setDataForInviteMethod(){this.isEmailInviteMethod?this.setDataForEmailInviteMethod():this.setDataForMessagingInviteMethod()},setDataForEmailInviteMethod(){this.localInviteDate=this.getFormattedInviteDate(this.scheduledEmailInviteDate),this.localInviteTime=this.getFormattedInviteTime(this.scheduledEmailInviteDate),this.localInviteTimezone=this.scheduledEmailInviteTimezone},setDataForMessagingInviteMethod(){this.localInviteDate=this.getFormattedInviteDate(this.scheduledMessagingInviteDate),this.localInviteTime=this.getFormattedInviteTime(this.scheduledMessagingInviteDate),this.localInviteTimezone=this.scheduledMessagingInviteTimezone},getFormattedInviteDate(e){return e?A(e,bt).format(Ge):""},getFormattedInviteTime(e){return e?A(e,Ne).format(Oe):"9:00"},async handleSave(){const e=this.getPayloadForInviteMethod();try{this.isLoading=!0,await this.$store.dispatch("scheduleInvites",e),x("Invitations scheduled"),F.scheduleInvitesSavedClicked(),this.hasSavedInviteDetails=!0,this.$router.replace({name:"invite-contributors",params:{incomingTab:this.inviteMethod}})}catch(t){console.error(t),this.submitError=z(t),this.resetCaptcha()}finally{this.isLoading=!1}},resetCaptcha(){this.captchaResponse=null,this.$refs.captcha.reset()},getPayloadForInviteMethod(){const e=this.isEmailInviteMethod?this.getEmailInvitePayload():this.getMessagingInvitePayload();return{...this.getSharedPayloadData(),...e}},getSharedPayloadData(){return{captcha:this.captchaResponse,cc:this.cc,inviteDate:this.useInviteOffset?null:A(this.localInviteDate,Ge).format(jt),inviteMethod:this.inviteMethod,inviteOffset:this.useInviteOffset?7:null,inviteTime:this.useInviteOffset?null:A(this.localInviteTime,Oe).format(Ne),inviteTimezone:this.localInviteTimezone,message:this.message}},getEmailInvitePayload(){return{emails:this.inviteeEmails,excludedUserIds:Object.keys(this.emailExcludedGroupMembers),groupIds:this.inviteeGroupIds,userIds:this.inviteeUserIds}},getMessagingInvitePayload(){const e={channel:this.messagingChannel||{}};return e[`${this.inviteMethod}Users`]=this.messagingInvitees.map(t=>{const n={};return n[`${this.inviteMethod}_user_id`]=t.userId,n[`${this.inviteMethod}_real_name`]=t.realName,n[`${this.inviteMethod}_user_name`]=t.userName,n}),e}}},Hd={key:1,class:"tw-text-lg tw-font-semibold tw-mb-2 tw-text-black"},jd={class:"tw-flex tw-items-center tw-mt-5"};function Wd(e,t,n,p,s,i){const c=o("radio-input"),u=o("delivery-deadline"),h=o("vue-recaptcha"),b=o("input-error"),y=o("loading-button"),S=o("container");return l(),g(S,{"back-callback":()=>e.$router.replace({name:"invite-contributors",params:{incomingTab:n.inviteMethod}})},{header:r(()=>[m(" Schedule invites via "+C(n.inviteMethod),1)]),default:r(()=>[t[5]||(t[5]=a("div",{class:"tw-mb-[10px] tw-text-lg"}," This is when users will be invited to contribute to the board. ",-1)),i.showOptions?(l(),g(c,{key:0,modelValue:s.useInviteOffset,"onUpdate:modelValue":t[0]||(t[0]=I=>s.useInviteOffset=I),options:s.deliveryDateOptions,class:"tw-mb-3"},null,8,["modelValue","options"])):(l(),v("div",Hd," Pick date & time ")),!i.showOptions||!s.useInviteOffset?(l(),g(u,{key:2,"delivery-date":i.isEmailInviteMethod?e.scheduledEmailInviteDate:e.scheduledMessagingInviteDate,"delivery-timezone":i.isEmailInviteMethod?e.scheduledEmailInviteTimezone:e.scheduledMessagingInviteTimezone,onUpdateDeliveryDate:i.updateDeliveryDate,onUpdateDeliveryTime:i.updateDeliveryTime,onUpdateDeliveryTimezone:t[1]||(t[1]=I=>s.localInviteTimezone=I)},null,8,["delivery-date","delivery-timezone","onUpdateDeliveryDate","onUpdateDeliveryTime"])):f("",!0),d(h,{ref:"captcha",sitekey:s.RECAPTCHA_SITE_KEY,"load-recaptcha-script":!0,onVerify:t[2]||(t[2]=I=>s.captchaResponse=I)},null,8,["sitekey"]),d(b,{error:s.submitError},null,8,["error"]),a("div",jd,[d(y,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button","is-loading":s.isLoading,disabled:i.isSaveDisabled,onClick:i.handleSave},{default:r(()=>t[4]||(t[4]=[m(" Save changes ")])),_:1},8,["is-loading","disabled","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[3]||(t[3]=I=>e.$router.replace({name:"invite-contributors",params:{incomingTab:n.inviteMethod}}))}," Cancel ")])]),_:1},8,["back-callback"])}const Kd=w(Yd,[["render",Wd],["__scopeId","data-v-d5792299"]]),Qd={components:{UsersList:tt,ListItems:it,ListItem:nt},props:{inviteMethod:{type:String,required:!0}},computed:{isEmailInviteMethod(){return this.inviteMethod==="email"},invitees(){return this.isEmailInviteMethod?[...this.emailGroupInvitees,...this.emailIndividualInvitees]:this.messagingInvitees},...T({emailGroupInvitees:e=>e.invites.emailGroupInvitees,emailIndividualInvitees:e=>e.invites.emailIndividualInvitees,messagingInvitees:e=>e.invites.messagingInvitees})},methods:{getInviteeDisplayDetails(e){return this.isEmailInviteMethod?e.groupId?`${e.groupName} (${e.usersCount})`:e.email:e.realName}}};function Jd(e,t,n,p,s,i){const c=o("list-item"),u=o("list-items"),h=o("users-list");return l(),g(h,{"back-callback":()=>e.$router.replace({name:"invite-contributors",params:{incomingTab:n.inviteMethod}})},{"drawer-header":r(()=>t[0]||(t[0]=[m(" Scheduled invitees ")])),default:r(()=>[d(u,null,{default:r(()=>[(l(!0),v(E,null,O(i.invitees,b=>(l(),g(c,{key:b.id},{default:r(()=>[m(C(i.getInviteeDisplayDetails(b)),1)]),_:2},1024))),128))]),_:1})]),_:1},8,["back-callback"])}const Xd=w(Qd,[["render",Jd],["__scopeId","data-v-218c7e3c"]]),Wt="YYYY-MM-DD",Pe="h:mm A",yt=`${Wt} ${Pe}`,Le="MMMM D, YYYY",Ve="H:mm",Zd=`${Le} ${Ve}`,eu={components:{Container:q,MaxDeliveriesModal:xt,ContributionsDeadline:ot,EmailPreviewLink:He,LoadingButton:H,RadioInput:$t,TeleportWrapper:ge},mixins:[de],data(){return{localDeliveryDate:"",localDeliveryTime:null,localDeliveryTimezone:null,localAutomaticDelivery:null,validationErrors:null,isLoading:!1,showMaxDeliveriesModal:!1,hasSavedDeliveryDetails:!1}},computed:{deliveryDateError(){return this.validationErrors&&this.validationErrors.delivery_date&&this.validationErrors.delivery_date[0]},deliveryTimeError(){return this.validationErrors&&this.validationErrors.delivery_time&&this.validationErrors.delivery_time[0]},...T(["defaultTimezone"]),...T({automaticDelivery:e=>e.board.automatic_delivery,boardId:e=>e.board.public_id,pendingDeliveryDate:e=>e.delivery.pendingDeliveryDate,pendingDeliveryTimezone:e=>e.delivery.pendingDeliveryTimezone,pendingRecipientNote:e=>e.delivery.pendingRecipientNote})},watch:{automaticDelivery:{immediate:!0,handler(e){this.localAutomaticDelivery=e}}},mounted(){this.localDeliveryDate=this.getFormattedDeliveryDate(this.pendingDeliveryDate),this.localDeliveryTime=this.getFormattedDeliveryTime(this.pendingDeliveryDate)},beforeUnmount(){if(!this.hasSavedDeliveryDetails){if(this.localDeliveryDate){const e=A(`${this.localDeliveryDate} ${this.localDeliveryTime}`,Zd).format(yt);this.$store.commit("pendingDeliveryDate",e)}this.$store.commit("pendingDeliveryTimezone",this.localDeliveryTimezone)}},methods:{getFormattedDeliveryDate(e){return e?A(e,yt).format(Le):""},getFormattedDeliveryTime(e){return e?A(e,Pe).format(Ve):"9:00"},async updateDeliveryDate(e){this.localDeliveryDate=this.getFormattedDeliveryDate(e)},async updateDeliveryTime(e){this.localDeliveryTime=this.getFormattedDeliveryTime(e)},async updateDeliveryTimezone(e){this.localDeliveryTimezone=e},async handleSave(){if(this.validate())try{this.isLoading=!0,await this.$store.dispatch("scheduleDelivery",{deliveryDate:A(this.localDeliveryDate,Le).format(Wt),deliveryTime:A(this.localDeliveryTime,Ve).format(Pe),deliveryTimezone:this.localDeliveryTimezone,automaticDelivery:this.localAutomaticDelivery}),this.hasSavedDeliveryDetails=!0,this.handleClose(),this.$store.commit("showDeliveryScheduledModal")}catch(e){if(e.response.status===418){P.emitter.once("email-was-verified",this.handleSave),this.showEmailVerification(null,"deliver");return}if("max_demo_solo_deliveries"in e.response.data.errors){this.showMaxDeliveriesModal=!0;return}this.validationErrors=e.response.data.errors,console.error(this.validationErrors)}finally{this.isLoading=!1}},validate(){return this.validationErrors=null,this.localDeliveryDate&&this.localDeliveryTime&&this.localDeliveryTimezone},handleClose(){P.emitter.emit("settings:hide")}}},tu={class:"tw-my-4"},iu={class:"drawer-container__footer"};function nu(e,t,n,p,s,i){const c=o("contributions-deadline"),u=o("radio-input"),h=o("email-preview-link"),b=o("loading-button"),y=o("max-deliveries-modal"),S=o("teleport-wrapper"),I=o("container");return l(),g(I,{"back-callback":()=>e.$router.replace({name:"delivery"})},{header:r(()=>t[3]||(t[3]=[m(" Schedule Delivery ")])),default:r(()=>[d(c,{"delivery-date":e.pendingDeliveryDate,"delivery-timezone":e.pendingDeliveryTimezone||e.defaultTimezone,"delivery-date-error":i.deliveryDateError,"delivery-time-error":i.deliveryTimeError,onUpdateDeliveryDate:i.updateDeliveryDate,onUpdateDeliveryTime:i.updateDeliveryTime,onUpdateDeliveryTimezone:i.updateDeliveryTimezone},{default:r(()=>t[4]||(t[4]=[a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-2"}," Deadline for contributions ",-1)])),_:1},8,["delivery-date","delivery-timezone","delivery-date-error","delivery-time-error","onUpdateDeliveryDate","onUpdateDeliveryTime","onUpdateDeliveryTimezone"]),a("div",tu,[t[7]||(t[7]=a("div",{class:"tw-text-lg tw-text-black tw-font-normal tw-mb-1.5"}," Delivery method ",-1)),t[8]||(t[8]=a("div",{class:"tw-text-gray-80 tw-text-sm tw-font-normal tw-mb-4"}," At the contribution deadline, how would you like the board to be delivered? ",-1)),d(u,{modelValue:s.localAutomaticDelivery,"onUpdate:modelValue":t[0]||(t[0]=k=>s.localAutomaticDelivery=k),options:[{value:!0},{value:!1}]},{"radio-0":r(()=>t[5]||(t[5]=[a("div",{class:"tw-flex tw-flex-col tw-normal-case"},[a("div",{class:"tw-text-black tw-text-base tw-font-semibold"}," Automatic delivery "),a("div",{class:"tw-text-gray-80 tw-text-sm tw-font-normal"}," We will email the board to the recipient(s). ")],-1)])),"radio-1":r(()=>t[6]||(t[6]=[a("div",{class:"tw-flex tw-flex-col tw-normal-case"},[a("div",{class:"tw-text-black tw-text-base tw-font-semibold"}," Manual delivery reminder "),a("div",{class:"tw-text-gray-80 tw-text-sm tw-font-normal"}," We will send you a reminder email and you can deliver the board when ready. ")],-1)])),_:1},8,["modelValue"])]),d(h,{"board-id":e.boardId,note:e.pendingRecipientNote},null,8,["board-id","note"]),a("div",iu,[d(b,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!s.localDeliveryDate,"is-loading":s.isLoading,onClick:i.handleSave},{default:r(()=>t[9]||(t[9]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[1]||(t[1]=k=>e.$router.replace({name:"delivery"}))}," Cancel ")]),d(S,{to:"#modals"},{default:r(()=>[s.showMaxDeliveriesModal?(l(),g(y,{key:0,"board-id":e.boardId,onClose:t[2]||(t[2]=()=>s.showMaxDeliveriesModal=!1)},null,8,["board-id"])):f("",!0)]),_:1})]),_:1},8,["back-callback"])}const su=w(eu,[["render",nu]]),Kt="YYYY-MM-DD",ze="h:mm A",_t=`${Kt} ${ze}`,Fe="MMMM D, YYYY",qe="H:mm",ru=`${Fe} ${qe}`,ou={components:{Container:q,ContributionsDeadline:ot,LoadingButton:H},mixins:[de],props:{deliveryMethod:{type:String,required:!0}},data(){return{localDeliveryDate:"",localDeliveryTime:null,localDeliveryTimezone:null,localAutomaticDelivery:null,validationErrors:null,isLoading:!1,hasSavedDeliveryDetails:!1}},computed:{deliveryName(){return this.deliveryMethod==="slack"?"Slack":"Microsoft Teams"},deliveryDateError(){return this.validationErrors&&this.validationErrors.delivery_date&&this.validationErrors.delivery_date[0]},deliveryTimeError(){return this.validationErrors&&this.validationErrors.delivery_time&&this.validationErrors.delivery_time[0]},...T(["board","isConsumer","defaultTimezone"]),...T({automaticDelivery:e=>e.board.automatic_delivery,boardId:e=>e.board.public_id,pendingDeliveryDate:e=>e.delivery.pendingDeliveryDate,pendingDeliveryTimezone:e=>e.delivery.pendingDeliveryTimezone,pendingRecipientNote:e=>e.delivery.pendingRecipientNote})},watch:{automaticDelivery:{immediate:!0,handler(e){this.localAutomaticDelivery=e}}},mounted(){this.localDeliveryDate=this.getFormattedDeliveryDate(this.pendingDeliveryDate),this.localDeliveryTime=this.getFormattedDeliveryTime(this.pendingDeliveryDate)},beforeUnmount(){if(!this.hasSavedDeliveryDetails){if(this.localDeliveryDate){const e=A(`${this.localDeliveryDate} ${this.localDeliveryTime}`,ru).format(_t);this.$store.commit("pendingDeliveryDate",e)}this.$store.commit("pendingDeliveryTimezone",this.localDeliveryTimezone)}},methods:{getFormattedDeliveryDate(e){return e?A(e,_t).format(Fe):""},getFormattedDeliveryTime(e){return e?A(e,ze).format(qe):"9:00"},async updateDeliveryDate(e){this.localDeliveryDate=this.getFormattedDeliveryDate(e)},async updateDeliveryTime(e){this.localDeliveryTime=this.getFormattedDeliveryTime(e)},async updateDeliveryTimezone(e){this.localDeliveryTimezone=e},async handleSave(){if(this.validate())try{this.isLoading=!0,await this.$store.dispatch("scheduleDelivery",{deliveryDate:A(this.localDeliveryDate,Fe).format(Kt),deliveryTime:A(this.localDeliveryTime,qe).format(ze),deliveryTimezone:this.localDeliveryTimezone,automaticDelivery:this.automaticDelivery}),this.hasSavedDeliveryDetails=!0,this.handleClose(),this.$store.commit("showDeliveryScheduledModal")}catch(e){if(e.response.status===418){P.emitter.once("email-was-verified",this.handleSave),this.showEmailVerification(null,"deliver");return}this.validationErrors=e.response.data.errors,console.error(this.validationErrors)}finally{this.isLoading=!1}},validate(){return this.validationErrors=null,this.localDeliveryDate&&this.localDeliveryTime&&this.localDeliveryTimezone},handleClose(){P.emitter.emit("settings:hide")}}},au={class:"tw-my-4"},lu={class:"tw-text-lg tw-text-black tw-font-normal tw-mb-1.5"},du={class:"tw-text-gray-80 tw-text-sm tw-font-normal tw-mb-4"},uu={class:"drawer-container__footer"};function cu(e,t,n,p,s,i){const c=o("contributions-deadline"),u=o("loading-button"),h=o("container");return l(),g(h,{"back-callback":()=>e.$router.replace({name:"delivery"})},{header:r(()=>t[1]||(t[1]=[m(" Schedule Delivery ")])),default:r(()=>[d(c,{"delivery-date":e.pendingDeliveryDate,"delivery-timezone":e.pendingDeliveryTimezone||e.defaultTimezone,"delivery-date-error":i.deliveryDateError,"delivery-time-error":i.deliveryTimeError,onUpdateDeliveryDate:i.updateDeliveryDate,onUpdateDeliveryTime:i.updateDeliveryTime,onUpdateDeliveryTimezone:i.updateDeliveryTimezone},null,8,["delivery-date","delivery-timezone","delivery-date-error","delivery-time-error","onUpdateDeliveryDate","onUpdateDeliveryTime","onUpdateDeliveryTimezone"]),a("div",au,[a("div",lu,C(i.deliveryName)+" delivery ",1),a("div",du," Your board will be delivered in the "+C(i.deliveryName)+" channel of your choosing — we'll tag your recipient to let them know their board is ready to view. ",1)]),a("div",uu,[d(u,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!s.localDeliveryDate,"is-loading":s.isLoading,onClick:i.handleSave},{default:r(()=>t[2]||(t[2]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[0]||(t[0]=b=>e.$router.replace({name:"delivery"}))}," Cancel ")])]),_:1},8,["back-callback"])}const wt=w(ou,[["render",cu]]),mu={components:{Container:q,LoadingButton:H,RecipientsEditor:Gt},data(){return{editCcContributors:!0,editRecipientNote:"",editRecipients:[],isDelivering:!1,isSaving:!1,isScheduling:!1,isShowingValidation:!1,requireEmail:!this.isConsumer,error:null,deliveryError:null}},computed:{ccContributors(){return this.board.cc_contributors},recipientNote(){return this.board.recipient_note},recipients(){return this.board.recipients},isRecipientsDirty(){if(this.editRecipients.length!==this.recipients.length)return!0;function e(t,n){return!t&&!n||t===n}return!this.editRecipients.every((t,n)=>{const p=this.recipients[n];return e(t.user_id,p.user_id)&&e(t.first_name,p.first_name)&&e(t.last_name,p.last_name)&&e(t.email,p.email)})},...T(["allowOutsideRecipients","board","isConsumer"]),...B(["isScheduled","isMemorialBoard","isMiniBoard","isLimitedUnpackagedBoard"])},watch:{ccContributors:{immediate:!0,handler(e){this.editCcContributors=e}},recipients:{immediate:!0,deep:!0,handler(e){this.editRecipients=oe(e)}},recipientNote:{immediate:!0,handler(e){this.editRecipientNote=e}}},methods:{async handleSave(){if(this.resetErrors(),!!await this.validateRecipients(this.isScheduled)){this.isSaving=!0;try{await this.saveRecipients(),x("Your changes were saved."),this.$router.replace({name:"settings"})}catch(e){console.error(e),this.error=z(e)}finally{this.isSaving=!1}}},saveRecipients(){if(!this.isRecipientsDirty)return null;const e=this.editRecipients.map(t=>({user_id:t.user_id,first_name:t.first_name,last_name:t.last_name,email:t.email}));return this.$store.dispatch("saveRecipients",{recipients:e})},async validateRecipients(e){this.requireEmail=e,this.isShowingValidation=!0,await this.$nextTick();const t=this.editRecipients.length&&this.editRecipients.every(n=>n.valid);return t||this.scrollToFirstError(),t},scrollToFirstError(){const e=this.$el.querySelector(".error-message");if(!e)return;const t=e.closest(".row");t&&t.scrollIntoView()},resetErrors(){this.error=null,this.deliveryError=null},handleRedirectToUpgrade(){window.location.href=`${this.board.url}/upgrade`},handleRecipientsUpdated(e){this.editRecipients=e},handleRecipientUpdated({recipient:e,index:t}){this.editRecipients[t]=e}}},pu={class:"tw-flex tw-items-center"};function hu(e,t,n,p,s,i){const c=o("recipients-editor"),u=o("loading-button"),h=o("container");return l(),g(h,{"back-callback":()=>e.$router.replace({name:"settings"})},{header:r(()=>t[1]||(t[1]=[m(" Honoree(s) ")])),default:r(()=>[d(c,{recipients:s.editRecipients,"show-validation":s.isShowingValidation,"use-user-dropdown":!e.isConsumer,"require-email":s.requireEmail,"allow-outside-recipients":e.allowOutsideRecipients,"is-memorial-board":e.isMemorialBoard,"is-mini-board":e.isMiniBoard,"is-limited-unpackaged-board":e.isLimitedUnpackagedBoard,class:"tw-mt-2 tw-mb-7",onRedirectToUpgrade:i.handleRedirectToUpgrade,onUpdateRecipient:i.handleRecipientUpdated,onUpdateRecipients:i.handleRecipientsUpdated},null,8,["recipients","show-validation","use-user-dropdown","require-email","allow-outside-recipients","is-memorial-board","is-mini-board","is-limited-unpackaged-board","onRedirectToUpgrade","onUpdateRecipient","onUpdateRecipients"]),a("div",pu,[d(u,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isRecipientsDirty,"is-loading":s.isSaving,onClick:i.handleSave},{default:r(()=>t[2]||(t[2]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[0]||(t[0]=b=>e.$router.replace({name:"settings"}))}," Cancel ")])]),_:1},8,["back-callback"])}const vu=w(mu,[["render",hu]]),gu={components:{LoadingButton:H,TemplateEditor:Ji,ConfirmationButton:te,Container:q},data(){return{model:{name:null,low_res_url:null,customCss:null,type:null,header_color:null,background_color:null,is_fixed:!1},imageSize:{width:null,height:null},isSaving:!1,shouldReset:!1,headerColor:null,backgroundColor:null,isImageBackground:!1,isHighRes:!1,error:null}},computed:{imageWidthDivisor(){return this.isHighRes?4:1},isImageDirty(){return this.model&&this.template&&this.model.low_res_url!==this.template.low_res_url},hasImage(){return this.model&&!!this.model.low_res_url},...re(J,{template:e=>e.selectedCustomTemplate}),...re(J,["templateId"]),...T({isConsumer:"isConsumer",isAdmin:"isAdmin",board:"board"}),...B(["isHeaderColorHidden"])},mounted(){this.loadValues()},methods:{...he(J,{appendTemplate:"appendTemplate",removeTemplate:"removeTemplate",updateStateTemplate:"updateTemplate"}),loadValues(){this.model={...this.template},this.isImageBackground=!!this.model.low_res_url,this.headerColor=this.model.header_color,this.backgroundColor=this.model.background_color,this.isHighRes=!1},handleImageSeamlessChanged(e){this.model.is_fixed=!e},handleHighResChanged(e){this.isHighRes=e},handleImageSelected(e){this.imageSize.width=e.width,this.imageSize.height=e.height,this.model.low_res_url=e.imageData,this.isImageBackground=!1},handleHeaderColorChanged(e){this.model.header_color=e},handleBackgroundColorChanged(e){this.model.background_color=e},handleResetClicked(){this.shouldReset=!0,x("Custom background reset"),this.$nextTick(()=>{this.shouldReset=!1})},handleBackToBackgrounds(){this.$router.replace({name:"backgrounds",params:{incomingTab:"custom"}})},async handleSave(){this.$refs.editor.validate(),this.$nextTick(()=>{if(this.error){ie(this.error),this.error=null;return}this.isSaving=!0;const e=this.getData();e.id?this.updateTemplate(e):this.saveTemplate(e)})},async saveTemplate(e){try{const t=await X.post("/api/user/templates",e);this.appendTemplate(t.data.data),x("The template was created"),this.updateTemplatesCss(t.data.data.css_link),this.handleBackToBackgrounds()}catch(t){console.error(t),ie("There was a problem processing your image.")}finally{this.isSaving=!1}},async updateTemplate(e){try{const t=await X.patch(`/api/user/templates/${e.id}`,e);x("The template was updated"),this.updateTemplatesCss(t.data.data.css_link),this.updateStateTemplate(t.data.data),this.handleBackToBackgrounds()}catch(t){console.error(t),ie("There was a problem processing your image.")}finally{this.isSaving=!1}},getData(){const e={...this.model};return this.isImageDirty&&e.low_res_url?(e.print_shrinkage=this.isImageDirty&&!this.model.is_fixed?`${Math.round(this.imageSize.width/this.imageWidthDivisor)}px`:null,e.background_image=this.model.low_res_url,e.is_high_res=this.isHighRes):e.low_res_url||(e.delete_background_image=!0),e},updateTemplatesCss(e){let t=document.getElementById("user-template-files");if(!t){const{head:n}=document;t=document.createElement("link"),t.type="text/css",t.rel="stylesheet",n.appendChild(t)}t.href=e},async handleDelete(){try{if(await X.delete(`/api/user/templates/${this.template.id}`),x("Your template has been deleted"),this.templateId===this.template.id){this.$store.commit("showSettingsModal",!1),setTimeout(()=>{window.location.href=this.board.url},700);return}this.removeTemplate(this.template.id),this.handleBackToBackgrounds()}catch(e){console.error(e),this.error=z(e)}finally{this.isLoading=!1}},handleValidationError(e){this.error=e},handleRemoveImageBackground(){this.model.low_res_url=null}}},fu={key:0},bu={key:1},yu={class:"drawer-container__footer"};function _u(e,t,n,p,s,i){const c=o("template-editor"),u=o("loading-button"),h=o("confirmation-button"),b=o("container");return l(),g(b,{"back-callback":i.handleBackToBackgrounds,class:"template-creator"},{header:r(()=>t[1]||(t[1]=[m(" Custom background ")])),default:r(()=>[a("div",null,[e.isAdmin?(l(),v("p",fu,t[2]||(t[2]=[m(" This background will only be selectable by you. "),a("a",{href:"/admin/backgrounds",class:"btn-p-link"}," Create backgrounds anyone can select. ",-1)]))):(l(),v("p",bu," This background will only be selectable by you. "))]),t[7]||(t[7]=a("hr",null,null,-1)),d(c,{ref:"editor",template:e.template,"should-reset":s.shouldReset,"in-sidebar":!0,"is-header-color-hidden":e.isHeaderColorHidden,onHeaderColorChanged:i.handleHeaderColorChanged,onBackgroundColorChanged:i.handleBackgroundColorChanged,onImageSelected:i.handleImageSelected,onHighResChanged:i.handleHighResChanged,onImageSeamlessChanged:i.handleImageSeamlessChanged,onValidationError:i.handleValidationError,onRemoveImageBackground:i.handleRemoveImageBackground},null,8,["template","should-reset","is-header-color-hidden","onHeaderColorChanged","onBackgroundColorChanged","onImageSelected","onHighResChanged","onImageSeamlessChanged","onValidationError","onRemoveImageBackground"]),a("div",yu,[d(u,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button","is-loading":s.isSaving,onClick:i.handleSave},{default:r(()=>t[3]||(t[3]=[m(" Save ")])),_:1},8,["is-loading","onClick"]),e.template.id?(l(),g(h,{key:0,"button-classes":"btn-p-lg btn-p-secondary",portal:"#modals",onOk:i.handleDelete},{modalHeader:r(()=>t[4]||(t[4]=[m(" Delete Custom Background ")])),modalText:r(()=>t[5]||(t[5]=[m(" Are you sure you want to delete your custom background? ")])),default:r(()=>[t[6]||(t[6]=m(" Delete "))]),_:1},8,["onOk"])):f("",!0),a("button",{class:"footer__cancel-button",type:"button",onClick:t[0]||(t[0]=(...y)=>i.handleResetClicked&&i.handleResetClicked(...y))}," Reset ")])]),_:1},8,["back-callback"])}const wu=w(gu,[["render",_u],["__scopeId","data-v-20c0860a"]]),ku=()=>{const e=new Set,t=async(n,p,s={})=>{var u;const{email:i=null,type:c=null}=s;try{return await n(),!0}catch(h){if(((u=h.response)==null?void 0:u.status)===418)return e.has(p)||(e.add(p),P.emitter.once("email-was-verified",p)),P.emitter.emit("kb-show-email-verification",{email:i,type:c}),!1;throw h}};return Zt(()=>{e.forEach(n=>{P.emitter.off("email-was-verified",n)}),e.clear()}),{requireEmailVerification:t}},Cu={components:{Container:q,InputError:K,LoadingButton:H,TextInput:be},directives:{focus:We},setup(){const{requireEmailVerification:e}=ku();return{requireEmailVerification:e}},data(){return{isLoading:!1,email:"",error:null}},computed:{...T(["board","isEditMode"])},mounted(){this.email=this.board.recipients[0].email||""},methods:{...St(["deliverGift"]),async submit(){if(this.validate()){this.isLoading=!0;try{if(!await this.requireEmailVerification(()=>this.deliverGift(this.email),this.submit))return;x("Your gift has been sent!"),this.$router.replace({name:"settings"})}catch(e){console.error(e),this.error="There was an error sending your request. Please try again later or contact us at help@kudoboard.com."}finally{this.isLoading=!1}}},validate(){return this.error=null,xe(this.email)?!0:(this.error="Valid email address required.",!1)},handleDeliverBoardClicked(){P.emitter.emit("settings:navigate","delivery")}}},Su={class:"tw-flex tw-flex-col tw-gap-y-3"},Iu={class:"alert-text"},Tu={key:1},Eu={key:0},Du={key:1};function Ru(e,t,n,p,s,i){const c=o("text-input"),u=o("input-error"),h=o("loading-button"),b=o("container"),y=kt("focus");return l(),g(b,{"back-callback":()=>e.$router.replace({name:"settings"})},{header:r(()=>t[2]||(t[2]=[m(" Gift Delivery ")])),default:r(()=>[a("div",Su,[t[6]||(t[6]=a("div",{class:"tw-text-lg tw-text-gray-90"}," To send your board recipient their gift, submit their email below. We'll send them instructions for redemption. ",-1)),a("div",Iu,[t[3]||(t[3]=a("b",null,"Note:",-1)),t[4]||(t[4]=m(" If you're ")),e.isEditMode?(l(),v("button",{key:0,type:"button",class:"btn-p-link alert-text tw-underline",onClick:t[0]||(t[0]=(...S)=>i.handleDeliverBoardClicked&&i.handleDeliverBoardClicked(...S))}," delivering your board ")):f("",!0),e.isEditMode?f("",!0):(l(),v("span",Tu," delivering your board ")),t[5]||(t[5]=m(" through Kudoboard, you don't need to deliver your gift card here — your gift will be delivered alongside your board. "))]),a("div",null,[d(u,{error:s.error},{default:r(()=>[Y(d(c,{modelValue:s.email,"onUpdate:modelValue":t[1]||(t[1]=S=>s.email=S),type:"text",placeholder:"Recipient email address",class:"tw-input-md",onKeydown:Ce(i.submit,["enter"])},null,8,["modelValue","onKeydown"]),[[y]])]),_:1},8,["error"])])]),d(h,{class:"btn-p-lg btn-p-primary tw-mt-4",type:"button","is-loading":s.isLoading,onClick:i.submit},{default:r(()=>[e.board.has_unsent_cash_gifts?(l(),v("span",Eu," Deliver Gift Now ")):(l(),v("span",Du," Resend Gift Now "))]),_:1},8,["is-loading","onClick"])]),_:1},8,["back-callback"])}const Mu=w(Cu,[["render",Ru]]),$u={components:{Container:q,LoadingButton:H,InputError:Dt,TextInput:be},data(){return{editAudience:"",isSaving:!1,error:null}},computed:{audience(){var e;return((e=this.board.recipients[0])==null?void 0:e.name)??""},isAudienceDirty(){return this.audience!==this.editAudience},...T(["board"])},mounted(){this.editAudience=this.audience},methods:{async handleSave(){this.error=null,this.isSaving=!0;try{await this.saveRecipients(),this.$router.replace({name:"settings",params:{success:"Your changes were saved."}})}catch(e){console.error(e),this.error=z(e)}finally{this.isSaving=!1}},saveRecipients(){if(!this.isAudienceDirty)return null;const e=this.board.recipients.map(t=>({user_id:t.user_id,first_name:this.editAudience,last_name:t.last_name,email:t.email}));return this.$store.dispatch("saveRecipients",{recipients:e})}}},Bu={class:"tw-mt-2 tw-mb-7"},Uu={class:"tw-flex tw-items-center"};function Au(e,t,n,p,s,i){const c=o("text-input"),u=o("input-error"),h=o("loading-button"),b=o("container");return l(),g(b,{"back-callback":()=>e.$router.replace({name:"settings"})},{header:r(()=>t[2]||(t[2]=[m(" Audience ")])),default:r(()=>[a("div",Bu,[d(u,{error:s.error},{default:r(()=>[d(c,{modelValue:s.editAudience,"onUpdate:modelValue":t[0]||(t[0]=y=>s.editAudience=y),type:"text",class:"tw-input-md",placeholder:"e.g. Marketing Team, etc."},null,8,["modelValue"])]),_:1},8,["error"])]),a("div",Uu,[d(h,{class:"btn-p-lg btn-p-primary tw-mr-2",type:"button",disabled:!i.isAudienceDirty,"is-loading":s.isSaving,onClick:i.handleSave},{default:r(()=>t[3]||(t[3]=[m(" Save changes ")])),_:1},8,["disabled","is-loading","onClick"]),a("button",{class:"footer__cancel-button",type:"button",onClick:t[1]||(t[1]=y=>e.$router.replace({name:"settings"}))}," Cancel ")])]),_:1},8,["back-callback"])}const xu=w($u,[["render",Au]]),Nu=si({history:ri(),routes:[{name:N.BOARD_SETTINGS,path:"/settings",component:go},{name:N.DELIVERY,path:"/delivery",component:ol},{name:N.DELIVERY_SCHEDULE_EMAIL,path:"/delivery/schedule/email",component:su},{name:N.DELIVERY_SCHEDULE_SLACK,path:"/delivery/schedule/slack",component:wt,props:{deliveryMethod:"slack"}},{name:N.DELIVERY_SCHEDULE_TEAMS,path:"/delivery/schedule/teams",component:wt,props:{deliveryMethod:"teams"}},{name:N.INVITE_CONTRIBUTORS,path:"/contributors/:incomingTab?",component:xd,props:!0},{name:N.SCHEDULED_INVITE,path:"/schedule-invite/:inviteMethod",component:Kd,props:!0},{name:N.SCHEDULED_INVITEES,path:"/scheduled-invitees/:inviteMethod",component:Xd,props:!0},{name:N.CONTRIBUTORS_INVITED,path:"/contributors/invited/:fromTab/:selectNonContributors?",component:Ao,props:e=>({...e.params,selectNonContributors:String(e.params.selectNonContributors||"").toLowerCase()==="true"})},{name:N.GROUP_INVITED,path:"/group/invited",component:vt},{name:N.HONOREE_SETTINGS,path:"/honoree-settings",component:vu},{name:N.BACKGROUNDS,path:"/backgrounds:incomingTab?",component:Gr,props:!0},{name:N.OVERLAY_ANIMATIONS,path:"/overlay-animations",component:Si},{name:N.CUSTOM_BACKGROUND,path:"/custom-background",component:wu},{name:N.GIFT_DELIVERY,path:"/gift-delivery",component:Mu},{name:N.REMINDERS,path:"/reminders",component:Rn},{name:N.DELIVERY_SETTINGS_EMAIL,path:"/delivery/settings/email",component:Ot,props:!0},{name:N.GROUP_RECIPIENT,path:"/group-recipient",component:vt},{name:N.APPEARANCE,path:"/appearance",component:Fs},{name:N.FONTS,path:"/fonts",component:gt},{name:N.TITLE_FONTS,path:"/title-fonts",component:gt},{name:N.AUDIENCE_SETTINGS,path:"/audience-settings",component:xu}]});ei(Ii).use(ti()).use(tn).use(Nu).use(ii).mount("#board");
